"use strict";(self.webpackChunkterraforma_systems=self.webpackChunkterraforma_systems||[]).push([[7586],{96789:(e,n,a)=>{a.d(n,{En:()=>c,IE:()=>b,Qm:()=>v,ev:()=>p,hm:()=>m,jB:()=>g});var r,l,o,t,i,s,d=a(57528),u=a(70459);const c=(0,u.J1)(r||(r=(0,d.A)(["\n  query GetCompanyBranches($sortOrder: String!, $sortField: String!, $limit: Float!, $page: Float!, $search: String!, $companyId: String!) {\n    getCompanyBranches(sortOrder: $sortOrder, sortField: $sortField, limit: $limit, page: $page, search: $search, companyId: $companyId) {\n      message\n      data {\n        count\n        branches {          \n          uuid\n          branch {\n            location\n            uuid\n          }\n        }\n      }\n    }\n  }\n"]))),m=(0,u.J1)(l||(l=(0,d.A)(["\n  query GetCompanyTenantDetails($companyId: String!, $branchId: String!) {\n    getCompanyTenantDetails(company_id: $companyId, branch_id: $branchId) {\n      message\n      data {\n        email\n        company_name\n        website\n        authorized_person\n        industry_type\n        type        \n        phone_number\n        country_code\n        location\n        total_employees\n      }\n    }\n  }\n"]))),p=(0,u.J1)(o||(o=(0,d.A)(["\nquery GetCompanyContractorDetails($branchId: String!, $companyId: String!) {\n  getCompanyContractorDetails(branch_id: $branchId, company_id: $companyId) {\n    message\n    data {\n      authorized_person\n      company_name\n      email\n      industry_type\n      location\n      total_employees\n      phone_number\n      country_code\n      type\n      website\n    }\n  }\n}\n"]))),v=(0,u.J1)(t||(t=(0,d.A)(["\nquery GetCompanyTenantEmployeeList($userData: GetSubscriberDto!) {\n  getCompanyTenantEmployeeList(userData: $userData) {\n    data {\n      employee {\n        email\n        uuid\n        status\n        first_name\n        last_name\n        phone_number\n        country_code {\n          name\n          id\n          uuid\n          countryCode\n          phoneCode\n        }\n        department\n        user_type\n        company_id {\n          uuid\n          name\n          description\n          type\n          attachments          \n          website_url          \n          industryType {\n            name\n            uuid\n            description\n          }\n        }\n      }\n      count\n    }\n  }\n}\n"]))),g=(0,u.J1)(i||(i=(0,d.A)(["\nquery GetCompanyContractorsList($userData: GetSubscriberDto!) {\n  getCompanyContractorsList(userData: $userData) {\n    message\n    data {\n      employee {\n        email\n        uuid\n        status\n        first_name\n        last_name\n        phone_number\n        country_code {         \n          uuid\n          name\n          phoneCode\n        }        \n        department\n        user_type\n        company_id {\n          uuid\n          name\n          description\n          type\n          attachments\n          website_url          \n          industryType {\n            uuid\n            name            \n          }\n          tenantContractorType {\n            uuid\n            name            \n            type\n          }\n        }\n        user_roles {\n          uuid\n          role_id {\n            uuid\n            name\n            description\n            status\n          }\n        }\n      }\n      count\n    }\n  }\n}\n"]))),b=(0,u.J1)(s||(s=(0,d.A)(["\n  query GetUserById($userId: String!) {\n    getUserById(userId: $userId) {\n      message\n      data {\n        user {\n          country_code {\n            countryCode\n            name\n            phoneCode\n            uuid\n          }\n          position\n          email\n          educational_interests\n          first_name\n          last_name\n          user_type\n          is_required_reset_password\n          organization\n          phone_number\n          preferred_language\n          profile_picture\n          role_name\n          uuid\n          pronounce\n          reporting_manager_id {\n            uuid\n            profile_picture\n            last_name\n            first_name\n            location\n            organization\n          }\n          department\n          location\n        }\n        location\n        role_id {\n          name\n          status\n          uuid\n        }\n        role\n      }\n    }\n  }\n"])))},47568:(e,n,a)=>{a.r(n),a.d(n,{default:()=>S});var r,l=a(65043),o=a(88250),t=a(31881),i=a(73216),s=a(63516),d=a(25263),u=a(34764),c=a(41290),m=a(33556),p=a(42145),v=a(66925),g=a(55797),b=(a(15675),a(59140),a(82485)),h=(a(9686),a(72096)),f=a(8848),y=a(96789),_=a(28610),x=a(64526),C=a(57528);const w=(0,a(70459).J1)(r||(r=(0,C.A)(["\nmutation UpdateSubscriberEmployeeUser($subscriberUserData: UpdateSubscriberEmployeeDto!, $subscriberUserId: String!) {\n  updateSubscriberEmployeeUser(subscriberUserData: $subscriberUserData, subscriberUserId: $subscriberUserId) {\n    message\n  }\n}\n"])));var j=a(12352),I=a(85408),N=a(70579);const S=function(){var e,n;const a=new URLSearchParams(location.search),r=a.get("uuid"),C=a.get("branchId"),S=a.get("company_id"),A="true"===a.get("Is_subAdmin"),{updateUserValidationSchema:R}=(0,j.A)(),$=a.get("userTypeId"),U=a.get("userTypeValue"),k=a.get("read_Data"),D=a.get("userCompanyType"),{data:B,refetch:E,loading:T}=(0,o.I)(y.IE,{variables:{userId:r}}),{data:L}=(0,o.I)(_.Jo,{variables:{limit:500,page:1,search:"",sortOrder:"",sortField:"name"}}),[M,F]=(0,t.n)(w),[q,O]=(0,l.useState)(""),[J,z]=(0,l.useState)(!1),G=(0,i.Zp)(),P=(0,l.createRef)(),[V,W]=(0,l.useState)([]),[H,Q]=(0,l.useState)([]),Z=(0,l.useRef)(null),[K,X]=(0,l.useState)(!1),[Y,ee]=(0,l.useState)([]),{data:ne}=(0,o.I)(I.kA),[ae,re]=(0,l.useState)([]),le="2"===D?p.J$.CONTRACTOR:p.J$.USER,oe="1"===D?p.J$.TENANT:le,{data:te,refetch:ie}=(0,o.I)(_.zO,{variables:{userData:{search:"",companyId:null!==S&&void 0!==S?S:"",branchId:null!==C&&void 0!==C?C:"",user_type:oe,userId:r}}}),se={logo:"",first_name:"",last_name:"",email:"",mobile_number:"",role:"",preferredLanguage:"",department:"",reportingManager:"",branchId:"",country_code:"",position:"",isReportingManager:!A};(0,l.useEffect)((()=>{te&&ie()}),[]),(0,l.useEffect)((()=>{E()}),[]),(0,l.useEffect)((()=>{var e,n,a;const r=[];null===L||void 0===L||null===(e=L.getActiveRoles)||void 0===e||null===(n=e.data)||void 0===n||null===(a=n.role)||void 0===a||a.map((e=>{r.push({name:null===e||void 0===e?void 0:e.name,key:null===e||void 0===e?void 0:e.uuid})})),Q(r)}),[L]),(0,l.useEffect)((()=>{var e,n;const a=[];null===te||void 0===te||null===(e=te.getReportingManagers)||void 0===e||null===(n=e.data)||void 0===n||n.map((e=>{a.push({name:"".concat(null===e||void 0===e?void 0:e.first_name," ").concat(null===e||void 0===e?void 0:e.last_name),key:null===e||void 0===e?void 0:e.uuid})})),W(a)}),[te]),(0,l.useEffect)((()=>{if(B){var e,n,a,r,l,o,t,i,s,d,u,c,m,p;const v=null===B||void 0===B||null===(e=B.getUserById)||void 0===e?void 0:e.data;ue.resetForm({values:{first_name:null===v||void 0===v||null===(n=v.user)||void 0===n?void 0:n.first_name,last_name:null===v||void 0===v||null===(a=v.user)||void 0===a?void 0:a.last_name,email:null===v||void 0===v||null===(r=v.user)||void 0===r?void 0:r.email,mobile_number:null===v||void 0===v||null===(l=v.user)||void 0===l?void 0:l.phone_number,role:null===v||void 0===v||null===(o=v.role_id)||void 0===o?void 0:o.uuid,preferredLanguage:null===v||void 0===v||null===(t=v.user)||void 0===t?void 0:t.preferred_language,department:null===v||void 0===v||null===(i=v.user)||void 0===i?void 0:i.department,reportingManager:null===v||void 0===v||null===(s=v.user)||void 0===s||null===(d=s.reporting_manager_id)||void 0===d?void 0:d.uuid,logo:null===v||void 0===v||null===(u=v.user)||void 0===u?void 0:u.profile_picture,branchId:C,country_code:null===v||void 0===v||null===(c=v.user)||void 0===c||null===(m=c.country_code)||void 0===m?void 0:m.uuid,position:null===v||void 0===v||null===(p=v.user)||void 0===p?void 0:p.position,isReportingManager:!A}})}}),[B]);const de=(0,l.useCallback)((()=>{G(-1)}),[]),ue=(0,s.Wx)({initialValues:se,validationSchema:R,onSubmit:async e=>{var n,a;let l="";D&&("2"===D?(l=p.ve.SUBSCRIBER_CONTRACTOR,A&&(l=p.ve.SUBSCRIBER_SUB_ADMIN_CONTRACTOR)):(l=p.ve.SUBSCRIBER_TENANT,A&&(l=p.ve.SUBSCRIBER_TENANT_SUB_ADMIN))),$&&U&&(l=+U),M({variables:{subscriberUserData:{profile_picture:null!==(n=null===e||void 0===e?void 0:e.logo)&&void 0!==n?n:"",country_code:null===e||void 0===e?void 0:e.country_code,department:null===e||void 0===e?void 0:e.department,first_name:null===e||void 0===e?void 0:e.first_name,last_name:null===e||void 0===e?void 0:e.last_name,phone_number:null===e||void 0===e?void 0:e.mobile_number,preferred_language:null===e||void 0===e?void 0:e.preferredLanguage,reporting_manager_id:A?null:e.reportingManager,role_id:null===e||void 0===e?void 0:e.role,user_type:null!==(a=l)&&void 0!==a?a:"",position:null===e||void 0===e?void 0:e.position},subscriberUserId:r}}).then((e=>{var n,a;x.oR.success(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(a=n.updateSubscriberEmployeeUser)||void 0===a?void 0:a.message),G(-1)})).catch((e=>{var n,a,r,l;x.oR.error(null===e||void 0===e||null===(n=e.networkError)||void 0===n||null===(a=n.result)||void 0===a||null===(r=a.errors)||void 0===r||null===(l=r[0])||void 0===l?void 0:l.message)}))}});(0,l.useEffect)((()=>{var e,n;const a=null===B||void 0===B||null===(e=B.getUserById)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.location;if(a){ee([{name:a,key:a}])}}),[B]);const ce=(0,l.useCallback)((e=>{let n;if(e.preventDefault(),e.dataTransfer?n=e.dataTransfer.files:e.target&&(n=e.target.files),n&&n.length>0){const e=n[0];if(e.type.startsWith("image/"))if(e.size>p.w3)x.oR.error("Image size must be less than 5MB");else{const n=new FileReader;n.onload=()=>{O(n.result),z(!0)},n.readAsDataURL(e)}else x.oR.error("Please select a valid image file")}Z.current&&(Z.current.value="")}),[]),me=async()=>{var e;if("undefined"!==typeof(null===(e=P.current)||void 0===e?void 0:e.cropper)){var n;let e=null;const a=(0,p.Si)(null===(n=P.current)||void 0===n?void 0:n.cropper.getCroppedCanvas().toDataURL(),"employeeImage.png"),r=new FormData;r.append("image",a),X(!0),e=await(0,p.V6)(r,"profile"),e&&(ue.setFieldValue("logo",e),z(!1),X(!1))}},pe=(0,l.useCallback)((e=>{ue.setFieldValue(e.target.name,(0,v.AW)(e))}),[]);return(0,l.useEffect)((()=>{var e,n;const a=[];null===ne||void 0===ne||null===(e=ne.getCountries)||void 0===e||null===(n=e.data)||void 0===n||n.map((e=>{a.push({name:"+".concat(null===e||void 0===e?void 0:e.phoneCode),key:null===e||void 0===e?void 0:e.uuid})})),re(a)}),[ne]),(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{children:(0,N.jsx)("h1",{className:"font-bold text-size-30",children:"User Details"})}),(0,N.jsx)("div",{children:(0,N.jsxs)("form",{onSubmit:ue.handleSubmit,children:[(0,N.jsxs)("div",{className:"flex flex-wrap items-start justify-center p-5 border border-solid sm:justify-start lg:flex-nowrap mb-7 border-border-primary rounded-xl",children:[(0,N.jsx)("div",{className:"flex items-center justify-center w-full max-w-[400px] lg:mr-5 h-full aspect-square lg:w-1/3 lg:max-w-[480px] lg:min-w-[320px] xl:min-w-[410px] border border-border-primary border-solid rounded-xl mb-8 lg:mb-0",children:(0,N.jsx)("div",{className:"box-border flex items-center justify-center ".concat(k?"pointer-events-none":""),children:(0,N.jsxs)("label",{htmlFor:"logo",className:"relative flex flex-col items-center justify-center",children:[(0,N.jsx)("p",{className:"error",children:ue.errors.logo&&ue.touched.logo?(0,h.t)(ue.errors.logo):""}),(0,N.jsx)("div",{className:"flex items-center justify-center w-32 h-32 overflow-hidden border border-gray-300 border-solid rounded-full cursor-pointer sm:w-44 sm:h-44",children:(0,N.jsx)("img",{src:null!==ue&&void 0!==ue&&null!==(e=ue.values)&&void 0!==e&&e.logo?p.sT+(null===ue||void 0===ue||null===(n=ue.values)||void 0===n?void 0:n.logo):d,alt:"logo",className:"object-contain w-full h-full bg-black"})}),(0,N.jsx)("input",{id:"logo",type:"file",name:"logo",multiple:!0,className:"hidden",accept:".png, .jpeg",ref:Z,onChange:e=>ce(e)}),(0,N.jsx)("div",{className:"absolute bottom-0 p-2 text-2xl font-bold text-white rounded-full right-1 sm:right-2 bg-primary",children:(0,N.jsx)(m.i7,{})})]})})}),(0,N.jsxs)("div",{className:"flex flex-wrap w-full gap-5 lg:w-2/3",children:[(0,N.jsx)("div",{className:"inline-block w-full xl:w-[calc(50%-10px)]",children:(0,N.jsx)(u.A,{placeholder:(0,h.t)("First Name"),type:"text",id:"first_name",name:"first_name",label:(0,h.t)("First Name"),value:ue.values.first_name,onChange:ue.handleChange,required:!0,error:ue.errors.first_name&&ue.touched.first_name&&ue.errors.first_name,onBlur:pe,disabled:!!k})}),(0,N.jsx)("div",{className:"inline-block w-full xl:w-[calc(50%-10px)]",children:(0,N.jsx)(u.A,{placeholder:(0,h.t)("Last Name"),type:"text",id:"last_name",name:"last_name",label:(0,h.t)("Last Name"),value:ue.values.last_name,onChange:ue.handleChange,required:!0,error:ue.errors.last_name&&ue.touched.last_name&&ue.errors.last_name,onBlur:pe,disabled:!!k})}),(0,N.jsx)("div",{className:"inline-block w-full xl:w-[calc(50%-10px)]",children:(0,N.jsx)(u.A,{placeholder:(0,h.t)("Email"),type:"text",id:"email",name:"email",label:(0,h.t)("Email"),value:ue.values.email,onChange:ue.handleChange,required:!0,error:ue.errors.email&&ue.touched.email&&ue.errors.email,onBlur:pe,disabled:!0})}),(0,N.jsxs)("div",{className:"w-full lg:w-[calc(50%-10px)]",children:[(0,N.jsx)("label",{children:(0,h.t)("Mobile Number")}),(0,N.jsxs)("div",{className:"flex",children:[(0,N.jsx)(f.A,{placeholder:(0,h.t)("Code"),className:"min-w-[96px]",onChange:ue.handleChange,value:ue.values.country_code,options:ae,name:"country_code",id:"country_code",error:ue.errors.country_code&&ue.touched.country_code?ue.errors.country_code:"",disabled:!!k}),(0,N.jsx)(u.A,{placeholder:(0,h.t)("Mobile Number"),type:"tel",id:"mobile_number",name:"mobile_number",value:ue.values.mobile_number,onChange:ue.handleChange,error:ue.errors.mobile_number&&ue.touched.mobile_number&&ue.errors.mobile_number,onBlur:pe,disabled:!!k})]})]}),(0,N.jsx)("div",{className:"inline-block w-full xl:w-[calc(50%-10px)]",children:(0,N.jsx)(f.A,{placeholder:(0,h.t)("Role"),name:"role",onChange:ue.handleChange,value:ue.values.role,options:H,id:"role",error:ue.errors.role&&ue.touched.role?ue.errors.role:"",required:!0,label:(0,h.t)("Role"),disabled:!!k})}),(0,N.jsx)("div",{className:"inline-block w-full xl:w-[calc(50%-10px)]",children:(0,N.jsx)(f.A,{placeholder:(0,h.t)("Select Preferred Language"),name:"preferredLanguage",onChange:ue.handleChange,value:ue.values.preferredLanguage,options:p.Ug,id:"category",error:ue.errors.preferredLanguage&&ue.touched.preferredLanguage?ue.errors.preferredLanguage:"",label:(0,h.t)("Preferred Language"),disabled:!!k})}),(0,N.jsx)("div",{className:"inline-block w-full xl:w-[calc(50%-10px)]",children:(0,N.jsx)(u.A,{placeholder:(0,h.t)("Department"),type:"text",id:"department",name:"department",label:(0,h.t)("Department"),value:ue.values.department,onChange:ue.handleChange,error:ue.errors.department&&ue.touched.department&&ue.errors.department,onBlur:pe,disabled:!!k})}),(0,N.jsx)("div",{className:"w-full lg:w-[calc(50%-10px)]",children:(0,N.jsx)(f.A,{disabled:!0,placeholder:(0,h.t)("Select Location"),className:"w-full",label:(0,h.t)("Location"),inputIcon:(0,N.jsx)("span",{className:"text-xs",children:(0,N.jsx)(m.jN,{className:"fill-dark-grey"})}),onChange:ue.handleChange,value:ue.values.branchId,options:Y,name:"branchId",id:"branchId",required:!0})}),!A&&(0,N.jsx)("div",{className:"inline-block w-full xl:w-[calc(50%-10px)]",children:(0,N.jsx)(f.A,{placeholder:(0,h.t)("Reporting Manager"),name:"reportingManager",onChange:ue.handleChange,value:ue.values.reportingManager,options:V,id:"reportingManager",error:ue.errors.reportingManager&&ue.touched.reportingManager?ue.errors.reportingManager:"",required:!0,label:(0,h.t)("Reporting Manager"),disabled:!!k})}),(0,N.jsx)("div",{className:"inline-block w-full xl:w-[calc(50%-10px)]",children:(0,N.jsx)(u.A,{placeholder:(0,h.t)("Position"),type:"text",id:"position",name:"position",label:(0,h.t)("Position"),value:ue.values.position,onChange:ue.handleChange,error:ue.errors.position&&ue.touched.position&&ue.errors.position,onBlur:pe,disabled:!!k})})]})]}),!k&&(0,N.jsx)(c.A,{className:"mr-5 btn-primary btn-normal mb-3 md:mb-0 w-full md:w-[166px]",type:"submit",label:(0,h.t)("Update Changes"),disabled:T||K||(null===F||void 0===F?void 0:F.loading),title:"".concat((0,h.t)("Update Changes"))}),(0,N.jsx)(c.A,{className:"btn-secondary btn-normal w-full md:w-[166px]",label:(0,h.t)("Cancel"),onClick:()=>de(),title:"".concat((0,h.t)("Cancel"))})]})}),(0,N.jsx)(g.l,{className:"custom-dialog",header:"Crop Image",visible:J,style:{width:"50vw"},onHide:()=>z(!1),footer:()=>(0,N.jsxs)("div",{className:"flex justify-end gap-5",children:[(0,N.jsx)(c.A,{className:"btn-secondary btn-normal w-full md:w-[160px] whitespace-nowrap",type:"button",label:"Cancel",onClick:()=>z(!1)}),(0,N.jsx)(c.A,{className:"btn-primary btn-normal w-full md:w-[160px] whitespace-nowrap",type:"button",label:"Save",onClick:()=>me(),disabled:K})]}),children:q&&(0,N.jsx)(b.A,{ref:P,style:{height:400,width:"100%"},zoomTo:.5,aspectRatio:1,preview:".img-preview",src:q,viewMode:1,minCropBoxHeight:10,minCropBoxWidth:10,background:!1,responsive:!0,autoCropArea:1,checkOrientation:!1,guides:!0,cropBoxResizable:!1})})]})}},25263:(e,n,a)=>{e.exports=a.p+"static/media/sidebar-logo.d6fce7850bbfb0f38fbe.png"}}]);
//# sourceMappingURL=7586.6b038dc3.chunk.js.map