"use strict";(self.webpackChunkterraforma_systems=self.webpackChunkterraforma_systems||[]).push([[1734],{7648:(e,t,l)=>{l.d(t,{A:()=>p});var a=l(65043),n=l(74117),s=l(73216),i=l(35475),r=l(42145),d=l(79456),o=l(66925),c=l(70579);const m=()=>{var e,t,l;const{t:m}=(0,n.Bd)(),p=(0,s.zy)(),u=new URLSearchParams(p.search).get("uuid"),{id:v}=(0,s.g)(),{userProfileData:x}=(0,d.d4)((e=>e.userProfile)),h=null!==(e=null===x||void 0===x||null===(t=x.getProfile)||void 0===t||null===(l=t.data)||void 0===l?void 0:l.user_type)&&void 0!==e?e:"",g=e=>{var t;let l="";if(null!==(t=e.split("/")[2])&&void 0!==t&&t.includes("-")){return e.split("/")[2].split("-").forEach((e=>{var t;return l=l+(null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+e.slice(1)+" ",l})),l}var a;return l=(null===(a=e.split("/")[2][0])||void 0===a?void 0:a.toUpperCase())+e.split("/")[2].slice(1),l},y=e=>{let t="";if(null!==e&&void 0!==e&&e.includes("-")){t=null===e||void 0===e?void 0:e.replace(/-|\s/g," ");const l=t.split(" ");for(let e=0;e<l.length;e++)l[e]=l[e][0].toUpperCase()+l[e].substring(1);return t=l.join(" "),t}var l;return t=(null===e||void 0===e||null===(l=e[0])||void 0===l?void 0:l.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))+" ",t},f=e=>{let t="";return null!==e&&void 0!==e&&e.includes("-")||(t=(null===e||void 0===e||null===(l=e[0])||void 0===l?void 0:l.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))+" "),t;var l},j=p.pathname.split("/"),T=(0,a.useCallback)((()=>{if((null===j||void 0===j?void 0:j.length)>0){const e=null===j||void 0===j?void 0:j.length;if(e<4)return(0,c.jsx)("span",{className:"text-primary",children:j[2]&&"".concat(m(y(j[2])))});if(e<5)return""!==j[3]?j[3].length>32?(0,c.jsxs)(c.Fragment,{children:[f(j[3])&&(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(i.k2,{to:"/".concat(r.bw.app,"/").concat(j[2]),className:"text-light-grey hover:underline",children:"".concat(m(g(p.pathname)))})}),f(j[3])&&(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),!f(j[3])&&(0,c.jsx)("span",{className:"text-primary",children:j[2]&&"".concat(m(y(j[2])))}),(0,c.jsx)("span",{className:"text-primary",children:j[3]&&"".concat(m(f(j[3])))})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(i.k2,{to:"/".concat(r.bw.app,"/").concat(j[2]),className:"text-light-grey hover:underline",children:"".concat(m(g(p.pathname)))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:j[3]&&"".concat(m(y(j[3])))})]}):(0,c.jsx)("span",{className:"text-primary",children:j[2]&&"".concat(m(y(j[2])))});if(e<6)return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(i.k2,{to:"/".concat(r.bw.app,"/").concat(j[2]),className:"text-light-grey hover:underline",children:"".concat(m(g(p.pathname)))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:j[3]&&"".concat(m(y(j[3])))})]});if(e<7){let e="";return u?e="?uuid=".concat(u):v&&(e="?uuid=".concat(v)),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(i.k2,{to:"/".concat(r.bw.app,"/").concat(j[2]),className:"text-light-grey hover:underline",children:m(y(j[2]))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(i.k2,{to:"/".concat(r.bw.app,"/").concat(j[2],"/").concat(j[3],"/").concat((""!==u||""!==v)&&e),className:"text-light-grey hover:underline",children:m(y(j[3]))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:j[5]&&"".concat(m(y(j[4])))})]})}}}),[j]);return(0,c.jsx)("div",{className:"w-full",children:(0,c.jsxs)("p",{className:"max-xs:text-xs text-xs-14 max-md:truncate",children:[(0,c.jsxs)("span",{children:[(0,c.jsx)(i.k2,{to:(0,o.Go)(h,r.ve.SUPER_ADMIN,"/".concat(r.bw.app,"/").concat(r.bw.dashboard),"/".concat(r.bw.app,"/").concat(r.bw.subscriber)),className:"cursor-pointer text-light-grey hover:underline",children:m("Home")}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"})]}),T()]})})},p=a.memo(m)},12209:(e,t,l)=>{l.d(t,{A:()=>m});var a=l(65043),n=l(74117),s=l(73216),i=l(7648),r=l(33556),d=l(79456),o=l(75214),c=l(70579);const m=e=>{let{headerActionConst:t,headerTitle:l}=e;const{t:m}=(0,n.Bd)(),p=(0,d.wA)(),{show:u}=(0,d.d4)((e=>e.coursesManagement)),v=(0,s.zy)(),x=(0,a.useCallback)((()=>{p((0,o.oM)(!u))}),[u]);return(0,c.jsxs)("header",{className:"sticky top-0 z-20 flex bg-white border-b shadow-header xl:shadow-none xl:h-auto xl:block border-border-primary xl:px-2 xl:pt-0",children:[(0,c.jsx)("div",{onClick:x,className:"pt-5 cursor-pointer text-xl-22 xl:hidden",children:(0,c.jsx)(r.Rt,{className:"ml-4"})}),(0,c.jsx)("div",{className:"p-2.5 xl:p-[18px] xl:shadow-header max-xl:w-[calc(100%-47px)]",children:(0,c.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2.5",children:[(0,c.jsxs)("div",{className:"w-full xl:w-auto",children:[(0,c.jsx)("h1",{className:"mb-1 text-2xl max-xl:truncate xl:text-3xl",children:m(null!==l&&void 0!==l?l:(e=>{let t="";if(e.split("/")[2].includes("-")){return e.split("/")[2].split("-").forEach((e=>(t=t+e[0].toUpperCase()+e.slice(1)+" ",t))),t}return t=e.split("/")[2][0].toUpperCase()+e.split("/")[2].slice(1),t})(v.pathname))}),(0,c.jsx)(i.A,{})]}),t&&(0,c.jsx)("div",{className:"flex gap-2.5 max-xl:w-[calc(100%+40px)] lg:gap-5",children:(()=>{if(t)return t()})()})]})})]})}},9369:(e,t,l)=>{l.d(t,{Sf:()=>h,UV:()=>u,hZ:()=>f,hn:()=>g,qs:()=>y,wt:()=>v,x9:()=>x});var a,n,s,i,r,d,o,c,m=l(57528),p=l(70459);const u=(0,p.J1)(a||(a=(0,m.A)(["\n  mutation DeleteTemplate($templateId: String!) {\n    deleteTemplate(templateId: $templateId) {\n      message\n    }\n  }\n"]))),v=(0,p.J1)(n||(n=(0,m.A)(["\n  mutation CreateTemplate($templateData: CreateTemplatesDto!) {\n    createTemplate(templateData: $templateData) {\n      message\n      data {\n        uuid\n        title\n        description\n        status\n      }\n    }\n  }\n"]))),x=(0,p.J1)(s||(s=(0,m.A)(["\n  mutation SendAnnouncements($announcementData: SendAnnouncementDto!) {\n    sendAnnouncements(announcementData: $announcementData) {\n      message\n      data {\n        title\n        description\n        users {\n          email\n          uuid\n          first_name\n          last_name\n          phone_number\n        }\n      }\n    }\n  }\n"]))),h=(0,p.J1)(i||(i=(0,m.A)(["\n  mutation ActivateDeActivateTemplate($templateId: String!) {\n    activateDeActivateTemplate(templateId: $templateId) {\n      message\n    }\n  }\n"]))),g=(0,p.J1)(r||(r=(0,m.A)(["\n  mutation UpdateTemplate($templateData: UpdateTemplatesDto!) {\n    updateTemplate(templateData: $templateData) {\n      message\n      data {\n        uuid\n        title\n        description\n        status\n      }\n    }\n  }\n"]))),y=((0,p.J1)(d||(d=(0,m.A)(["\n  mutation DeleteSystemEmailTemplate($systemEmailTemplateId: String!) {\n    deleteSystemEmailTemplate(systemEmailTemplateId: $systemEmailTemplateId) {\n      message\n    }\n  }\n"]))),(0,p.J1)(o||(o=(0,m.A)(["\n  mutation ActivateDeActivateSystemEmailTemplate($systemEmailTemplateId: String!) {\n    activateDeActivateSystemEmailTemplate(systemEmailTemplateId: $systemEmailTemplateId) {\n      message\n    }\n  }\n"])))),f=(0,p.J1)(c||(c=(0,m.A)(["\n  mutation UpdateSystemEmailTemplate($systemEmailTemplateData: UpdateTemplateDto!) {\n    updateSystemEmailTemplate(systemEmailTemplateData: $systemEmailTemplateData) {\n      message\n      data {\n        uuid\n        name\n        title\n        description\n        status\n      }\n    }\n  }\n"])))},85569:(e,t,l)=>{l.d(t,{DT:()=>p,Kl:()=>u,R5:()=>c,Uj:()=>m,z4:()=>v});var a,n,s,i,r,d=l(57528),o=l(70459);const c=(0,o.J1)(a||(a=(0,d.A)(["\n  query GetTemplatesWithFilterAndPagination($sortOrder: String!, $limit: Float!, $page: Float!, $search: String!, $sortField: String!) {\n    getTemplatesWithFilterAndPagination(sortOrder: $sortOrder, limit: $limit, page: $page, search: $search, sortField: $sortField) {\n      message\n      data {\n        templates {\n          uuid\n          title\n          description\n          status\n        }\n        count\n      }\n    }\n  }\n"]))),m=(0,o.J1)(n||(n=(0,d.A)(["\n  query GetTemplateById($getTemplateByIdId: String!) {\n    getTemplateById(id: $getTemplateByIdId) {\n      message\n      data {\n        description\n        status\n        title\n        uuid\n      }\n    }\n  }\n"]))),p=(0,o.J1)(s||(s=(0,d.A)(["\n  query GetSystemEmailTemplatesWithPagination($filterData: SystemEmailTemplateListDto!) {\n    getSystemEmailTemplatesWithPagination(filterData: $filterData) {\n      message\n      data {\n        templates {\n          uuid\n          title\n          description\n          status\n        }\n        count\n      }\n    }\n  }\n"]))),u=(0,o.J1)(i||(i=(0,d.A)(["\n  query GetSystemEmailTemplateById($systemEmailTemplateId: String!) {\n    getSystemEmailTemplateById(systemEmailTemplateId: $systemEmailTemplateId) {\n      message\n      data {\n        uuid\n        name\n        title\n        description\n        status\n      }\n    }\n  }\n"]))),v=(0,o.J1)(r||(r=(0,d.A)(["\n  query GetUsersForAnnouncementPagination($userType: [Int!]!, $sortOrder: String!, $sortField: String!, $limit: Float!, $page: Float!, $search: String!) {\n    getUsersForAnnouncementPagination(userType: $userType, sortOrder: $sortOrder, sortField: $sortField, limit: $limit, page: $page, search: $search) {\n      message\n      data {\n        users {\n          uuid\n          first_name\n          last_name\n          email\n          phone_number\n          user_type\n        }\n        count\n      }\n    }\n  }\n"])))},11734:(e,t,l)=>{l.r(t),l.d(t,{default:()=>A});var a=l(65043),n=l(63516),s=l(74117),i=l(41290),r=l(73216),d=l(91188),o=l(12209),c=l(88250),m=l(31881),p=l(85569),u=l(8848),v=l(42145),x=l(18232),h=(l(15675),l(59140),l(28610)),g=l(9369),y=l(64526),f=l(51027),j=l(13370),T=l(92823),b=l.n(T),N=l(70579);const A=()=>{var e,t,l,T,A,F,_;const $=(0,r.Zp)(),{t:w}=(0,s.Bd)(),[S,E]=(0,a.useState)([]),{data:I,loading:D}=(0,c.I)(p.R5,{variables:{sortOrder:"DESC",sortField:"createdAt",limit:1e3,page:1,search:""}}),[k,C]=(0,a.useState)([]),[U,B]=(0,m.n)(g.x9),J=(0,n.Wx)({initialValues:{description:"",template_id:"",notification_type:"Email",template_for:"",selectedTemplatesFor:[],title:""},onSubmit:e=>{var t,l,a;const n=null===e||void 0===e||null===(t=e.selectedTemplatesFor)||void 0===t?void 0:t.map((e=>e.code));U({variables:{announcementData:{title:null===e||void 0===e?void 0:e.title,description:null===e||void 0===e?void 0:e.description,template_id:null===e||void 0===e?void 0:e.template_id,notification_type:null===e||void 0===e?void 0:e.notification_type,user_type:null===e||void 0===e?void 0:e.template_for,role_ids:"Role"===(null===J||void 0===J||null===(l=J.values)||void 0===l?void 0:l.template_for)?n:[],user_ids:"User"===(null===J||void 0===J||null===(a=J.values)||void 0===a?void 0:a.template_for)?n:[]}}}).then((e=>{const t=e.data.sendAnnouncements;y.oR.success(null===t||void 0===t?void 0:t.message),J.resetForm()})).catch((e=>{var t,l,a,n;y.oR.error(null===e||void 0===e||null===(t=e.networkError)||void 0===t||null===(l=t.result)||void 0===l||null===(a=l.errors)||void 0===a||null===(n=a[0])||void 0===n?void 0:n.message)}))}}),{data:R,loading:P}=(0,c.I)(p.Uj,{variables:{getTemplateByIdId:J.values.template_id},skip:!(null!==J&&void 0!==J&&null!==(e=J.values)&&void 0!==e&&e.template_id)}),{data:q,loading:O}=(0,c.I)(h.Jo,{variables:{limit:1e3,page:1,search:"",sortOrder:"descend",sortField:"createdAt"},skip:"Role"!==(null===J||void 0===J||null===(t=J.values)||void 0===t?void 0:t.template_for)}),{data:V,loading:G}=(0,c.I)(p.z4,{variables:{limit:1e3,page:1,search:"",sortOrder:"descend",sortField:"createdAt",userType:[3,4,5,6,7]},skip:"User"!==(null===J||void 0===J||null===(l=J.values)||void 0===l?void 0:l.template_for)});(0,a.useEffect)((()=>{var e,t,l;const a=[];null===I||void 0===I||null===(e=I.getTemplatesWithFilterAndPagination)||void 0===e||null===(t=e.data)||void 0===t||null===(l=t.templates)||void 0===l||l.map((e=>{a.push({name:null===e||void 0===e?void 0:e.title,key:null===e||void 0===e?void 0:e.uuid})})),E(a)}),[I]);const W=(0,a.useCallback)((()=>{var e;const t=null===J||void 0===J||null===(e=J.values)||void 0===e?void 0:e.description,l=(0,v.N6)(t);/^ *$/.test(l)?J.setFieldValue("courseDescription",""):J.setFieldValue("courseDescription",t)}),[J.values.description]),z=(0,a.useCallback)((()=>{$(-1)}),[]);(0,a.useEffect)((()=>{var e,t,l;const a=[];null===q||void 0===q||null===(e=q.getActiveRoles)||void 0===e||null===(t=e.data)||void 0===t||null===(l=t.role)||void 0===l||l.map((e=>{a.push({name:null===e||void 0===e?void 0:e.name,code:null===e||void 0===e?void 0:e.uuid})})),C(a)}),[q]),(0,a.useEffect)((()=>{var e,t,l;const a=[];null===V||void 0===V||null===(e=V.getUsersForAnnouncementPagination)||void 0===e||null===(t=e.data)||void 0===t||null===(l=t.users)||void 0===l||l.map((e=>{a.push({name:null===e||void 0===e?void 0:e.first_name,code:null===e||void 0===e?void 0:e.uuid})})),C(a)}),[V]),(0,a.useEffect)((()=>{var e,t,l,a,n,s;null!==R&&void 0!==R&&null!==(e=R.getTemplateById)&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.description&&(J.setFieldValue("description",null===R||void 0===R||null===(l=R.getTemplateById)||void 0===l||null===(a=l.data)||void 0===a?void 0:a.description),J.setFieldValue("title",null===R||void 0===R||null===(n=R.getTemplateById)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.title))}),[null===R||void 0===R||null===(T=R.getTemplateById)||void 0===T?void 0:T.data]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(o.A,{headerTitle:"Send Announcement"}),(D||P||O||G||(null===B||void 0===B?void 0:B.loading))&&(0,N.jsx)(f.a,{}),(0,N.jsxs)("div",{className:"w-[calc(100%-40px)] md:w-[calc(100%-56px)]",children:[(0,N.jsx)("form",{className:"border border-solid border-border-primary rounded-xl ",children:(0,N.jsxs)("div",{className:"p-3 rounded-xl md:p-5",children:[(0,N.jsx)("h6",{className:"leading-[30px] mb-3 md:mb-5",children:w("Announcement")}),(0,N.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,N.jsx)("div",{className:"w-full lg:w-[calc(50%-10px)]",children:(0,N.jsx)(u.A,{placeholder:"Select template",className:"w-full",label:w("Select template"),onChange:J.handleChange,name:"template_id",value:J.values.template_id,error:J.errors.template_id&&J.touched.template_id?J.errors.template_id:"",options:S,id:"template_id",required:!0})}),(0,N.jsx)("div",{children:(0,N.jsx)(d.A,{required:!0,checked:J.values.notification_type,onChange:J.handleChange,name:"notification_type",id:"notification_type",radioOptions:v.sH,label:w("Template Type")})}),(0,N.jsxs)("div",{className:"mb-2",children:[(0,N.jsx)("div",{className:"mb-2",children:(0,N.jsxs)("label",{children:[w("Description")," ",w("English")," ",(0,N.jsx)("span",{className:"text-red-700",children:"*"})]})}),(0,N.jsx)(b(),{value:J.values.description,modules:{toolbar:[[{header:[1,2,!1]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link"],["clean"]]},formats:["header","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image"],onBlur:()=>W(),onChange:e=>(e=>{const t=e||"";""===t?(J.setFieldValue("description",""),J.setFieldError("description","")):(J.setFieldValue("description",t),J.setFieldTouched("description",!0),J.setFieldError("description",""))})(e)}),(0,N.jsx)("p",{className:"error",children:J.errors.description&&J.touched.description&&J.errors.description})]}),(0,N.jsx)("div",{className:"w-full lg:w-[calc(50%-10px)]",children:(0,N.jsx)(u.A,{placeholder:"Select Template For",className:"w-full",label:w("Select Template For"),onChange:J.handleChange,name:"template_for",value:J.values.template_for,error:J.errors.template_for&&J.touched.template_for?J.errors.template_for:"",options:[{name:"Users",key:"User"},{name:"Roles",key:"Role"}],id:"template_for",required:!0})}),(null===J||void 0===J||null===(A=J.values)||void 0===A?void 0:A.template_for)&&(0,N.jsxs)("div",{className:"mb-2",children:[(0,N.jsxs)("label",{children:[w("Template For"),(0,N.jsx)("span",{className:"text-red-700",children:"*"})]}),"Role"!==(null===J||void 0===J||null===(F=J.values)||void 0===F?void 0:F.template_for)&&(0,N.jsx)("div",{className:"w-full lg:w-[calc(50%-10px)]",children:(0,N.jsx)(j.K,{value:J.values.selectedTemplatesFor,options:k,onChange:e=>{J.setFieldValue("selectedTemplatesFor",e.value)},optionLabel:"name",placeholder:"Users List",itemTemplate:e=>(0,N.jsx)("div",{className:"flex align-items-center",children:(0,N.jsx)("div",{children:e.name})}),className:"w-full md:w-20rem sendAnnouncement",display:"chip"})}),"Role"===(null===J||void 0===J||null===(_=J.values)||void 0===_?void 0:_.template_for)&&(0,N.jsx)("div",{className:"max-h-[93px] md:max-h-[130px] overflow-auto",children:(0,N.jsx)(x.q,{multiple:!0,value:J.values.selectedTemplatesFor,onChange:e=>{J.setFieldValue("selectedTemplatesFor",e.value)},id:"selectedTemplatesFor",name:"selectedTemplatesFor",options:k,optionLabel:"name",className:"w-full md:w-14rem"})})]})]})]})}),(0,N.jsxs)("div",{className:"flex items-start justify-start gap-[22px] col-span-3 btn-group py-[30px]",children:[(0,N.jsx)(i.A,{className:"btn-primary btn-normal w-[200px]",type:"button",label:w("Send Announcement"),onClick:J.handleSubmit,title:"".concat(w("Send Announcement"))}),(0,N.jsx)(i.A,{className:"btn-secondary btn-normal w-[166px]",label:w("Cancel"),onClick:z,title:"".concat(w("Cancel"))})]})]})]})}}}]);
//# sourceMappingURL=1734.2b07949b.chunk.js.map