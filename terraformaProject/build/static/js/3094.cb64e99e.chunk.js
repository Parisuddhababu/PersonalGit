"use strict";(self.webpackChunkterraforma_systems=self.webpackChunkterraforma_systems||[]).push([[3094],{80909:(e,n,t)=>{t.d(n,{NV:()=>m,bg:()=>u,tT:()=>p});var s,a,r,l,i,d,o=t(57528),c=t(70459);(0,c.J1)(s||(s=(0,o.A)(["\n  query FetchAnnouncementsWithFilters($page: Int, $limit: Int, $sortBy: String, $sortOrder: String, $title: String, $startDate: String, $endDate: String, $announcementType: String, $platform: String, $status: Int) {\n    fetchAnnouncementsWithFilters(page: $page, limit: $limit, sortBy: $sortBy, sortOrder: $sortOrder, title: $title, start_date: $startDate, end_date: $endDate, announcement_type: $announcementType, platform: $platform, status: $status) {\n      data {\n        announcementData {\n          id\n          uuid\n          user_id\n          title\n          description\n          announcement_type\n          email_attachment\n          push_image\n          platform\n          userType\n          userFilter\n          userToExclude\n          onlySendTo\n          start_date\n          end_date\n          status\n          created_at\n          updated_at\n        }\n        count\n      }\n      meta {\n        message\n        messageCode\n        statusCode\n        status\n        type\n        errors {\n          errorField\n          error\n        }\n        errorType\n      }\n    }\n  }"])));const m=(0,c.J1)(a||(a=(0,o.A)(["\nquery GetUsersWithPagination($page: Int, $limit: Int, $sortBy: String, $sortOrder: String, $firstName: String, $lastName: String, $email: String, $status: Int, $gender: Int, $phoneNo: String) {\n  getUsersWithPagination(page: $page, limit: $limit, sortBy: $sortBy, sortOrder: $sortOrder, first_name: $firstName, last_name: $lastName, email: $email, status: $status, gender: $gender, phone_no: $phoneNo) {\n    data {\n      userList {\n        id\n        uuid\n        first_name\n        middle_name\n        last_name\n        user_name\n        email\n        gender\n        date_of_birth\n        phone_no\n        phone_country_id\n        role\n        profile_img\n        device_type\n        status\n        user_role_id\n        created_at\n        updated_at\n      }\n      count\n    }\n    meta {\n      message\n      messageCode\n      statusCode\n      status\n      type\n      errors {\n        errorField\n        error\n      }\n      errorType\n    }\n  }\n}\n"]))),u=((0,c.J1)(r||(r=(0,o.A)(["\n  query GetAnnouncementHistoryForUser($sortOrder: String!, $sortField: String!, $limit: Float!, $page: Float!, $search: String!) {\n    getAnnouncementHistoryForUser(sortOrder: $sortOrder, sortField: $sortField, limit: $limit, page: $page, search: $search) {\n      message\n      data {\n        announcements {\n          uuid\n          title\n          description\n          createdAt\n        }\n        count\n      }\n    }\n  }\n"]))),(0,c.J1)(l||(l=(0,o.A)(["\n  query GetAnnouncementsForUser {\n    getAnnouncementsForUser {\n      message\n      data {\n        announcements {\n          uuid\n          title\n          description\n          createdAt\n        }\n        count\n      }\n    }\n  }\n"])))),p=(0,c.J1)(i||(i=(0,o.A)(["\n  query GetAnnouncementById($announcementId: String!) {\n    getAnnouncementById(announcementId: $announcementId) {\n      message\n      data {\n        title\n        uuid\n        description\n        createdAt\n      }\n    }\n  }\n"])));(0,c.J1)(d||(d=(0,o.A)(["\n  query GetAnnouncementsForUser {\n    getAnnouncementsForUser {\n      message\n      data {\n        announcements {\n          uuid\n          title\n          description\n        }\n        count\n      }\n    }\n  }\n"])))},93094:(e,n,t)=>{t.r(n),t.d(n,{default:()=>x});var s=t(65043),a=t(74117),r=t(73216),l=t(64526),i=t(42145),d=t(41290),o=t(33556),c=t(34764),m=t(32254),u=t(77654),p=t(80909),g=t(88250),h=t(70579);const x=()=>{var e,n,t,x,v,f,b,N,j,y,$,A,_,S,w,F,C,I,O,k,T;const{t:B}=(0,a.Bd)(),J=(0,r.g)(),U=(0,r.Zp)(),{data:D,refetch:L}=(0,g.I)(p.tT),[P,E]=(0,s.useState)(""),[q,G]=(0,s.useState)({limit:10,page:1,sortBy:"",sortOrder:""}),R=[{name:"Sr.No",sortable:!1},{name:"Name",sortable:!0,fieldName:"first_name"},{name:"Email",sortable:!0,fieldName:"email"},{name:"Device Type",sortable:!0,fieldName:"device_type"},{name:"Role",sortable:!0,fieldName:"role"},{name:"Created At",sortable:!0,fieldName:"created_at"}];(0,s.useEffect)((()=>{null!==J&&void 0!==J&&J.id&&L({fetchSingleAnnouncementId:parseInt(J.id)}).catch((e=>l.oR.error(e)))}),[J.id]);const W=(0,s.useCallback)((()=>{U("/".concat(i.bw.app,"/").concat(i.bw.announcement,"/list"))}),[]),H=10*(q.page-1),M=H+q.page,Y=null===D||void 0===D||null===(e=D.fetchSingleAnnouncement)||void 0===e||null===(n=e.data)||void 0===n||null===(t=n.usersList)||void 0===t?void 0:t.filter((e=>e.first_name.toLowerCase().includes(P.toLowerCase()))).slice(H,M),z=(0,s.useCallback)((()=>{var e,n,t;null===D||void 0===D||null===(e=D.fetchSingleAnnouncement)||void 0===e||null===(n=e.data)||void 0===n||null===(t=n.usersList)||void 0===t||t.filter((e=>e.first_name.toLowerCase().includes(P.toLowerCase())))}),[]),[V]=(0,s.useState)(q.limit),Z=(null===D||void 0===D||null===(x=D.fetchAnnouncementsWithFilters)||void 0===x||null===(v=x.data)||void 0===v?void 0:v.count)||1,K=Math.ceil(Z/V),Q=(0,s.useCallback)((e=>{const n={...q,page:e};G(n),m.A.saveState("viewAnnouncement",JSON.stringify(n))}),[]);(0,s.useEffect)((()=>{const e=m.A.getState("viewAnnouncement",JSON.stringify(q));if(e){const n=JSON.parse(e);G(n)}}),[]);const X=(0,s.useCallback)((e=>{E(e.target.value)}),[]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"mb-6 bg-white shadow-lg rounded overflow-auto md:w-full ",children:[(0,h.jsxs)("div",{className:"border-b border-[#c8ced3] bg-[#f0f3f5] py-3 px-5 flex items-center justify-between",children:[(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(o.vE,{className:"mr-2",fontSize:"12px"}),(0,h.jsx)("span",{children:B("Announcement")})]}),(0,h.jsx)(d.A,{className:"btn-primary btn-normal",label:B("Back"),onClick:W,children:(0,h.jsx)(o.uI,{})})]}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 m-4",children:[(0,h.jsxs)("div",{className:"flex pb-2",children:[(0,h.jsxs)("p",{className:"font-bold",children:[B("Title")," : "]}),(0,h.jsx)("p",{className:"px-3",children:null===D||void 0===D||null===(f=D.fetchSingleAnnouncement)||void 0===f||null===(b=f.data)||void 0===b?void 0:b.announcement.title})]}),(0,h.jsxs)("div",{className:"flex  pb-2 ",children:[(0,h.jsxs)("p",{className:"font-bold",children:[B("Type")," : "]}),(0,h.jsxs)("p",{className:"px-3",children:[" ",null===(null===D||void 0===D||null===(N=D.fetchSingleAnnouncement)||void 0===N||null===(j=N.data)||void 0===j?void 0:j.announcement.annoucemnt_type)?"-":null===D||void 0===D||null===(y=D.fetchSingleAnnouncement)||void 0===y||null===($=y.data)||void 0===$?void 0:$.announcement.annoucemnt_type]})]}),(0,h.jsxs)("div",{className:"flex  pb-2 ",children:[(0,h.jsxs)("p",{className:"font-bold",children:[B("Platform")," : "]}),(0,h.jsxs)("p",{className:"px-3",children:[" ",null===D||void 0===D||null===(A=D.fetchSingleAnnouncement)||void 0===A||null===(_=A.data)||void 0===_?void 0:_.announcement.platform]})]}),(0,h.jsxs)("div",{className:"flex  pb-2 ",children:[(0,h.jsxs)("p",{className:"font-bold",children:[B("Status")," : "]}),(0,h.jsxs)("p",{className:"px-3 ml-2  w-20",children:[1===(null===D||void 0===D||null===(S=D.fetchSingleAnnouncement)||void 0===S||null===(w=S.data)||void 0===w?void 0:w.announcement.status)?(0,h.jsx)("span",{className:"badge badge-success rounded",children:"Active"}):(0,h.jsx)("span",{className:"badge badge-danger rounded",children:"InActive"})," "]})]}),(0,h.jsxs)("div",{className:"flex  pb-2 ",children:[(0,h.jsxs)("p",{className:"font-bold",children:[B("Advanced Filter")," : "]}),(0,h.jsxs)("p",{className:"px-3",children:[" ",null===D||void 0===D||null===(F=D.fetchSingleAnnouncement)||void 0===F||null===(C=F.data)||void 0===C?void 0:C.announcement.userFilter]})]}),(0,h.jsxs)("div",{className:"flex pb-2 ",children:[(0,h.jsxs)("p",{className:"font-bold",children:[B("Description")," : "]}),(0,h.jsxs)("p",{className:"px-3",children:[" ",(0,h.jsx)("p",{dangerouslySetInnerHTML:{__html:null===D||void 0===D||null===(I=D.fetchSingleAnnouncement)||void 0===I||null===(O=I.data)||void 0===O?void 0:O.announcement.description}})]})]})]})]}),"userToExclude"===(null===D||void 0===D||null===(k=D.fetchSingleAnnouncement)||void 0===k||null===(T=k.data)||void 0===T?void 0:T.announcement.userFilter)?(0,h.jsxs)("div",{className:"mb-3 bg-white shadow-lg rounded-sm overflow-auto ",children:[(0,h.jsxs)("div",{className:"bg-gray-200 p-3 flex items-center justify-between",children:[(0,h.jsxs)("div",{className:"flex mb-2 mr-2",children:[(0,h.jsx)(o.YJ,{}),B("Excluded Users")]}),(0,h.jsx)(d.A,{className:"btn-primary btn-normal",label:B("Refresh"),onClick:z,title:"".concat(B("Reset")),children:(0,h.jsx)("div",{className:"mr-4",children:(0,h.jsx)(o.Yn,{})})})]}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 l:grid-cols-4 gap-6",children:[(0,h.jsx)("div",{className:"flex mb-4"}),(0,h.jsx)("div",{className:"btn-group mt-6 mr-4 flex items-start justify-end ",children:(0,h.jsx)(c.A,{type:"text",value:P,onChange:X,placeholder:"Search Users"})})]}),(0,h.jsxs)("div",{className:"p-3 overflow-auto custom-dataTable ",children:[(0,h.jsxs)("table",{children:[(0,h.jsx)("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:(0,h.jsx)("tr",{children:null===R||void 0===R?void 0:R.map(((e,n)=>(0,h.jsx)("th",{scope:"col",className:"px-6 py-3   border border-slate-500",children:(0,h.jsxs)("div",{className:"flex items-center",children:[e.name,e.sortable&&(0,h.jsxs)("a",{onClick:()=>{return n=e.fieldName,void G({...q,sortBy:n,sortOrder:"asc"===q.sortOrder?"desc":"asc"});var n},children:[(""===q.sortOrder||q.sortBy!==e.fieldName)&&(0,h.jsx)(o.xs,{}),"asc"===q.sortOrder&&q.sortBy===e.fieldName&&(0,h.jsx)(o.Re,{}),"desc"===q.sortOrder&&q.sortBy===e.fieldName&&(0,h.jsx)(o.nG,{})]})]})},"".concat(n+1))))})}),(0,h.jsx)("tbody",{children:Y.map(((e,n)=>{var t,s;return(0,h.jsxs)("tr",{className:"bg-white border-b dark:bg-gray-800 dark:border-gray-700   border border-slate-500",children:[(0,h.jsx)("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white   border border-slate-500",children:n+1}),(0,h.jsx)("td",{className:"px-6 py-4   border border-slate-500",children:e.first_name+e.last_name}),(0,h.jsx)("td",{className:"px-6 py-4   border border-slate-500",children:e.email}),(0,h.jsx)("td",{className:"px-6 py-4   border border-slate-500",children:null!==(t=e.device_type)&&void 0!==t?t:"null"}),(0,h.jsx)("td",{className:"px-6 py-4   border border-slate-500",children:(0,h.jsxs)("div",{className:" w-20",children:[" ",(s=null===e||void 0===e?void 0:e.role,0===s?"Customer":1===s?"Admin":2===s?"SuperAdmin":"-")]})}),(0,h.jsx)("td",{className:"px-6 py-4   border border-slate-500",children:"".concat(e.created_at.slice(0,10)," ").concat(e.created_at.slice(11,19))})]},"".concat(n+1))}))})]}),null===Y&&(0,h.jsx)("div",{className:"flex justify-center",children:(0,h.jsx)("div",{children:"No Data"})})]}),(0,h.jsxs)("div",{className:"p-3 flex items-center justify-between mt-8",children:[(0,h.jsxs)("span",{className:"text-slate-400",children:["".concat(Y.length," "),(0,h.jsx)("span",{className:"ml-1",children:B("Total Records")})]}),(0,h.jsx)(u.A,{currentPage:q.page,totalPages:K,onPageChange:Q,recordsPerPage:V})]})]}):""]})}}}]);
//# sourceMappingURL=3094.cb64e99e.chunk.js.map