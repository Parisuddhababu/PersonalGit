"use strict";(self.webpackChunkterraforma_systems=self.webpackChunkterraforma_systems||[]).push([[2882],{43592:(e,n,a)=>{a.d(n,{A:()=>m});var o=a(65043),r=a(88250),l=a(47217),i=a(85408),t=a(79456),s=a(18998),d=a(73216),c=a(70579);const u=e=>{let{error:n}=e;const[a,u]=(0,o.useState)([]),m=(0,d.g)(),{data:p}=(0,r.I)(i.kA),v=(0,t.wA)(),{countryData:h}=(0,t.d4)((e=>e.country));return(0,o.useEffect)((()=>{if(null!==p&&void 0!==p&&p.getCountries){var e;const n=[];null===p||void 0===p||null===(e=p.getCountries)||void 0===e||e.data.map((e=>{n.push({value:e.uuid,label:"".concat(e.phoneCode," ").concat(e.name)})})),u(n)}}),[p]),(0,o.useEffect)((()=>{null!==m&&void 0!==m&&m.id||v((0,s.l)(null===a||void 0===a?void 0:a[0]))}),[a,m]),(0,c.jsxs)("div",{className:"inline-block w-full",children:[(0,c.jsx)(l.Ay,{options:a,value:h,onChange:e=>{v((0,s.l)(e))},placeholder:"Code",className:"[&>div]:rounded-xl [&_div]:my-0 [&>div]:py-px md:[&>div]:py-1.5 [&_input]:h-[32px] [&_div]:py-0]"}),n&&(0,c.jsx)("span",{className:"relative block mt-1 md:text-xs-15 error",children:n})]})},m=o.memo(u)},38225:(e,n,a)=>{a.d(n,{Cu:()=>c,Hv:()=>u,LW:()=>m,bZ:()=>v,tO:()=>p});var o,r,l,i,t,s=a(57528),d=a(70459);const c=(0,d.J1)(o||(o=(0,s.A)(["\nmutation CreateSuperAdminCompanyDirectory($superAdminCompanyDirectoryData: SuperAdminCompanyDirectoryDto!) {\n  createSuperAdminCompanyDirectory(superAdminCompanyDirectoryData: $superAdminCompanyDirectoryData) {\n    data {\n      uuid\n      name\n      description\n      website_url\n      email\n      country {\n        uuid\n        name\n        countryCode\n        phoneCode\n      }\n      phone_number\n      location\n      image_url\n    }\n    message\n  }\n}\n"]))),u=(0,d.J1)(r||(r=(0,s.A)(["\n  mutation UpdateSuperAdminCompanyDirectory($companyId: String!, $companyDirectoryData: SuperAdminCompanyDirectoryDto!) {\n    updateSuperAdminCompanyDirectory(companyId: $companyId, companyDirectoryData: $companyDirectoryData) {\n      message\n      data {\n        uuid\n        name\n        description\n        website_url\n        email\n        country {\n          uuid\n          name\n          countryCode\n          phoneCode\n        }\n        phone_number\n        image_url\n        location\n      }\n    }\n}"]))),m=(0,d.J1)(l||(l=(0,s.A)(["\n  mutation DeleteCompanyDirectory($companyId: String!) {\n    deleteCompanyDirectory(companyId: $companyId) {\n      message\n      data {\n        uuid\n        name\n        description        \n        email\n        country {\n          uuid\n          name\n          countryCode\n          phoneCode\n        }\n        phone_number        \n      }\n    }\n}"]))),p=(0,d.J1)(i||(i=(0,s.A)(["\nmutation CreateCompanyDirectoryVote($companyDirectoryId: String!) {\n  createCompanyDirectoryVote(companyDirectoryId: $companyDirectoryId) {\n    message\n    data {\n      id\n      uuid\n      company_directory {\n        uuid\n        name\n        description\n        website_url\n        email\n        country {\n          id\n          uuid\n          name\n          countryCode\n          phoneCode\n        }\n        phone_number\n      }\n    }\n  }\n}"]))),v=(0,d.J1)(t||(t=(0,s.A)(["\nmutation CreateCompanyDirectory($companyDirectoryData: CompanyDirectoryDto!) {\n  createCompanyDirectory(companyDirectoryData: $companyDirectoryData) {\n    message\n    data {\n      uuid\n      name\n      description\n      website_url\n      email\n      country {\n        id\n        uuid\n        name\n        countryCode\n        phoneCode\n      }\n      phone_number\n    }\n  }\n}"])))},69664:(e,n,a)=>{a.r(n),a.d(n,{default:()=>C});var o=a(65043),r=a(63516),l=a(74117),i=a(31881),t=a(64526),s=(a(15675),a(59140),a(82485)),d=(a(9686),a(41290)),c=a(33556),u=a(34764),m=a(38225),p=a(12352),v=a(66925),h=a(25263),y=a(55797),b=a(42145),x=a(43592),f=a(79456),g=a(70579);const C=function(e){var n,a;const{t:C}=(0,l.Bd)(),[w,D]=(0,o.useState)(!1),[_,j]=(0,o.useState)(!1),{addCompanyValidationSchema:N}=(0,p.A)(),[A,S]=(0,o.useState)(!1),[k,I]=(0,i.n)(m.Cu),[E,R]=(0,i.n)(m.Hv),[F,$]=(0,o.useState)(!1),[B,V]=(0,o.useState)(""),{countryData:L}=(0,f.d4)((e=>e.country)),z=(0,o.useRef)(null),U=(0,o.createRef)(),[W,q]=(0,o.useState)(!1);(0,o.useEffect)((()=>{D(!0),j(!0)}),[]);const J=(0,r.Wx)({initialValues:{country_id:"",description:"",email:"",location:"",name:"",phone_number:"",website_url:"",image_url:""},validationSchema:N,onSubmit:async n=>{var a;if(null!==e&&void 0!==e&&null!==(a=e.onData)&&void 0!==a&&a.uuid){var o;const a={country_id:n.country_id,description:n.description,email:n.email,location:n.location,name:n.name,phone_number:n.phone_number,website_url:n.website_url,image_url:n.image_url};E({variables:{companyDirectoryData:a,companyId:String(null===e||void 0===e||null===(o=e.onData)||void 0===o?void 0:o.uuid)}}).then((n=>{var a;const o=n.data;t.oR.success(null===o||void 0===o||null===(a=o.updateSuperAdminCompanyDirectory)||void 0===a?void 0:a.message),J.resetForm(),e.onCloseAddForm(),e.onDataRefetch()})).catch((e=>{var n,a,o;t.oR.error(null===e||void 0===e||null===(n=e.networkError)||void 0===n||null===(a=n.result)||void 0===a||null===(o=a.errors[0])||void 0===o?void 0:o.message)}))}else k({variables:{superAdminCompanyDirectoryData:{country_id:n.country_id,description:n.description,email:n.email,location:n.location,name:n.name,phone_number:n.phone_number,website_url:n.website_url,image_url:n.image_url}}}).then((n=>{var a;const o=n.data;t.oR.success(null===o||void 0===o||null===(a=o.createSuperAdminCompanyDirectory)||void 0===a?void 0:a.message),J.resetForm(),e.onCloseAddForm(),e.onData()})).catch((e=>{var n,a,o;t.oR.error(null===e||void 0===e||null===(n=e.networkError)||void 0===n||null===(a=n.result)||void 0===a||null===(o=a.errors[0])||void 0===o?void 0:o.message)}))}});(0,o.useEffect)((()=>{L&&J.setFieldValue("country_id",null===L||void 0===L?void 0:L.value)}),[L]),(0,o.useEffect)((()=>{var n,a,o,r,l,i,t,s,d;null!==e&&void 0!==e&&null!==(n=e.onData)&&void 0!==n&&n.uuid&&J.setValues({country_id:null===e||void 0===e||null===(a=e.onData)||void 0===a?void 0:a.country_uuid,description:null===e||void 0===e||null===(o=e.onData)||void 0===o?void 0:o.description,email:null===e||void 0===e||null===(r=e.onData)||void 0===r?void 0:r.email,location:null===e||void 0===e||null===(l=e.onData)||void 0===l?void 0:l.location,name:null===e||void 0===e||null===(i=e.onData)||void 0===i?void 0:i.name,phone_number:null===e||void 0===e||null===(t=e.onData)||void 0===t?void 0:t.phone_number,website_url:null===e||void 0===e||null===(s=e.onData)||void 0===s?void 0:s.website_url,image_url:null===e||void 0===e||null===(d=e.onData)||void 0===d?void 0:d.image_url})}),[]);const H=e=>J.errors[e]&&J.touched[e]?J.errors[e]:"",M=(0,o.useCallback)((e=>{J.setFieldValue(e.target.name,(0,v.AW)(e))}),[]),O=(0,o.useCallback)((e=>{e.preventDefault();const n=e.target.files;if(n&&n.length>0){const e=n[0];if(e.type.startsWith("image/"))if(e.size>5242880)t.oR.error("Image size must be less than 5MB");else{const n=new FileReader;n.onload=()=>{V(n.result),$(!0)},n.readAsDataURL(e)}else t.oR.error("Please select a valid image file")}z.current&&(z.current.value="")}),[]);(0,o.useEffect)((()=>{var n;D(!0),j(!0),null!==e&&void 0!==e&&null!==(n=e.onData)&&void 0!==n&&n.uuid&&S(!0)}),[]);const Y=()=>(0,g.jsxs)("div",{className:"flex justify-end gap-5",children:[(0,g.jsx)(d.A,{className:"btn-secondary btn-normal w-full md:w-[160px] whitespace-nowrap",type:"button",label:"Cancel",onClick:()=>$(!1),title:"".concat(C("Cancel"))}),(0,g.jsx)(d.A,{className:"btn-primary btn-normal w-full md:w-[160px] whitespace-nowrap",type:"button",label:"Save",disabled:W,onClick:()=>(async()=>{var e;if("undefined"!==typeof(null===(e=U.current)||void 0===e?void 0:e.cropper)){var n;await q(!0);let e=null;const a=(0,b.Si)(null===(n=U.current)||void 0===n?void 0:n.cropper.getCroppedCanvas().toDataURL(),"image.png"),o=new FormData;o.append("image",a),e=await(0,b.V6)(o,""),e&&(J.setFieldValue("image_url",e),$(!1)),await q(!1)}})(),title:"".concat(C("Save"))})]});return(0,g.jsxs)(g.Fragment,{children:[w&&(0,g.jsx)("div",{id:"defaultModal",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"fixed top-0 left-0 right-0 z-50 h-screen bg-modal modal ".concat(w?"":"hidden"),children:(0,g.jsx)("div",{id:"changeUserStatusModel",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:" py-5 flex items-center justify-center h-full ".concat(_?"":"opacity-0 transform -translate-y-full scale-150 "," transition-all duration-300 "),children:(0,g.jsx)("div",{className:"w-full mx-5 sm:max-w-[780px]",children:(0,g.jsxs)("div",{className:"relative bg-white rounded-xl",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b md:py-6 bg-accents-2 rounded-t-xl",children:[(0,g.jsx)("p",{className:"text-xl font-bold text-baseColor",children:A?"Update New Company":"Add New Company"}),(0,g.jsx)(d.A,{onClick:e.onCloseAddForm,label:C(""),title:"".concat(C("Close")),children:(0,g.jsx)("span",{className:"text-xl-22",children:(0,g.jsx)(c.YY,{className:"text-error"})})})]}),(0,g.jsx)("div",{className:"w-full",children:(0,g.jsxs)("form",{children:[(0,g.jsxs)("div",{className:"p-5 bg-white max-h-[calc(100vh-260px)] overflow-auto",children:[(0,g.jsxs)("div",{className:"box-border flex flex-col items-center justify-center p-3 mb-5 border border-solid border-border-primary rounded-xl",children:[(0,g.jsxs)("label",{htmlFor:"image_url",className:"relative flex flex-col items-center justify-center",children:[(0,g.jsx)("div",{className:"flex items-center justify-center w-32 h-32 overflow-hidden border border-gray-300 border-solid rounded-full cursor-pointer sm:w-44 sm:h-44",children:null!==J&&void 0!==J&&null!==(n=J.values)&&void 0!==n&&n.image_url?(0,g.jsx)("img",{src:"".concat("https://terraforma-staging.s3.us-west-2.amazonaws.com","/").concat(J.values.image_url),alt:"Logo",className:"object-contain w-full h-full bg-black"}):(0,g.jsx)("img",{src:h,alt:"image_url",className:"object-contain w-full h-full bg-black"})}),(0,g.jsx)("input",{type:"file",id:"image_url",name:"image_url",accept:"image/*",onChange:O,ref:z,className:"hidden"}),(0,g.jsx)("div",{className:"absolute bottom-0 p-2 text-2xl font-bold text-white rounded-full right-1 sm:right-2 bg-primary",children:(0,g.jsx)(c.i7,{})})]}),J.errors.image_url&&J.touched.image_url?(0,g.jsx)("span",{className:"relative mt-2 md:text-xs-15 error",children:J.errors.image_url}):""]}),(0,g.jsxs)("div",{className:"flex flex-wrap gap-x-5",children:[(0,g.jsx)("div",{className:"mb-3 sm:mb-5 w-full sm:w-[calc(50%-10px)]",children:(0,g.jsx)(u.A,{onBlur:M,placeholder:C("Enter Name of Company"),required:!0,name:"name",onChange:J.handleChange,label:C("Name of Company"),value:J.values.name,error:H("name")})}),(0,g.jsx)("div",{className:"mb-3 sm:mb-5 w-full sm:w-[calc(50%-10px)]",children:(0,g.jsx)(u.A,{onBlur:M,placeholder:C("Enter Website URL"),required:!0,name:"website_url",onChange:J.handleChange,label:C("Website URL"),value:J.values.website_url,error:H("website_url")})}),(0,g.jsxs)("div",{className:"mb-3 sm:mb-5 w-full sm:w-[calc(50%-10px)]",children:[(0,g.jsxs)("span",{children:["Select Country Code ",(0,g.jsx)("span",{className:"error",children:"*"})]}),(0,g.jsx)(x.A,{error:null===J||void 0===J||null===(a=J.errors)||void 0===a?void 0:a.country_id})]}),(0,g.jsx)("div",{className:"mb-3 sm:mb-5 w-full sm:w-[calc(50%-10px)]",children:(0,g.jsx)(u.A,{onBlur:M,placeholder:C("Enter Contact Number"),required:!0,name:"phone_number",type:"tel",onChange:J.handleChange,label:C("Contact Number"),value:J.values.phone_number,error:H("phone_number")})}),(0,g.jsx)("div",{className:"mb-3 sm:mb-5 w-full sm:w-[calc(50%-10px)]",children:(0,g.jsx)(u.A,{onBlur:M,placeholder:C("Enter Email ID"),required:!0,name:"email",onChange:J.handleChange,label:C("Email ID"),value:J.values.email,error:H("email")})}),(0,g.jsx)("div",{className:"mb-3 sm:mb-5 w-full sm:w-[calc(50%-10px)]",children:(0,g.jsx)(u.A,{onBlur:M,placeholder:C("Enter Location"),required:!0,name:"location",onChange:J.handleChange,label:C("Location"),value:J.values.location,error:H("location")})}),(0,g.jsxs)("div",{children:[(0,g.jsxs)("label",{htmlFor:"textarea",children:["Company Details ",(0,g.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,g.jsx)("textarea",{id:"description",name:"description",rows:4,cols:83,value:J.values.description,onBlur:M,placeholder:"Enter Company Details",onChange:J.handleChange,className:"border border-border-primary rounded-xl p-3.5 w-full focus:bg-white",style:{resize:"none"}}),(0,g.jsx)("p",{className:"error",children:J.errors.description&&J.touched.description&&J.errors.description})]})]})]}),(0,g.jsxs)("div",{className:"flex flex-col items-center justify-end p-5 border-t border-solid md:space-x-3 md:flex-row border-border-primary",children:[(0,g.jsx)(d.A,{className:"btn-primary btn-normal mb-2 md:mb-0 w-full md:w-auto min-w-[160px]",type:"button",onClick:()=>J.handleSubmit(),label:"Submit",disabled:(null===I||void 0===I?void 0:I.loading)||(null===R||void 0===R?void 0:R.loading),title:"".concat(C("Submit"))}),(0,g.jsx)(d.A,{className:"btn-secondary btn-normal w-full md:w-[160px]",label:C("Cancel"),onClick:e.onCloseAddForm,title:"".concat(C("Cancel"))})]})]})})]})})})}),(0,g.jsx)(y.l,{className:"custom-dialog",header:"Crop Image",visible:F,style:{width:"50vw"},onHide:()=>$(!1),footer:()=>Y(),children:B&&(0,g.jsx)(s.A,{ref:U,style:{height:400,width:"100%"},zoomTo:.5,aspectRatio:1,preview:".img-preview",src:B,viewMode:1,minCropBoxHeight:10,minCropBoxWidth:10,background:!1,responsive:!0,autoCropArea:1,checkOrientation:!1,guides:!0,cropBoxResizable:!1})})]})}},25263:(e,n,a)=>{e.exports=a.p+"static/media/sidebar-logo.d6fce7850bbfb0f38fbe.png"}}]);
//# sourceMappingURL=2882.df049e77.chunk.js.map