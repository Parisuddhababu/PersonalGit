"use strict";(self.webpackChunkterraforma_systems=self.webpackChunkterraforma_systems||[]).push([[8647],{36238:(e,n,t)=>{t.d(n,{A:()=>d});var a=t(65043),r=t(74117),s=t(70579);const d=e=>{let{errors:n,touched:t,setFieldTouched:d,children:i}=e;return((e,n,t)=>{const{i18n:s}=(0,r.Bd)();(0,a.useEffect)((()=>(s.on("languageChanged",(()=>{Object.keys(e).forEach((e=>{Object.keys(n).includes(e)&&t(e)}))})),()=>{s.off("languageChanged",(()=>{}))})),[e])})(n,t,d),(0,s.jsx)(s.Fragment,{children:i})}},81612:(e,n,t)=>{t.d(n,{Fm:()=>l,H:()=>o,O9:()=>u,aZ:()=>m});var a,r,s,d,i=t(57528),c=t(70459);const l=(0,c.J1)(a||(a=(0,i.A)(["\nmutation DeleteEvent($deleteEventId: Int) {\n  deleteEvent(id: $deleteEventId) {\n    meta {\n      message\n      messageCode\n      statusCode\n      status\n      type\n      errors {\n        errorField\n        error\n      }\n      errorType\n    }\n  }\n}\n"]))),o=(0,c.J1)(r||(r=(0,i.A)(["\n  mutation UpdateEvent(\n    $updateEventId: Int\n    $eventName: String\n    $description: String\n    $sendNotification: Boolean\n    $address: String\n    $startDate: Date\n    $endDate: Date\n    $isRecurring: String\n    $recurrenceDate: Date\n    $participantMailIds: [String]\n  ) {\n    updateEvent(\n      id: $updateEventId\n      event_name: $eventName\n      description: $description\n      send_notification: $sendNotification\n      address: $address\n      start_date: $startDate\n      end_date: $endDate\n      is_reccuring: $isRecurring\n      reccurance_date: $recurrenceDate\n      participant_mail_ids: $participantMailIds\n    ) {\n      meta {\n        message\n        messageCode\n        statusCode\n        status\n      }\n    }\n  }\n"]))),u=(0,c.J1)(s||(s=(0,i.A)(["\n  mutation CreateEvent(\n    $eventName: String\n    $description: String\n    $sendNotification: Boolean\n    $address: String\n    $startDate: Date\n    $endDate: Date\n    $isRecurring: String\n    $recurrenceDate: Date\n  ) {\n    createEvent(\n      event_name: $eventName\n      description: $description\n      send_notification: $sendNotification\n      address: $address\n      start_date: $startDate\n      end_date: $endDate\n      is_reccuring: $isRecurring\n      reccurance_date: $recurrenceDate\n    ) {\n      meta {\n        message\n        messageCode\n        statusCode\n        status\n      }\n    }\n  }\n"]))),m=(0,c.J1)(d||(d=(0,i.A)(["mutation GroupDeleteEvents($groupDeleteEventsId: [Int]) {\n  groupDeleteEvents(id: $groupDeleteEventsId) {\n    meta {\n      message\n      messageCode\n      statusCode\n      status\n      type\n      errors {\n        errorField\n        error\n      }\n      errorType\n    }\n  }\n}"])))},95236:(e,n,t)=>{t.d(n,{IR:()=>o,Rl:()=>m,Zm:()=>l,eI:()=>u});var a,r,s,d,i=t(57528),c=t(70459);const l=(0,c.J1)(a||(a=(0,i.A)(["\n  query FetchEvents(\n    $page: Int\n    $limit: Int\n    $sortBy: String\n    $sortOrder: String\n    $eventName: String\n    $startDate: Date\n    $endDate: Date\n    $createdBy: Int\n  ) {\n    fetchEvents(\n      page: $page\n      limit: $limit\n      sortBy: $sortBy\n      sortOrder: $sortOrder\n      event_name: $eventName\n      start_date: $startDate\n      end_date: $endDate\n      created_by: $createdBy\n    ) {\n      data {\n        FetchEventData {\n          id\n          event_name\n          description\n          is_reccuring\n          start_date\n          end_date\n          User {\n            user_name\n          }\n        }\n        count\n      }\n      meta {\n        message\n        messageCode\n        statusCode\n        status\n      }\n    }\n  }\n"]))),o=(0,c.J1)(r||(r=(0,i.A)(["\nquery FetchEvent($fetchEventId: ID) {\n  fetchEvent(id: $fetchEventId) {\n    data {\n      id\n      uuid\n      event_name\n      description\n      email\n      address\n      is_reccuring\n      send_notification\n      start_date\n      end_date\n      status\n      participant_mail_ids\n      reccurance_date\n      created_at\n      updated_at\n      created_by\n    }\n    meta {\n      message\n      messageCode\n      statusCode\n      status\n      type\n      errors {\n        errorField\n        error\n      }\n      errorType\n    }\n  }\n}\n"]))),u=(0,c.J1)(s||(s=(0,i.A)(["\n  query FetchEvents(\n    $createdBy: Int\n    $startDate: Date\n    $endDate: Date\n    $eventName: String\n    $sortOrder: String\n    $sortBy: String\n    $limit: Int\n    $page: Int\n  ) {\n    fetchEvents(\n      created_by: $createdBy\n      start_date: $startDate\n      end_date: $endDate\n      event_name: $eventName\n      sortOrder: $sortOrder\n      sortBy: $sortBy\n      limit: $limit\n      page: $page\n    ) {\n      data {\n        FetchEventData {\n          event_name\n          start_date\n          end_date\n          created_by\n          User {\n            user_name\n          }\n        }\n        count\n      }\n      meta {\n        message\n        messageCode\n        statusCode\n        status\n        type\n      }\n    }\n  }\n"]))),m=(0,c.J1)(d||(d=(0,i.A)(["\n  query FetchEvent($fetchEventId: ID) {\n    fetchEvent(id: $fetchEventId) {\n      data {\n        id\n        event_name\n        description\n        email\n        is_reccuring\n        start_date\n        end_date\n      }\n      meta {\n        message\n        messageCode\n        statusCode\n        status\n      }\n    }\n  }\n"])))},58647:(e,n,t)=>{t.r(n),t.d(n,{default:()=>y});var a=t(65043),r=t(64526),s=t(74117),d=t(73216),i=t(42145),c=t(41290),l=t(33556),o=t(91188),u=t(34764),m=t(36238),v=t(95236),p=t(81612),h=t(12352),g=t(66925),D=t(86178),f=t.n(D),$=t(63516),x=t(88250),b=t(31881),_=t(70579);const y=()=>{const{t:e}=(0,s.Bd)(),{data:n,refetch:t}=(0,x.I)(v.IR),[D]=(0,b.n)(p.O9),[y]=(0,b.n)(p.H),N=(0,d.Zp)(),j=(0,d.g)(),{addEventValidationSchema:E}=(0,h.A)(),[C,I]=(0,a.useState)(!1),R=j.id?{eventName:"",description:"",sendNotification:!1,address:"",startDate:"",endDate:"",isRecurring:"0",recurrenceDate:"",participants:"",participantMailIds:""}:{eventName:"",description:"",sendNotification:!1,address:"",startDate:"",endDate:"",isRecurring:"0",recurrenceDate:""};(0,a.useEffect)((()=>{j.id&&t({fetchEventId:parseInt(j.id)}).catch((e=>{r.oR.error(e)}))}),[j.id]),(0,a.useEffect)((()=>{if(n&&j.id){var e;const t=null===n||void 0===n||null===(e=n.fetchEvent)||void 0===e?void 0:e.data;I(null===t||void 0===t?void 0:t.send_notification),k.setValues({eventName:null===t||void 0===t?void 0:t.event_name,description:null===t||void 0===t?void 0:t.description,sendNotification:null===t||void 0===t?void 0:t.send_notification,address:null===t||void 0===t?void 0:t.address,startDate:(0,g.eW)(null===t||void 0===t?void 0:t.start_date,i.DX.DateHoursMinFormat),endDate:(0,g.eW)(null===t||void 0===t?void 0:t.end_date,i.DX.DateHoursMinFormat),isRecurring:"never"==(null===t||void 0===t?void 0:t.is_recurring)?"0":"1",recurrenceDate:null===(null===t||void 0===t?void 0:t.participant_mail_ids)?"":(0,g.eW)(null===t||void 0===t?void 0:t.recurrence_date,i.DX.simpleDateFormat),participantMailIds:null===(null===t||void 0===t?void 0:t.participant_mail_ids)||0===(null===t||void 0===t?void 0:t.participant_mail_ids.length)?"":null===t||void 0===t?void 0:t.participant_mail_ids.join(",")}).catch((e=>{r.oR.error(e)}))}}),[n]);const k=(0,$.Wx)({initialValues:R,validationSchema:E,onSubmit:n=>{var t,a;const s="1"===n.isRecurring?{eventName:n.eventName,description:n.description,sendNotification:C,address:n.address,startDate:n.startDate,endDate:n.endDate,isRecurring:"daily",participantMailIds:null===n||void 0===n||null===(t=n.participantMailIds)||void 0===t?void 0:t.split(","),recurrenceDate:k.values.recurrenceDate}:{eventName:n.eventName,description:n.description,sendNotification:C,address:n.address,startDate:n.startDate,endDate:n.endDate,isRecurring:"never",participantMailIds:null===n||void 0===n||null===(a=n.participantMailIds)||void 0===a?void 0:a.split(",")};j.id?y({variables:{updateEventId:parseInt(j.id),...s}}).then((e=>{const n=e.data;200===n.updateEvent.meta.statusCode?(r.oR.success(n.updateEvent.meta.message),k.resetForm(),w()):r.oR.error(n.updateEvent.meta.message)})).catch((()=>{r.oR.error(e("Failed to update"))})):D({variables:{...s}}).then((e=>{const n=e.data;200===n.createEvent.meta.statusCode?(r.oR.success(n.createEvent.meta.message),N("/".concat(i.bw.app,"/").concat(i.bw.event,"/list")),k.resetForm()):r.oR.error(n.createEvent.meta.message)})).catch((()=>{r.oR.error(e("Failed to create"))}))}}),w=(0,a.useCallback)((()=>{N("/".concat(i.bw.app,"/").concat(i.bw.event,"/list"))}),[]),A=e=>k.errors[e]&&k.touched[e]?k.errors[e]:"",F=(0,a.useCallback)((e=>{k.setFieldValue(e.target.name,(0,g.AW)(e))}),[]);return(0,_.jsx)("div",{children:(0,_.jsx)(m.A,{errors:k.errors,touched:k.touched,setFieldTouched:k.setFieldTouched,children:(0,_.jsxs)("form",{className:"w-full bg-white shadow-md rounded pt-6 mb-4 border border-[#c8ced3]",onSubmit:k.handleSubmit,children:[(0,_.jsx)("div",{className:"flex justify-end pr-8 pb-2",children:(0,_.jsxs)("p",{children:[e("Fields marked with")," ",(0,_.jsx)("span",{className:"text-red-500",children:"*"})," ",e("are mandatory.")]})}),(0,_.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2  gap-6  px-8",children:[(0,_.jsx)("div",{children:(0,_.jsx)(u.A,{required:!0,placeholder:e("Event Name"),name:"eventName",onChange:k.handleChange,label:e("Event Name"),value:k.values.eventName,error:A("eventName"),onBlur:F})}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"block text-gray-700 text-sm font-normal mb-2",children:e("Send Notifications")}),(0,_.jsx)("div",{children:(0,_.jsx)("span",{onClick:e=>{e.preventDefault(),I((e=>!e))},className:"font-medium text-blue-600 dark:text-blue-500 hover:underline",children:(0,_.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer ",children:[(0,_.jsx)("input",{type:"checkbox",value:!0===C?1:0,className:"sr-only peer",name:"sendNotification",checked:C}),(0,_.jsx)("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-4 peer-focus:ring-red-700 dark:peer-focus:ring-red-800 dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content- after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary"})]})})})]}),(0,_.jsxs)("div",{children:[(0,_.jsxs)("label",{className:"block text-gray-700 text-sm font-normal mb-2",htmlFor:"password",children:[e("Description")," ",(0,_.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,_.jsx)("div",{className:"  shadow appearance-none   border rounded w-full  text-gray-700 flex items-center",children:(0,_.jsx)("textarea",{className:"w-full py-2 px-3",id:"Description",placeholder:"".concat(e("Description")),name:"description",onChange:k.handleChange,value:k.values.description,rows:2,cols:50,onBlur:F})}),void 0!=k.errors.description&&k.touched.description&&(0,_.jsx)("p",{className:"error",children:e(k.errors.description)})]}),(0,_.jsxs)("div",{children:[(0,_.jsxs)("label",{className:"block text-gray-700 text-sm font-normal mb-2",htmlFor:"Address",children:[e("Address")," ",(0,_.jsx)("span",{className:"text-red-500 ",children:"*"})]}),(0,_.jsx)("div",{className:" shadow appearance-none   border rounded w-full  text-gray-700 flex items-center",children:(0,_.jsx)("textarea",{className:"w-full py-2 px-3",id:"Address",placeholder:"".concat(e("Address")),name:"address",onChange:k.handleChange,value:k.values.address,rows:2,cols:50,onBlur:F})}),void 0!=k.errors.address&&k.touched.address?(0,_.jsx)("p",{className:"error",children:e(k.errors.address)}):""]}),(0,_.jsx)("div",{children:(0,_.jsx)(u.A,{required:!0,type:"datetime-local",id:"startDate",placeholder:e("Start Date"),name:"startDate",onChange:k.handleChange,label:e("Start Date"),value:k.values.startDate,error:A("startDate"),min:j.id?"".concat(k.values.startDate):f()().format(i.DX.DateHoursMinFormat),disabled:!!j.id})}),(0,_.jsx)("div",{children:(0,_.jsx)(u.A,{required:!0,type:"datetime-local",placeholder:e("End Date"),name:"endDate",id:"endDate",onChange:k.handleChange,label:e("End Date"),value:k.values.endDate,min:k.values.startDate,error:k.values.startDate&&A("endDate"),disabled:!k.values.startDate})}),(0,_.jsx)("div",{children:(0,_.jsx)(o.A,{id:"isRecurring",checked:k.values.isRecurring,onChange:k.handleChange,name:"isRecurring",radioOptions:[{name:e("Never"),key:0},{name:e("Daily"),key:1}],label:e("Recurrence"),required:!0})}),(0,_.jsx)("div",{children:"1"==k.values.isRecurring&&(0,_.jsx)(u.A,{type:"date",id:"recurrenceDate",placeholder:e("recurrenceDate"),name:"recurrenceDate",onChange:k.handleChange,label:e("Recurrence Date"),value:k.values.recurrenceDate,disabled:!(k.values.startDate&&k.values.endDate)})}),(0,_.jsx)("div",{children:n&&j.id&&(0,_.jsx)("div",{className:"mb-4",children:(0,_.jsx)(u.A,{type:"text",id:"participantMailIds",placeholder:e("Email"),name:"participantMailIds",onChange:k.handleChange,onBlur:F,label:e("Add Participants"),value:k.values.participantMailIds})})})]}),(0,_.jsxs)("div",{className:"btn-group col-span-3 flex items-center py-3 px-5  justify-start bg-slate-100   border border-[#c8ced3]",children:[(0,_.jsx)(c.A,{className:"btn-primary btn-normal",type:"submit",label:null!==j&&void 0!==j&&j.id?e("Update"):e("Save"),title:"".concat(null!==j&&void 0!==j&&j.id?e("Update"):e("Save")),children:(0,_.jsx)(l.rA,{className:"mr-2 text-white "})}),(0,_.jsx)(c.A,{className:"btn-warning btn-normal ",label:e("Cancel"),onClick:w,title:"".concat(e("Cancel")),children:(0,_.jsx)(l.YY,{className:"mr-1 fill-white"})})]})]})})})}}}]);
//# sourceMappingURL=8647.d3980e3b.chunk.js.map