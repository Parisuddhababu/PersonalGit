"use strict";(self.webpackChunkterraforma_systems=self.webpackChunkterraforma_systems||[]).push([[4543],{7648:(e,a,t)=>{t.d(a,{A:()=>m});var l=t(65043),r=t(74117),s=t(73216),n=t(35475),i=t(42145),o=t(79456),c=t(66925),d=t(70579);const u=()=>{var e,a,t;const{t:u}=(0,r.Bd)(),m=(0,s.zy)(),p=new URLSearchParams(m.search).get("uuid"),{id:g}=(0,s.g)(),{userProfileData:x}=(0,o.d4)((e=>e.userProfile)),h=null!==(e=null===x||void 0===x||null===(a=x.getProfile)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.user_type)&&void 0!==e?e:"",f=e=>{var a;let t="";if(null!==(a=e.split("/")[2])&&void 0!==a&&a.includes("-")){return e.split("/")[2].split("-").forEach((e=>{var a;return t=t+(null===(a=e[0])||void 0===a?void 0:a.toUpperCase())+e.slice(1)+" ",t})),t}var l;return t=(null===(l=e.split("/")[2][0])||void 0===l?void 0:l.toUpperCase())+e.split("/")[2].slice(1),t},v=e=>{let a="";if(null!==e&&void 0!==e&&e.includes("-")){a=null===e||void 0===e?void 0:e.replace(/-|\s/g," ");const t=a.split(" ");for(let e=0;e<t.length;e++)t[e]=t[e][0].toUpperCase()+t[e].substring(1);return a=t.join(" "),a}var t;return a=(null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))+" ",a},y=e=>{let a="";return null!==e&&void 0!==e&&e.includes("-")||(a=(null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))+" "),a;var t},b=m.pathname.split("/"),j=(0,l.useCallback)((()=>{if((null===b||void 0===b?void 0:b.length)>0){const e=null===b||void 0===b?void 0:b.length;if(e<4)return(0,d.jsx)("span",{className:"text-primary",children:b[2]&&"".concat(u(v(b[2])))});if(e<5)return""!==b[3]?b[3].length>32?(0,d.jsxs)(d.Fragment,{children:[y(b[3])&&(0,d.jsx)("span",{className:"text-primary",children:(0,d.jsx)(n.k2,{to:"/".concat(i.bw.app,"/").concat(b[2]),className:"text-light-grey hover:underline",children:"".concat(u(f(m.pathname)))})}),y(b[3])&&(0,d.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),!y(b[3])&&(0,d.jsx)("span",{className:"text-primary",children:b[2]&&"".concat(u(v(b[2])))}),(0,d.jsx)("span",{className:"text-primary",children:b[3]&&"".concat(u(y(b[3])))})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{className:"text-primary",children:(0,d.jsx)(n.k2,{to:"/".concat(i.bw.app,"/").concat(b[2]),className:"text-light-grey hover:underline",children:"".concat(u(f(m.pathname)))})}),(0,d.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,d.jsx)("span",{className:"text-primary",children:b[3]&&"".concat(u(v(b[3])))})]}):(0,d.jsx)("span",{className:"text-primary",children:b[2]&&"".concat(u(v(b[2])))});if(e<6)return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{className:"text-primary",children:(0,d.jsx)(n.k2,{to:"/".concat(i.bw.app,"/").concat(b[2]),className:"text-light-grey hover:underline",children:"".concat(u(f(m.pathname)))})}),(0,d.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,d.jsx)("span",{className:"text-primary",children:b[3]&&"".concat(u(v(b[3])))})]});if(e<7){let e="";return p?e="?uuid=".concat(p):g&&(e="?uuid=".concat(g)),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{className:"text-primary",children:(0,d.jsx)(n.k2,{to:"/".concat(i.bw.app,"/").concat(b[2]),className:"text-light-grey hover:underline",children:u(v(b[2]))})}),(0,d.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,d.jsx)("span",{className:"text-primary",children:(0,d.jsx)(n.k2,{to:"/".concat(i.bw.app,"/").concat(b[2],"/").concat(b[3],"/").concat((""!==p||""!==g)&&e),className:"text-light-grey hover:underline",children:u(v(b[3]))})}),(0,d.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,d.jsx)("span",{className:"text-primary",children:b[5]&&"".concat(u(v(b[4])))})]})}}}),[b]);return(0,d.jsx)("div",{className:"w-full",children:(0,d.jsxs)("p",{className:"max-xs:text-xs text-xs-14 max-md:truncate",children:[(0,d.jsxs)("span",{children:[(0,d.jsx)(n.k2,{to:(0,c.Go)(h,i.ve.SUPER_ADMIN,"/".concat(i.bw.app,"/").concat(i.bw.dashboard),"/".concat(i.bw.app,"/").concat(i.bw.subscriber)),className:"cursor-pointer text-light-grey hover:underline",children:u("Home")}),(0,d.jsx)("span",{className:"mx-2 text-light-grey",children:">"})]}),j()]})})},m=l.memo(u)},12209:(e,a,t)=>{t.d(a,{A:()=>u});var l=t(65043),r=t(74117),s=t(73216),n=t(7648),i=t(33556),o=t(79456),c=t(75214),d=t(70579);const u=e=>{let{headerActionConst:a,headerTitle:t}=e;const{t:u}=(0,r.Bd)(),m=(0,o.wA)(),{show:p}=(0,o.d4)((e=>e.coursesManagement)),g=(0,s.zy)(),x=(0,l.useCallback)((()=>{m((0,c.oM)(!p))}),[p]);return(0,d.jsxs)("header",{className:"sticky top-0 z-20 flex bg-white border-b shadow-header xl:shadow-none xl:h-auto xl:block border-border-primary xl:px-2 xl:pt-0",children:[(0,d.jsx)("div",{onClick:x,className:"pt-5 cursor-pointer text-xl-22 xl:hidden",children:(0,d.jsx)(i.Rt,{className:"ml-4"})}),(0,d.jsx)("div",{className:"p-2.5 xl:p-[18px] xl:shadow-header max-xl:w-[calc(100%-47px)]",children:(0,d.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2.5",children:[(0,d.jsxs)("div",{className:"w-full xl:w-auto",children:[(0,d.jsx)("h1",{className:"mb-1 text-2xl max-xl:truncate xl:text-3xl",children:u(null!==t&&void 0!==t?t:(e=>{let a="";if(e.split("/")[2].includes("-")){return e.split("/")[2].split("-").forEach((e=>(a=a+e[0].toUpperCase()+e.slice(1)+" ",a))),a}return a=e.split("/")[2][0].toUpperCase()+e.split("/")[2].slice(1),a})(g.pathname))}),(0,d.jsx)(n.A,{})]}),a&&(0,d.jsx)("div",{className:"flex gap-2.5 max-xl:w-[calc(100%+40px)] lg:gap-5",children:(()=>{if(a)return a()})()})]})})]})}},76755:(e,a,t)=>{t.d(a,{P:()=>o,v:()=>i});var l,r,s=t(57528),n=t(70459);const i=(0,n.J1)(l||(l=(0,s.A)(["\nquery GetManualCategories($sortOrder: String!, $sortField: String!, $limit: Float!, $page: Float!, $search: String!) {\n    getManualCategories(sortOrder: $sortOrder, sortField: $sortField, limit: $limit, page: $page, search: $search) {\n      message\n      data {\n        manualCategories {\n          name\n          uuid\n          children {\n            name\n            uuid\n            image_url\n          }\n        }\n        count\n      }\n    }\n  }"]))),o=(0,n.J1)(r||(r=(0,s.A)(["\nquery GetItemByCategoriesPagination($itemCategoryId: String!, $sortOrder: String!, $sortField: String!, $limit: Float!, $page: Float!, $search: String!) {\n  getItemByCategoriesPagination(itemCategoryId: $itemCategoryId, sortOrder: $sortOrder, sortField: $sortField, limit: $limit, page: $page, search: $search) {\n    message\n    data {\n      count\n      itemByCategories {\n        uuid\n        name\n        url\n        image\n      }\n    }\n  }\n}"])))},80409:(e,a,t)=>{t.r(a),t.d(a,{default:()=>S});var l,r=t(65043),s=t(64526),n=t(73216),i=t(74117),o=t(86213),c=t(63516),d=t(34764),u=t(41290),m=t(8848),p=t(31881),g=t(88250),x=t(42145),h=t(66925),f=t(57528);const v=(0,t(70459).J1)(l||(l=(0,f.A)(["\nmutation CreateItemByCategory($itemCategoryData: CreateItemCategoryDto!) {\n    createItemByCategory(itemCategoryData: $itemCategoryData) {\n      message\n      data {\n        uuid\n        name\n        url\n        category {\n          uuid\n          name\n          description\n          image_url\n        }\n      }\n    }\n  }\n"])));var y=t(76755),b=t(12352),j=t(12209),C=t(25263),w=t(33556),N=t(55797),_=t(82485),k=(t(15675),t(59140),t(9686),t(70579));const S=()=>{var e,a,t;const{t:l}=(0,i.Bd)(),f=(0,n.Zp)(),[S]=(0,p.n)(v),[F,A]=(0,r.useState)(!1),[$,M]=(0,r.useState)(C),{addUserManualValidationSchema:R}=(0,b.A)(),{data:B}=(0,g.I)(y.v,{variables:{limit:x.Wt,page:x.k2,sortField:"createdAt",sortOrder:"descend",search:""}}),[D,I]=(0,r.useState)([]),[P,U]=(0,r.useState)([]),[E,z]=(0,r.useState)(""),[O,T]=(0,r.useState)(!0),[V,q]=(0,r.useState)(!1),W=(0,r.useRef)(null),G=(0,r.createRef)();(0,r.useEffect)((()=>{if(null!==B&&void 0!==B&&B.getManualCategories){const e=B.getManualCategories.data.manualCategories.map((e=>({name:e.name,key:e.uuid})));I(e)}}),[B]);const H=(0,r.useCallback)((e=>{let a;if(e.preventDefault(),e.dataTransfer?a=e.dataTransfer.files:e.target&&(a=e.target.files),a&&a.length>0){const e=a[0];if(e.type.startsWith("image/"))if(e.size>x.w3)s.oR.error("Image size must be less than 5MB");else{const a=new FileReader;a.onload=()=>{M(a.result),A(!0)},a.readAsDataURL(e)}else s.oR.error("Please select a valid image file")}W.current&&(W.current.value="")}),[]),J=(0,c.Wx)({initialValues:{category_id:"",name:"",url:"",category_main_id:"",file_foreground_image:""},validationSchema:R,onSubmit:async e=>{await q(!0);const a=new FormData;a.append("file",e.url);try{const t=(await o.A.post(x.kA,a,{headers:{"Content-Type":"multipart/form-data"}})).data.data.key;S({variables:{itemCategoryData:{category_id:e.category_id,name:e.name,url:t,image:e.file_foreground_image}}}).then((e=>{var a;const t=e.data;s.oR.success(null===t||void 0===t||null===(a=t.createItemByCategory)||void 0===a?void 0:a.message),J.resetForm(),L()})).catch((e=>{s.oR.error(e.networkError.result.errors[0].message)}))}catch(t){s.oR.error("Error uploading image")}await q(!1)}});(0,r.useEffect)((()=>{if(null!==B&&void 0!==B&&B.getManualCategories){const e=B.getManualCategories.data.manualCategories.filter((e=>e.uuid===E)).flatMap((e=>e.children)).map((e=>({name:e.name,key:e.uuid})));U(e),T(0===e.length)}}),[B,E]);const L=(0,r.useCallback)((()=>{f(-1)}),[]),Y=(0,r.useCallback)((()=>{f(-1)}),[]),Z=(0,r.useCallback)((e=>{J.setFieldValue(e.target.name,(0,h.AW)(e))}),[]),K=e=>J.errors[e]&&J.touched[e]?J.errors[e]:"";(0,r.useEffect)((()=>{if(null!==B&&void 0!==B&&B.getManualCategories){const e=B.getManualCategories.data.manualCategories.filter((e=>e.uuid===E)).flatMap((e=>e.children)).map((e=>({name:e.name,key:e.uuid})));U(e)}}),[B,E]);const Q=async()=>{var e;if("undefined"!==typeof(null===(e=G.current)||void 0===e?void 0:e.cropper)){var a;await q(!0);let e=null;const t=(0,x.Si)(null===(a=G.current)||void 0===a?void 0:a.cropper.getCroppedCanvas().toDataURL(),"image.png"),l=new FormData;l.append("image",t),e=await(0,x.V6)(l,"technicalManual"),e&&(J.setFieldValue("file_foreground_image",e),A(!1)),await q(!1)}},X=(0,r.useCallback)((async()=>{J.setFieldValue("file_foreground_image","")}),[J]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(j.A,{headerTitle:"Add a Document"}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("form",{children:[(0,k.jsx)("div",{className:"flex flex-wrap items-start justify-center p-3 mb-5 border border-solid md:p-5 sm:justify-start lg:flex-nowrap md:mb-7 border-border-primary rounded-xl",children:(0,k.jsxs)("div",{className:"flex flex-wrap w-full gap-3 md:gap-5",children:[(0,k.jsx)("div",{className:"inline-block w-full xl:w-[calc(50%-10px)]",children:(0,k.jsx)(d.A,{error:K("name"),onBlur:Z,placeholder:l("Name"),name:"name",required:!0,label:l("Name"),type:"text",onChange:J.handleChange,value:J.values.name})}),(0,k.jsxs)("div",{className:"inline-block w-full xl:w-[calc(50%-10px)]",children:[(0,k.jsx)(m.A,{placeholder:l("Select Parent Category"),name:"category_main_id",onChange:e=>{const a=e.target.value;z(a),J.handleChange(e)},options:D,id:"category_main_id",label:l("Select Parent Category"),required:!0,value:E}),(0,k.jsx)("p",{className:"error",children:null===J||void 0===J||null===(e=J.errors)||void 0===e?void 0:e.category_main_id})]}),E&&(0,k.jsx)("div",{className:"inline-block w-full xl:w-[calc(50%-10px)]",children:(0,k.jsx)(m.A,{placeholder:l("Select Sub-Category"),name:"category_id",onChange:J.handleChange,id:"category_id",label:l("Select Sub-Category"),required:!0,options:P,disabled:O,value:J.values.category_id,error:K("category_id")})}),(0,k.jsxs)("div",{className:"inline-block w-full xl:w-[calc(50%-10px)]",children:[(0,k.jsxs)("label",{children:["Attachment ",(0,k.jsx)("span",{className:"text-red-500 ",children:"*"})]}),(0,k.jsx)("input",{type:"file",accept:".pdf",onChange:e=>{var a;const t=null===(a=e.target.files)||void 0===a?void 0:a[0];t&&("application/pdf"===t.type?t.size<=5242880?(J.setFieldValue("url",t),J.setFieldError("url","")):J.setFieldError("url","File size should be less than 5 MB"):J.setFieldError("url","Only PDF files are allowed"))},name:"file"}),J.errors.url?(0,k.jsx)("p",{className:"mt-2 error",children:l(J.errors.url)}):null]}),(0,k.jsxs)("div",{className:"inline-block w-full xl:w-[calc(50%-10px)]",children:[(0,k.jsxs)("label",{htmlFor:"logo",className:"relative flex flex-col items-center justify-center",children:[(0,k.jsx)("div",{className:"flex items-center justify-center overflow-hidden border border-solid rounded-full cursor-pointer border-border-primary w-44 h-44",children:(0,k.jsx)("img",{src:null!==J&&void 0!==J&&null!==(a=J.values)&&void 0!==a&&a.file_foreground_image?x.sT+J.values.file_foreground_image:C,alt:"file_foreground_image",className:"object-contain w-full h-full bg-black"})}),(0,k.jsx)("input",{type:"file",id:"logo",name:"file_foreground_image",accept:"image/*",ref:W,onChange:H,className:"hidden"})]}),(null===J||void 0===J||null===(t=J.values)||void 0===t?void 0:t.file_foreground_image)&&(0,k.jsx)(u.A,{className:"absolute p-[6px] rounded-full cursor-pointer top-4 right-4 md:top-3 md:right-4 bg-error text-lg md:text-xl",type:"button",label:"",onClick:()=>X(),title:"".concat(l("Close")),children:(0,k.jsx)(w.YY,{className:"fill-white"})}),J.errors.file_foreground_image&&J.touched.file_foreground_image?(0,k.jsx)("span",{className:"relative mt-2 md:text-xs-15 error",children:J.errors.file_foreground_image}):""]})]})}),(0,k.jsx)(u.A,{className:"mr-5 btn-primary btn-normal mb-3 md:mb-0 w-full md:w-[160px]",type:"button",disabled:V,onClick:()=>J.handleSubmit(),label:l("Save"),title:"".concat(l("Save"))}),(0,k.jsx)(u.A,{className:"btn-secondary btn-normal w-full md:w-[160px]",label:l("Cancel"),onClick:Y,title:"".concat(l("Cancel"))})]}),(0,k.jsx)(N.l,{className:"custom-dialog",header:"Crop Image",visible:F,style:{width:"50vw",borderRadius:"12px"},onHide:()=>A(!1),footer:()=>(0,k.jsxs)("div",{className:"flex justify-end gap-3 md:gap-5",children:[(0,k.jsx)(u.A,{className:"btn-secondary btn-normal w-full md:w-[160px] whitespace-nowrap",type:"button",label:"Cancel",onClick:()=>A(!1),title:"".concat(l("Cancel"))}),(0,k.jsx)(u.A,{className:"btn-primary btn-normal w-full md:w-[160px] whitespace-nowrap",type:"button",label:"Save",disabled:V,onClick:()=>Q(),title:"".concat(l("Save"))})]}),children:$&&(0,k.jsx)(_.I,{ref:G,style:{height:400,width:"100%"},zoomTo:.5,aspectRatio:1,preview:".img-preview",src:$,viewMode:1,minCropBoxHeight:10,minCropBoxWidth:10,background:!1,responsive:!0,autoCropArea:1,checkOrientation:!1,guides:!0,cropBoxResizable:!1})})]})]})}},25263:(e,a,t)=>{e.exports=t.p+"static/media/sidebar-logo.d6fce7850bbfb0f38fbe.png"}}]);
//# sourceMappingURL=4543.d1a0a341.chunk.js.map