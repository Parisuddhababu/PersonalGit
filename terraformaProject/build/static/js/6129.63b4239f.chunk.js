"use strict";(self.webpackChunkterraforma_systems=self.webpackChunkterraforma_systems||[]).push([[6129],{36238:(e,n,t)=>{t.d(n,{A:()=>i});var r=t(65043),a=t(74117),s=t(70579);const i=e=>{let{errors:n,touched:t,setFieldTouched:i,children:o}=e;return((e,n,t)=>{const{i18n:s}=(0,a.Bd)();(0,r.useEffect)((()=>(s.on("languageChanged",(()=>{Object.keys(e).forEach((e=>{Object.keys(n).includes(e)&&t(e)}))})),()=>{s.off("languageChanged",(()=>{}))})),[e])})(n,t,i),(0,s.jsx)(s.Fragment,{children:o})}},71995:(e,n,t)=>{t.d(n,{B8:()=>u,KZ:()=>p,Oe:()=>m,TF:()=>c,y1:()=>h});var r,a,s,i,o,l=t(57528),d=t(70459);const u=(0,d.J1)(r||(r=(0,l.A)(["\n  mutation UpdateSetRule(\n    $updateSetRuleId: Int\n    $ruleName: String\n    $description: String\n    $priority: priority\n    $onAction: on_action\n    $status: Int\n  ) {\n    updateSetRule(\n      id: $updateSetRuleId\n      rule_name: $ruleName\n      description: $description\n      priority: $priority\n      on_action: $onAction\n      status: $status\n    ) {\n      meta {\n        message\n        messageCode\n        statusCode\n        status\n      }\n    }\n  }\n"]))),c=(0,d.J1)(a||(a=(0,l.A)(["\n  mutation UpdateRuleStatus($updateRuleStatusId: Int, $status: Int) {\n    updateRuleStatus(id: $updateRuleStatusId, status: $status) {\n      data {\n        id\n        uuid\n        rule_name\n        description\n        priority\n        on_action\n        status\n        created_at\n        updated_at\n      }\n      meta {\n        message\n        messageCode\n        statusCode\n        status\n        type\n        errors {\n          errorField\n          error\n        }\n        errorType\n      }\n    }\n  }\n"]))),m=(0,d.J1)(s||(s=(0,l.A)(["\n  mutation DeleteSetRule($deleteSetRuleId: Int!) {\n    deleteSetRule(id: $deleteSetRuleId) {\n      meta {\n        message\n        messageCode\n        statusCode\n        status\n      }\n    }\n  }\n"]))),p=(0,d.J1)(i||(i=(0,l.A)(["\n  mutation CreateSetRule(\n    $ruleName: String!\n    $description: String!\n    $priority: priority!\n    $onAction: on_action!\n    $createdBy: Int!\n  ) {\n    createSetRule(\n      rule_name: $ruleName\n      description: $description\n      priority: $priority\n      on_action: $onAction\n      created_by: $createdBy\n    ) {\n      meta {\n        message\n        messageCode\n        statusCode\n        status\n      }\n    }\n  }\n"]))),h=(0,d.J1)(o||(o=(0,l.A)(["mutation GroupDeleteSetRules($groupDeleteSetRulesId: [Int]) {\n  groupDeleteSetRules(id: $groupDeleteSetRulesId) {\n    meta {\n      message\n      messageCode\n      statusCode\n      status\n      type\n      errors {\n        errorField\n        error\n      }\n      errorType\n    }\n  }\n}"])))},31955:(e,n,t)=>{t.d(n,{m:()=>l,n:()=>o});var r,a,s=t(57528),i=t(70459);const o=(0,i.J1)(r||(r=(0,s.A)(["\n  query FetchSetRules(\n    $page: Int\n    $ruleName: String\n    $status: Int\n    $limit: Int\n    $sortBy: String\n    $sortOrder: String\n  ) {\n    fetchSetRules(\n      page: $page\n      rule_name: $ruleName\n      status: $status\n      limit: $limit\n      sortBy: $sortBy\n      sortOrder: $sortOrder\n    ) {\n      data {\n        ruleData {\n          id\n          uuid\n          rule_name\n          description\n          times_triggered\n          priority\n          on_action\n          status\n          created_at\n          updated_at\n        }\n        count\n      }\n      meta {\n        message\n        messageCode\n        statusCode\n        status\n      }\n    }\n  }\n"]))),l=(0,i.J1)(a||(a=(0,s.A)(["\n  query FetchSingleSetRule($fetchSingleSetRuleId: ID) {\n    fetchSingleSetRule(id: $fetchSingleSetRuleId) {\n      data {\n        rule_name\n        description\n        priority\n        on_action\n        times_triggered\n        status\n      }\n      meta {\n        message\n        messageCode\n        statusCode\n        status\n      }\n    }\n  }\n"])))},26129:(e,n,t)=>{t.r(n),t.d(n,{default:()=>b});var r=t(88250),a=t(31881),s=t(41290),i=t(8848),o=t(33556),l=t(34764),d=t(42145),u=t(71995),c=t(31955),m=t(63516),p=t(65043),h=t(74117),g=t(73216),S=t(64526),y=t(12352),v=t(66925),R=t(36238),$=t(70579);const b=()=>{const{t:e}=(0,h.Bd)(),n=(0,g.Zp)(),t=(0,g.g)(),{data:b,refetch:x}=(0,r.I)(c.m),[N]=(0,a.n)(u.KZ),[f]=(0,a.n)(u.B8),{manageRuleSetValidationsSchema:A}=(0,y.A)(),C=[{name:e("Low"),key:"low"},{name:e("High"),key:"high"},{name:e("Medium"),key:"medium"}],j=[{name:e("Both"),key:"both"},{name:e("Signup"),key:"signup"},{name:e("Signin"),key:"signin"}];(0,p.useEffect)((()=>{null!==t&&void 0!==t&&t.id&&x({fetchSingleSetRuleId:parseInt(null===t||void 0===t?void 0:t.id)}).catch((e=>S.oR.error(e)))}),[null===t||void 0===t?void 0:t.id]),(0,p.useEffect)((()=>{if(null!==b&&void 0!==b&&b.fetchSingleSetRule&&null!==t&&void 0!==t&&t.id){var e;const n=null===b||void 0===b||null===(e=b.fetchSingleSetRule)||void 0===e?void 0:e.data;_.setValues({ruleName:null===n||void 0===n?void 0:n.rule_name,description:null===n||void 0===n?void 0:n.description,priority:null===n||void 0===n?void 0:n.priority,onAction:null===n||void 0===n?void 0:n.on_action}).catch((e=>{S.oR.error(e)}))}}),[null===b||void 0===b?void 0:b.fetchSingleSetRule]);const I=A,_=(0,m.Wx)({initialValues:{ruleName:"",description:"",priority:"1",onAction:""},validationSchema:I,onSubmit:r=>{t.id?f({variables:{updateSetRuleId:parseInt(t.id),ruleName:r.ruleName,description:r.description,priority:r.priority,onAction:r.onAction}}).then((e=>{const n=e.data;200===(null===n||void 0===n?void 0:n.updateSetRule.meta.statusCode)?(S.oR.success(null===n||void 0===n?void 0:n.updateSetRule.meta.message),_.resetForm(),w()):S.oR.error(n.updateSetRule.meta.message)})).catch((()=>{S.oR.error(e("Failed to update"))})):N({variables:{ruleName:r.ruleName,description:r.description,priority:r.priority,onAction:r.onAction,createdBy:2}}).then((e=>{const t=e.data;200===t.createSetRule.meta.statusCode?(S.oR.success(t.createSetRule.meta.message),n("/".concat(d.bw.app,"/").concat(d.bw.manageRulesSets,"/list")),_.resetForm()):S.oR.error(t.createSetRule.meta.message)})).catch((()=>{S.oR.error(e("Failed to create"))}))}}),w=(0,p.useCallback)((()=>{n("/".concat(d.bw.app,"/").concat(d.bw.manageRulesSets,"/list"))}),[]),k=(0,p.useCallback)((e=>{_.setFieldValue(e.target.name,(0,v.AW)(e))}),[]);return(0,$.jsx)("div",{children:(0,$.jsx)("div",{className:"w-full",children:(0,$.jsx)(R.A,{errors:_.errors,touched:_.touched,setFieldTouched:_.setFieldTouched,children:(0,$.jsxs)("form",{className:"bg-white shadow-md rounded  pt-6  mb-4 border border-[#c8ced3]",onSubmit:_.handleSubmit,children:[(0,$.jsx)("div",{className:"flex justify-end pr-8 pb-2",children:(0,$.jsxs)("p",{children:["Fields marked with ",(0,$.jsx)("span",{className:"text-red-500",children:"*"})," are mandatory."]})}),(0,$.jsxs)("div",{className:"px-8 grid grid-cols-1 md:grid-cols-2  gap-6",children:[(0,$.jsx)("div",{children:(0,$.jsx)(l.A,{required:!0,type:"text",id:"ruleName",placeholder:e("Rule Name"),name:"ruleName",onChange:_.handleChange,onBlur:k,label:e("Rule Name"),value:_.values.ruleName,error:_.errors.ruleName&&_.touched.ruleName?_.errors.ruleName:""})}),(0,$.jsxs)("div",{children:[(0,$.jsxs)("label",{className:"block text-gray-700 text-sm font-normal mb-2",htmlFor:"description",children:[e("Description"),(0,$.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,$.jsx)("div",{className:"  shadow appearance-none   border rounded w-full text-gray-700 flex items-center",children:(0,$.jsx)("textarea",{id:"description",placeholder:"".concat(e("Description")),className:"w-full py-2 px-3",name:"description",onChange:_.handleChange,onBlur:k,value:_.values.description,rows:2,cols:50})}),void 0!=_.errors.description&&_.touched.description?(0,$.jsx)("p",{className:"error",children:e(_.errors.description)}):""]}),(0,$.jsx)("div",{children:(0,$.jsx)(i.A,{required:!0,name:"priority",onChange:_.handleChange,value:_.values.priority,options:C,id:"priority",label:e("Priority"),error:_.errors.priority&&_.touched.priority?_.errors.priority:""})}),(0,$.jsx)("div",{className:"mb-5",children:(0,$.jsx)(i.A,{required:!0,placeholder:e("Select Action"),name:"onAction",onChange:_.handleChange,value:_.values.onAction,options:j,id:"onAction",label:e("On Action"),error:_.errors.onAction&&_.touched.onAction?_.errors.onAction:""})})]}),(0,$.jsxs)("div",{className:"btn-group col-span-3 flex items-center py-3 px-5  justify-start bg-slate-100   border border-[#c8ced3]",children:[(0,$.jsx)(s.A,{className:"btn-primary btn-normal",type:"submit",label:t.id?e("Update"):e("Save"),title:"".concat(t.id?e("Update"):e("Save")),children:(0,$.jsx)(o.rA,{className:"mr-2 text-white "})}),(0,$.jsx)(s.A,{className:"btn-warning btn-normal ",label:e("Cancel"),onClick:w,title:"".concat(e("Close")),children:(0,$.jsx)(o.YY,{className:"mr-1 fill-white"})})]})]})})})})}}}]);
//# sourceMappingURL=6129.63b4239f.chunk.js.map