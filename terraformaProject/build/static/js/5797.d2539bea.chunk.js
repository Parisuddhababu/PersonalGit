"use strict";(self.webpackChunkterraforma_systems=self.webpackChunkterraforma_systems||[]).push([[5797],{7648:(e,l,t)=>{t.d(l,{A:()=>v});var i=t(65043),o=t(74117),n=t(73216),a=t(35475),r=t(42145),d=t(79456),s=t(66925),c=t(70579);const u=()=>{var e,l,t;const{t:u}=(0,o.Bd)(),v=(0,n.zy)(),m=new URLSearchParams(v.search).get("uuid"),{id:x}=(0,n.g)(),{userProfileData:p}=(0,d.d4)((e=>e.userProfile)),h=null!==(e=null===p||void 0===p||null===(l=p.getProfile)||void 0===l||null===(t=l.data)||void 0===t?void 0:t.user_type)&&void 0!==e?e:"",g=e=>{var l;let t="";if(null!==(l=e.split("/")[2])&&void 0!==l&&l.includes("-")){return e.split("/")[2].split("-").forEach((e=>{var l;return t=t+(null===(l=e[0])||void 0===l?void 0:l.toUpperCase())+e.slice(1)+" ",t})),t}var i;return t=(null===(i=e.split("/")[2][0])||void 0===i?void 0:i.toUpperCase())+e.split("/")[2].slice(1),t},j=e=>{let l="";if(null!==e&&void 0!==e&&e.includes("-")){l=null===e||void 0===e?void 0:e.replace(/-|\s/g," ");const t=l.split(" ");for(let e=0;e<t.length;e++)t[e]=t[e][0].toUpperCase()+t[e].substring(1);return l=t.join(" "),l}var t;return l=(null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))+" ",l},f=e=>{let l="";return null!==e&&void 0!==e&&e.includes("-")||(l=(null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))+" "),l;var t},N=v.pathname.split("/"),y=(0,i.useCallback)((()=>{if((null===N||void 0===N?void 0:N.length)>0){const e=null===N||void 0===N?void 0:N.length;if(e<4)return(0,c.jsx)("span",{className:"text-primary",children:N[2]&&"".concat(u(j(N[2])))});if(e<5)return""!==N[3]?N[3].length>32?(0,c.jsxs)(c.Fragment,{children:[f(N[3])&&(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(a.k2,{to:"/".concat(r.bw.app,"/").concat(N[2]),className:"text-light-grey hover:underline",children:"".concat(u(g(v.pathname)))})}),f(N[3])&&(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),!f(N[3])&&(0,c.jsx)("span",{className:"text-primary",children:N[2]&&"".concat(u(j(N[2])))}),(0,c.jsx)("span",{className:"text-primary",children:N[3]&&"".concat(u(f(N[3])))})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(a.k2,{to:"/".concat(r.bw.app,"/").concat(N[2]),className:"text-light-grey hover:underline",children:"".concat(u(g(v.pathname)))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:N[3]&&"".concat(u(j(N[3])))})]}):(0,c.jsx)("span",{className:"text-primary",children:N[2]&&"".concat(u(j(N[2])))});if(e<6)return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(a.k2,{to:"/".concat(r.bw.app,"/").concat(N[2]),className:"text-light-grey hover:underline",children:"".concat(u(g(v.pathname)))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:N[3]&&"".concat(u(j(N[3])))})]});if(e<7){let e="";return m?e="?uuid=".concat(m):x&&(e="?uuid=".concat(x)),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(a.k2,{to:"/".concat(r.bw.app,"/").concat(N[2]),className:"text-light-grey hover:underline",children:u(j(N[2]))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(a.k2,{to:"/".concat(r.bw.app,"/").concat(N[2],"/").concat(N[3],"/").concat((""!==m||""!==x)&&e),className:"text-light-grey hover:underline",children:u(j(N[3]))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:N[5]&&"".concat(u(j(N[4])))})]})}}}),[N]);return(0,c.jsx)("div",{className:"w-full",children:(0,c.jsxs)("p",{className:"max-xs:text-xs text-xs-14 max-md:truncate",children:[(0,c.jsxs)("span",{children:[(0,c.jsx)(a.k2,{to:(0,s.Go)(h,r.ve.SUPER_ADMIN,"/".concat(r.bw.app,"/").concat(r.bw.dashboard),"/".concat(r.bw.app,"/").concat(r.bw.subscriber)),className:"cursor-pointer text-light-grey hover:underline",children:u("Home")}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"})]}),y()]})})},v=i.memo(u)},12209:(e,l,t)=>{t.d(l,{A:()=>u});var i=t(65043),o=t(74117),n=t(73216),a=t(7648),r=t(33556),d=t(79456),s=t(75214),c=t(70579);const u=e=>{let{headerActionConst:l,headerTitle:t}=e;const{t:u}=(0,o.Bd)(),v=(0,d.wA)(),{show:m}=(0,d.d4)((e=>e.coursesManagement)),x=(0,n.zy)(),p=(0,i.useCallback)((()=>{v((0,s.oM)(!m))}),[m]);return(0,c.jsxs)("header",{className:"sticky top-0 z-20 flex bg-white border-b shadow-header xl:shadow-none xl:h-auto xl:block border-border-primary xl:px-2 xl:pt-0",children:[(0,c.jsx)("div",{onClick:p,className:"pt-5 cursor-pointer text-xl-22 xl:hidden",children:(0,c.jsx)(r.Rt,{className:"ml-4"})}),(0,c.jsx)("div",{className:"p-2.5 xl:p-[18px] xl:shadow-header max-xl:w-[calc(100%-47px)]",children:(0,c.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2.5",children:[(0,c.jsxs)("div",{className:"w-full xl:w-auto",children:[(0,c.jsx)("h1",{className:"mb-1 text-2xl max-xl:truncate xl:text-3xl",children:u(null!==t&&void 0!==t?t:(e=>{let l="";if(e.split("/")[2].includes("-")){return e.split("/")[2].split("-").forEach((e=>(l=l+e[0].toUpperCase()+e.slice(1)+" ",l))),l}return l=e.split("/")[2][0].toUpperCase()+e.split("/")[2].slice(1),l})(x.pathname))}),(0,c.jsx)(a.A,{})]}),l&&(0,c.jsx)("div",{className:"flex gap-2.5 max-xl:w-[calc(100%+40px)] lg:gap-5",children:(()=>{if(l)return l()})()})]})})]})}},4009:(e,l,t)=>{t.d(l,{v:()=>r,w:()=>d});var i,o,n=t(57528),a=t(70459);const r=(0,a.J1)(i||(i=(0,n.A)(["\nquery GetLocationsWithPagination($sortOrder: String!, $sortField: String!, $limit: Float!, $page: Float!, $citySearch: String!, $locationSearch: String!) {\n  getLocationsWithPagination(sortOrder: $sortOrder, sortField: $sortField, limit: $limit, page: $page, citySearch: $citySearch, locationSearch: $locationSearch) {\n    message\n    data {\n      location {\n        uuid\n        location\n        city\n        zoneCount\n      }\n      count\n    }\n  }\n}"]))),d=(0,a.J1)(o||(o=(0,n.A)(["query GetLocations {\n  getLocations {\n    message\n    data {\n      uuid\n      location\n      city\n      diversion_percentage\n      zoneCount\n    }\n  }\n}"])))},75797:(e,l,t)=>{t.r(l),t.d(l,{default:()=>y});var i,o=t(65043),n=t(8848),a=t(12209),r=t(33556),d=t(74117),s=t(42145),c=t(77654),u=t(32254),v=t(4009),m=t(88250),x=t(64526),p=t(79456),h=t(57528);const g=(0,t(70459).J1)(i||(i=(0,h.A)(["query GetDiversionContractorsWithPagination($locationId: String!, $sortOrder: String!, $sortField: String!, $limit: Float!, $page: Float!, $search: String!) {\n    getDiversionContractorsWithPagination(locationId: $locationId, sortOrder: $sortOrder, sortField: $sortField, limit: $limit, page: $page, search: $search) {\n      message\n      data {\n        count\n        diversionContractors {\n          uuid\n          subscriber {\n            uuid\n          }\n          location {\n            uuid\n            location\n          }\n          contractor_company {\n            name\n            uuid\n          }\n          service_count\n        }\n      }\n    }\n  }"])));var j=t(1099),f=t(73216),N=t(70579);const y=()=>{var e,l,t,i,h,y,b,w;const{t:C}=(0,d.Bd)(),k=(0,f.Zp)(),[P,S]=(0,o.useState)([]),{userProfileData:I}=(0,p.d4)((e=>e.userProfile)),{data:F,loading:_}=(0,m.I)(v.w,{fetchPolicy:"network-only",skip:(null===I||void 0===I||null===(e=I.getProfile)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.user_type)===s.ve.SUPER_ADMIN}),D=(0,p.d4)((e=>e.diversionContractors)),A=(0,p.wA)(),[$,O]=(0,o.useState)({limit:s.Wt,page:s.k2,sortOrder:"descend",search:"",sortField:"createdAt",locationId:"",index:0}),{refetch:R}=(0,m.I)(g,{fetchPolicy:"network-only",skip:!0});(0,o.useEffect)((()=>{var e,l,t,i,o,n,a,r,d,c,u,v,m,p,h,g,f,N,y,b,w,C;null!==F&&void 0!==F&&null!==(e=F.getLocations)&&void 0!==e&&e.data&&null!==I&&void 0!==I&&null!==(l=I.getProfile)&&void 0!==l&&null!==(t=l.data)&&void 0!==t&&t.user_type&&(null===I||void 0===I||null===(i=I.getProfile)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.user_type)===s.ve.SUBSCRIBER_ADMIN&&(S(null===F||void 0===F||null===(u=F.getLocations)||void 0===u||null===(v=u.data)||void 0===v?void 0:v.map((e=>({name:null===e||void 0===e?void 0:e.location,key:null===e||void 0===e?void 0:e.uuid,uuid:null===e||void 0===e?void 0:e.uuid})))),O((e=>{var l,t;return{...e,locationId:null===F||void 0===F||null===(l=F.getLocations)||void 0===l||null===(t=l.data[0])||void 0===t?void 0:t.uuid}})),R({limit:s.Wt,page:s.k2,sortOrder:"descend",search:"",sortField:"createdAt",locationId:null===F||void 0===F||null===(m=F.getLocations)||void 0===m||null===(p=m.data[0])||void 0===p?void 0:p.uuid}).then((e=>{var l,t;A((0,j.Jx)(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.getDiversionContractorsWithPagination)||void 0===t?void 0:t.data))})).catch((e=>{var l,t,i;return x.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(t=l.result)||void 0===t||null===(i=t.errors[0])||void 0===i?void 0:i.message)})));null!==F&&void 0!==F&&null!==(n=F.getLocations)&&void 0!==n&&n.data&&null!==I&&void 0!==I&&null!==(a=I.getProfile)&&void 0!==a&&null!==(r=a.data)&&void 0!==r&&r.user_type&&(null===I||void 0===I||null===(d=I.getProfile)||void 0===d||null===(c=d.data)||void 0===c?void 0:c.user_type)!==s.ve.SUBSCRIBER_ADMIN&&(S(null===F||void 0===F||null===(h=F.getLocations)||void 0===h||null===(g=h.data)||void 0===g?void 0:g.map((e=>({name:null===e||void 0===e?void 0:e.location,key:null===e||void 0===e?void 0:e.uuid,uuid:null===e||void 0===e?void 0:e.uuid})))),O({...$,locationId:null===I||void 0===I||null===(f=I.getProfile)||void 0===f||null===(N=f.data)||void 0===N||null===(y=N.branch_locations[0])||void 0===y?void 0:y.uuid}),R({limit:s.Wt,page:s.k2,sortOrder:"descend",search:"",sortField:"createdAt",locationId:null===I||void 0===I||null===(b=I.getProfile)||void 0===b||null===(w=b.data)||void 0===w||null===(C=w.branch_locations[0])||void 0===C?void 0:C.uuid}).then((e=>{var l,t;A((0,j.Jx)(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.getDiversionContractorsWithPagination)||void 0===t?void 0:t.data))})).catch((e=>{var l,t,i;return x.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(t=l.result)||void 0===t||null===(i=t.errors[0])||void 0===i?void 0:i.message)})))}),[null===F||void 0===F?void 0:F.getLocations,I]);const[E,L]=(0,o.useState)($.limit),U=null!==(t=null===D||void 0===D||null===(i=D.contractorData)||void 0===i?void 0:i.count)&&void 0!==t?t:0,W=Math.ceil(U/E),J=(0,o.useCallback)((e=>{const l={...$,page:e,index:(e-1)*$.limit};O(l),R({limit:null===$||void 0===$?void 0:$.limit,page:e,sortOrder:null===$||void 0===$?void 0:$.sortOrder,sortField:null===$||void 0===$?void 0:$.sortField,locationId:null===$||void 0===$?void 0:$.locationId}).then((e=>{var l,t;A((0,j.Jx)(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.getDiversionContractorsWithPagination)||void 0===t?void 0:t.data))})).catch((e=>{var l,t,i;return x.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(t=l.result)||void 0===t||null===(i=t.errors[0])||void 0===i?void 0:i.message)})),u.A.saveState("filterDiversionReport",JSON.stringify(l))}),[$.limit]);(0,o.useEffect)((()=>{L($.limit)}),[$.limit]);const B=[{name:C("Sr.No"),sortable:!1},{name:C("Title"),sortable:!1,fieldName:"contractor_company.name"},{name:C("Services Count"),sortable:!1,fieldName:"service_count"}],M=(0,o.useCallback)((e=>{var l,t,i;k("/".concat(s.bw.app,"/").concat(s.bw.diversionContractor,"/").concat(s.bw.createDiversionReport,"/?locationId=").concat(null===e||void 0===e||null===(l=e.location)||void 0===l?void 0:l.uuid,"&companyId=").concat(null===e||void 0===e||null===(t=e.contractor_company)||void 0===t?void 0:t.uuid,"&companyName=").concat(null===e||void 0===e||null===(i=e.contractor_company)||void 0===i?void 0:i.name))}),[]),z=(0,o.useCallback)((e=>{O((l=>({...l,locationId:e.target.value}))),R({...$,locationId:e.target.value}).then((e=>{var l,t;A((0,j.Jx)(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.getDiversionContractorsWithPagination)||void 0===t?void 0:t.data))})).catch((e=>{var l,t,i;return x.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(t=l.result)||void 0===t||null===(i=t.errors[0])||void 0===i?void 0:i.message)}))}),[]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(a.A,{headerActionConst:()=>{var e,l;return(0,N.jsx)(N.Fragment,{children:(0,N.jsx)("div",{className:"flex w-full gap-3 xmd:gap-5 lg:w-auto ".concat(_?"pointer-events-none":""),children:(0,N.jsx)(n.A,{className:"w-[212px] -mt-2 max-md:mr-2",label:"",inputIcon:(0,N.jsx)(r.T5,{fontSize:"18"}),name:"diversionReportTemplateData.location_id",onChange:z,value:null===$||void 0===$?void 0:$.locationId,options:P,id:"userLocation",disabled:(null===I||void 0===I||null===(e=I.getProfile)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.user_type)!==s.ve.SUBSCRIBER_ADMIN})})})}}),(0,N.jsxs)("div",{className:"mb-3 bg-white rounded-xl overflow-auto border border-[#c8ced3] mx-7 p-3 md:p-5",children:[(0,N.jsx)("div",{className:"flex flex-col justify-between gap-3 mb-3 sm:gap-5 md:mb-5 btn-group sm:flex-row",children:(0,N.jsx)("h6",{className:"w-full leading-7 xmd:w-auto",children:C("Contractors")})}),(0,N.jsxs)("div",{className:"w-full mb-3 overflow-auto bg-white border sm:w-auto rounded-t-xl custom-dataTable border-border-primary",children:[(0,N.jsxs)("table",{children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[null===B||void 0===B?void 0:B.map((e=>(0,N.jsx)("th",{scope:"col",children:(0,N.jsxs)("div",{className:"flex items-center ".concat(["service_count"].includes(e.fieldName)?"justify-center":""),children:[e.name,e.sortable&&(0,N.jsxs)("button",{onClick:()=>{return l=e.fieldName,O({...$,sortField:l,sortOrder:"ascend"===$.sortOrder?"descend":"ascend"}),void R({limit:null===$||void 0===$?void 0:$.limit,page:null===$||void 0===$?void 0:$.page,sortOrder:"ascend"===$.sortOrder?"descend":"ascend",sortField:l,locationId:null===$||void 0===$?void 0:$.locationId}).then((e=>{var l,t;A((0,j.Jx)(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.getDiversionContractorsWithPagination)||void 0===t?void 0:t.data))})).catch((e=>{var l,t,i;return x.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(t=l.result)||void 0===t||null===(i=t.errors[0])||void 0===i?void 0:i.message)}));var l},children:[(""===$.sortOrder||$.sortField!==e.fieldName)&&(0,N.jsx)(r.xs,{className:"w-3 h-3 ml-1 fill-white"}),"ascend"===$.sortOrder&&$.sortField===e.fieldName&&(0,N.jsx)(r.xD,{className:"ml-1 fill-white"}),"descend"===$.sortOrder&&$.sortField===e.fieldName&&(0,N.jsx)(r.xR,{className:"ml-1 fill-white"})]})]})},e.name))),(0,N.jsx)("th",{scope:"col",children:(0,N.jsx)("div",{className:"flex items-center",children:C("Action")})})]})}),(0,N.jsx)("tbody",{children:null===D||void 0===D||null===(h=D.contractorData)||void 0===h||null===(y=h.diversionContractors)||void 0===y?void 0:y.map(((e,l)=>{var t;const i=(null===$||void 0===$?void 0:$.index)+l+1;return(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:"text-left",children:i}),(0,N.jsx)("td",{className:"text-left",children:null===e||void 0===e||null===(t=e.contractor_company)||void 0===t?void 0:t.name}),(0,N.jsx)("td",{className:"text-center",children:null===e||void 0===e?void 0:e.service_count}),(0,N.jsx)("td",{className:"text-left",children:(0,N.jsx)("div",{className:"btn-group",children:(0,N.jsx)("button",{type:"button",className:"btn bg-transparent cursor-pointer btn-default",onClick:()=>M(e),children:(0,N.jsx)(r.ff,{})})})})]},null===e||void 0===e?void 0:e.uuid)}))})]}),(0===(null===D||void 0===D||null===(b=D.contractorData)||void 0===b?void 0:b.count)||null===(null===D||void 0===D||null===(w=D.contractorData)||void 0===w?void 0:w.count))&&(0,N.jsx)("div",{className:"flex justify-center",children:(0,N.jsx)("div",{children:C("No Data")})})]}),(0,N.jsxs)("div",{className:"flex flex-wrap items-center mt-2",children:[(0,N.jsxs)("div",{className:"flex items-center mr-3 md:mr-7",children:[(0,N.jsx)("span",{className:"text-sm font-normal text-gray-700 whitespace-nowrap ",children:C("Per Page")}),(0,N.jsx)("select",{value:$.limit,className:"border border-border-primary rounded-xl ml-2 px-3 text-sm py-1.5 text-gray-500 w-[70px] h-[36px] appearance-none bg-white",onChange:e=>(e=>{L(Number(e));const l={...$,limit:parseInt(e),page:1,search:"",index:0};R({limit:parseInt(e),page:1,sortOrder:$.sortOrder,sortField:null===$||void 0===$?void 0:$.sortField,locationId:null===$||void 0===$?void 0:$.locationId}).then((e=>{var l,t;A((0,j.Jx)(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.getDiversionContractorsWithPagination)||void 0===t?void 0:t.data))})).catch((e=>{var l,t,i;return x.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(t=l.result)||void 0===t||null===(i=t.errors[0])||void 0===i?void 0:i.message)})),O(l),u.A.saveState("filterDiversionReport",JSON.stringify(l))})(e.target.value),children:null===s.aj||void 0===s.aj?void 0:s.aj.map((e=>(0,N.jsx)("option",{children:e},e)))})]}),(0,N.jsx)(c.A,{currentPage:$.page,totalPages:W,onPageChange:J,recordsPerPage:E})]})]})]})}}}]);
//# sourceMappingURL=5797.d2539bea.chunk.js.map