"use strict";(self.webpackChunkterraforma_systems=self.webpackChunkterraforma_systems||[]).push([[228],{7648:(e,l,t)=>{t.d(l,{A:()=>v});var n=t(65043),i=t(74117),a=t(73216),o=t(35475),s=t(42145),d=t(79456),r=t(66925),c=t(70579);const u=()=>{var e,l,t;const{t:u}=(0,i.Bd)(),v=(0,a.zy)(),m=new URLSearchParams(v.search).get("uuid"),{id:x}=(0,a.g)(),{userProfileData:p}=(0,d.d4)((e=>e.userProfile)),h=null!==(e=null===p||void 0===p||null===(l=p.getProfile)||void 0===l||null===(t=l.data)||void 0===t?void 0:t.user_type)&&void 0!==e?e:"",g=e=>{var l;let t="";if(null!==(l=e.split("/")[2])&&void 0!==l&&l.includes("-")){return e.split("/")[2].split("-").forEach((e=>{var l;return t=t+(null===(l=e[0])||void 0===l?void 0:l.toUpperCase())+e.slice(1)+" ",t})),t}var n;return t=(null===(n=e.split("/")[2][0])||void 0===n?void 0:n.toUpperCase())+e.split("/")[2].slice(1),t},b=e=>{let l="";if(null!==e&&void 0!==e&&e.includes("-")){l=null===e||void 0===e?void 0:e.replace(/-|\s/g," ");const t=l.split(" ");for(let e=0;e<t.length;e++)t[e]=t[e][0].toUpperCase()+t[e].substring(1);return l=t.join(" "),l}var t;return l=(null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))+" ",l},f=e=>{let l="";return null!==e&&void 0!==e&&e.includes("-")||(l=(null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))+" "),l;var t},j=v.pathname.split("/"),N=(0,n.useCallback)((()=>{if((null===j||void 0===j?void 0:j.length)>0){const e=null===j||void 0===j?void 0:j.length;if(e<4)return(0,c.jsx)("span",{className:"text-primary",children:j[2]&&"".concat(u(b(j[2])))});if(e<5)return""!==j[3]?j[3].length>32?(0,c.jsxs)(c.Fragment,{children:[f(j[3])&&(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(o.k2,{to:"/".concat(s.bw.app,"/").concat(j[2]),className:"text-light-grey hover:underline",children:"".concat(u(g(v.pathname)))})}),f(j[3])&&(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),!f(j[3])&&(0,c.jsx)("span",{className:"text-primary",children:j[2]&&"".concat(u(b(j[2])))}),(0,c.jsx)("span",{className:"text-primary",children:j[3]&&"".concat(u(f(j[3])))})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(o.k2,{to:"/".concat(s.bw.app,"/").concat(j[2]),className:"text-light-grey hover:underline",children:"".concat(u(g(v.pathname)))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:j[3]&&"".concat(u(b(j[3])))})]}):(0,c.jsx)("span",{className:"text-primary",children:j[2]&&"".concat(u(b(j[2])))});if(e<6)return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(o.k2,{to:"/".concat(s.bw.app,"/").concat(j[2]),className:"text-light-grey hover:underline",children:"".concat(u(g(v.pathname)))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:j[3]&&"".concat(u(b(j[3])))})]});if(e<7){let e="";return m?e="?uuid=".concat(m):x&&(e="?uuid=".concat(x)),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(o.k2,{to:"/".concat(s.bw.app,"/").concat(j[2]),className:"text-light-grey hover:underline",children:u(b(j[2]))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(o.k2,{to:"/".concat(s.bw.app,"/").concat(j[2],"/").concat(j[3],"/").concat((""!==m||""!==x)&&e),className:"text-light-grey hover:underline",children:u(b(j[3]))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:j[5]&&"".concat(u(b(j[4])))})]})}}}),[j]);return(0,c.jsx)("div",{className:"w-full",children:(0,c.jsxs)("p",{className:"max-xs:text-xs text-xs-14 max-md:truncate",children:[(0,c.jsxs)("span",{children:[(0,c.jsx)(o.k2,{to:(0,r.Go)(h,s.ve.SUPER_ADMIN,"/".concat(s.bw.app,"/").concat(s.bw.dashboard),"/".concat(s.bw.app,"/").concat(s.bw.subscriber)),className:"cursor-pointer text-light-grey hover:underline",children:u("Home")}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"})]}),N()]})})},v=n.memo(u)},75289:(e,l,t)=>{t.d(l,{A:()=>d});var n=t(65043),i=t(74117),a=t(41290),o=t(33556),s=t(70579);const d=e=>{let{onClose:l,action:t,show:d,warningText:r,disabled:c,isLoading:u}=e;const{t:v}=(0,i.Bd)(),[m,x]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{d&&setTimeout((()=>{x(!0)}),100)}),[d]),(0,s.jsxs)(s.Fragment,{children:[u&&(0,s.jsx)("div",{className:"w-12 h-12 mx-auto rounded-[50%] border-solid border-4 border-[#E8E8EA] border-r-[#2575d6] animate-spin absolute left-[58%] top-[40%]"}),(0,s.jsxs)("div",{className:"".concat(d?"":"hidden"," absolute top-0 left-0 right-0 z-[1000] h-full bg-modal"),children:["Are you sure want to delete this record ?"!==r&&"Are you sure want to change status ?"!==r&&(0,s.jsx)("div",{id:"changeUserStatusModel",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"py-5 flex items-center justify-center h-full ".concat(m?"":"opacity-0 transform -translate-y-full scale-150 ","  transition-all duration-300 "),children:(0,s.jsx)("div",{className:"w-full mx-5 sm:max-w-[780px]",children:(0,s.jsxs)("div",{className:"relative bg-white shadow rounded-xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-5 py-6 border-b bg-accents-2 rounded-t-xl",children:[(0,s.jsxs)("div",{className:"flex items-center ",children:[(0,s.jsx)(o.io,{className:"inline-block mr-3 fill-baseColor",fontSize:"20"}),(0,s.jsx)("span",{className:"text-xl font-bold text-baseColor",children:v("Confirmation")})]}),(0,s.jsx)(a.A,{onClick:l,label:"",children:(0,s.jsx)(o.YY,{className:"text-error",fontSize:"14"})})]}),(0,s.jsx)("div",{className:"p-5 space-y-6 font-normal text-center border-b border-solid border-border-primary",children:(0,s.jsx)("p",{children:v(r)})}),(0,s.jsxs)("div",{className:"flex flex-col items-center justify-end p-5 md:space-x-3 md:flex-row",children:[(0,s.jsx)(a.A,{className:"btn-primary btn-normal mb-2 md:mb-0 w-full md:w-auto min-w-[160px]",onClick:t,label:v("Yes"),disabled:c,title:"Yes"}),(0,s.jsx)(a.A,{className:"btn-secondary btn-normal w-full md:w-auto min-w-[160px]",onClick:l,label:v("No"),title:"No"})]})]})})}),"Are you sure want to change status ?"==r&&(0,s.jsx)("div",{id:"changeUserStatusModel",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"py-5 flex items-center justify-center h-full ".concat(m?"":"opacity-0 transform -translate-y-full scale-150 ","  transition-all duration-300 "),children:(0,s.jsx)("div",{className:"w-full mx-5 sm:max-w-[640px]",children:(0,s.jsxs)("div",{className:"relative p-5 text-center bg-white shadow rounded-xl md:p-7",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center mb-3",children:[(0,s.jsx)("span",{className:"p-[10px] bg-primary min-w-min rounded-full mb-3 overflow-hidden text-xl-44 md:text-6xl",children:(0,s.jsx)(o.ZI,{className:"fill-white bg-primary"})}),(0,s.jsx)("h4",{children:v("Confirmation")})]}),(0,s.jsx)("h6",{className:"font-semibold text-center mb-7 md:mb-10",children:v(r)}),(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-5 md:flex-row",children:[(0,s.jsx)(a.A,{className:"btn-primary btn-normal min-w-[86px]",onClick:t,label:v("Yes"),disabled:c,title:"Yes"}),(0,s.jsx)(a.A,{className:"btn-secondary btn-normal min-w-[86px]",onClick:l,label:v("No"),title:"No"})]})]})})}),"Are you sure want to delete this record ?"==r&&(0,s.jsx)("div",{id:"changeUserStatusModel",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"py-5 flex items-center justify-center h-full ".concat(m?"":"opacity-0 transform -translate-y-full scale-150 ","  transition-all duration-300 "),children:(0,s.jsx)("div",{className:"w-full mx-5 sm:max-w-[640px]",children:(0,s.jsxs)("div",{className:"relative p-5 text-center bg-white shadow rounded-xl md:p-7",children:[(0,s.jsx)("div",{className:"flex justify-center mb-5",children:(0,s.jsx)("span",{className:"p-[22px] md:p-[26px] rounded-full bg-error text-xl-35 md:text-5xl",children:(0,s.jsx)(o.Vl,{className:"stroke-2 fill-white"})})}),(0,s.jsx)("h6",{className:"font-bold text-center mb-7 md:mb-10",children:v(r)}),(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-5 md:flex-row",children:[(0,s.jsx)(a.A,{className:"btn-primary btn-normal min-w-[86px]",onClick:t,label:v("Yes"),disabled:c,title:"Yes"}),(0,s.jsx)(a.A,{className:"btn-secondary btn-normal min-w-[86px]",onClick:l,label:v("No"),title:"No"})]})]})})})]})]})}},62500:(e,l,t)=>{t.d(l,{A:()=>s});var n=t(65043),i=t(41290),a=t(33556),o=t(70579);const s=e=>{let{data:l,setObj:t,setIsDelete:s,className:d,customClick:r}=e;const c=(0,n.useCallback)((()=>{t(l),!r&&s(!0),r&&r(l)}),[]);return(0,o.jsx)(i.A,{className:"bg-transparent cursor-pointer btn-default btn-icon ".concat(d),onClick:c,label:"",title:"Delete",children:(0,o.jsx)(a.lM,{className:"fill-error"})})}},12209:(e,l,t)=>{t.d(l,{A:()=>u});var n=t(65043),i=t(74117),a=t(73216),o=t(7648),s=t(33556),d=t(79456),r=t(75214),c=t(70579);const u=e=>{let{headerActionConst:l,headerTitle:t}=e;const{t:u}=(0,i.Bd)(),v=(0,d.wA)(),{show:m}=(0,d.d4)((e=>e.coursesManagement)),x=(0,a.zy)(),p=(0,n.useCallback)((()=>{v((0,r.oM)(!m))}),[m]);return(0,c.jsxs)("header",{className:"sticky top-0 z-20 flex bg-white border-b shadow-header xl:shadow-none xl:h-auto xl:block border-border-primary xl:px-2 xl:pt-0",children:[(0,c.jsx)("div",{onClick:p,className:"pt-5 cursor-pointer text-xl-22 xl:hidden",children:(0,c.jsx)(s.Rt,{className:"ml-4"})}),(0,c.jsx)("div",{className:"p-2.5 xl:p-[18px] xl:shadow-header max-xl:w-[calc(100%-47px)]",children:(0,c.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2.5",children:[(0,c.jsxs)("div",{className:"w-full xl:w-auto",children:[(0,c.jsx)("h1",{className:"mb-1 text-2xl max-xl:truncate xl:text-3xl",children:u(null!==t&&void 0!==t?t:(e=>{let l="";if(e.split("/")[2].includes("-")){return e.split("/")[2].split("-").forEach((e=>(l=l+e[0].toUpperCase()+e.slice(1)+" ",l))),l}return l=e.split("/")[2][0].toUpperCase()+e.split("/")[2].slice(1),l})(x.pathname))}),(0,c.jsx)(o.A,{})]}),l&&(0,c.jsx)("div",{className:"flex gap-2.5 max-xl:w-[calc(100%+40px)] lg:gap-5",children:(()=>{if(l)return l()})()})]})})]})}},95295:(e,l,t)=>{t.d(l,{JU:()=>u,NR:()=>m,Wm:()=>c,nV:()=>v});var n,i,a,o,s,d=t(57528),r=t(70459);(0,r.J1)(n||(n=(0,d.A)(["mutation GetZoneBySiteId($siteId: String!) {\n    getZoneBySiteId(siteId: $siteId) {\n      message\n      data {\n        uuid\n        location\n        city\n        diversion_percentage\n        zoneCount\n      }\n    }\n  }"])));const c=(0,r.J1)(i||(i=(0,d.A)(["mutation CreateOrUpdateZone($zoneData: CreateZoneDto!) {\n  createOrUpdateZone(zoneData: $zoneData) {\n    message\n    data {\n      uuid\n      location\n      city\n      diversion_percentage\n      parent {\n        uuid\n        location\n        city\n        diversion_percentage\n        zoneCount\n      }\n    }\n  }\n}"]))),u=(0,r.J1)(a||(a=(0,d.A)(["mutation DeleteZone($siteId: String!, $zoneId: String!) {\n  deleteZone(siteId: $siteId, zoneId: $zoneId) {\n    message\n  }\n}"]))),v=(0,r.J1)(o||(o=(0,d.A)(["query GetActiveSites {\n  getActiveSites {\n    message\n    data {\n      uuid\n      location\n      city\n      diversion_percentage\n      zoneCount\n    }\n  }\n}"]))),m=(0,r.J1)(s||(s=(0,d.A)(["mutation GetZoneBySiteId($siteId: String!) {\n  getZoneBySiteId(siteId: $siteId) {\n    message\n    data {\n      uuid\n      location\n      city\n      diversion_percentage\n      zoneCount\n    }\n  }\n} "])))},80228:(e,l,t)=>{t.r(l),t.d(l,{ZONE_POP_UP_MESSAGES:()=>Z,ZoneManagementEnums:()=>z,default:()=>F});var n,i=t(88250),a=t(31881),o=t(77654),s=t(12209),d=t(42145),r=t(95295),c=t(65043),u=t(74117),v=t(35475),m=t(32254),x=t(41290),p=t(33556),h=t(63516),g=t(34764),b=t(66925),f=t(12352),j=t(79456),N=t(35954),w=t(64526),y=t(8848),C=t(62500),A=t(57528);const k=(0,t(70459).J1)(n||(n=(0,A.A)([" query GetZonesWithFilter($zoneData: GetZonesDto!) {\n    getZonesWithFilter(zoneData: $zoneData) {\n      message\n      data {\n        zones {\n          uuid\n          location\n          city\n          diversion_percentage\n          parent {\n            uuid\n            location\n            city\n            diversion_percentage\n            zoneCount\n          }\n        }\n        count\n      }\n    }\n  }"])));var I=t(75289),S=t(70579);let z=function(e){return e.Create="Create",e.Update="Update",e.Delete="Delete",e}({});const Z={Create:"Add new zone",Update:"Update zones",Delete:"Update zone before delete"},F=()=>{var e,l,t,n,A,F,O,P,U,D,_,E,R,M;const{t:$}=(0,u.Bd)(),[J]=(0,v.ok)(),B=(0,j.wA)(),L=(0,j.d4)((e=>e.zoneManagement)),[Y,W]=(0,c.useState)(),[G,V]=(0,c.useState)([]),T=(0,c.useRef)(""),[q,H]=(0,c.useState)(!1),K=[{name:$("Sr.No"),sortable:!1},{name:$("Zone Name"),sortable:!0,fieldName:$("location")},{name:$("Location"),sortable:!1,fieldName:$("location")}],[Q,X]=(0,c.useState)({limit:d.Wt,page:d.k2,sortField:"createdAt",sortOrder:"descend",parent_ids:"",search:"",index:0}),{refetch:ee}=(0,i.I)(r.nV,{fetchPolicy:"network-only",skip:!J.get("locationId")}),[le,{loading:te}]=(0,a.n)(r.NR,{fetchPolicy:"network-only"}),[ne,{loading:ie}]=(0,a.n)(r.Wm,{fetchPolicy:"network-only"}),[ae,{loading:oe}]=(0,a.n)(r.JU,{fetchPolicy:"network-only"}),{refetch:se}=(0,i.I)(k,{fetchPolicy:"network-only",skip:!0,variables:{zoneData:{sortOrder:Q.sortOrder,limit:Q.limit,page:Q.page,parent_ids:[Q.parent_ids],search:null!==(e=Q.search)&&void 0!==e?e:"",sortField:Q.sortField}}}),de=e=>{se({zoneData:{...e}}).then((e=>{var l,t,n,i,a,o;B((0,N.w2)(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.getZonesWithFilter)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.zones)),B((0,N.n7)(null===e||void 0===e||null===(i=e.data)||void 0===i||null===(a=i.getZonesWithFilter)||void 0===a||null===(o=a.data)||void 0===o?void 0:o.count))})).catch((e=>{var l,t,n;w.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(t=l.result)||void 0===t||null===(n=t.errors[0])||void 0===n?void 0:n.message)}))};(0,c.useEffect)((()=>{if(null!==J&&void 0!==J&&J.get("locationId")){const l=null===J||void 0===J?void 0:J.get("locationId");var e;if(l)B((0,N.CC)([l])),de({sortOrder:Q.sortOrder,limit:Q.limit,page:null===Q||void 0===Q?void 0:Q.page,parent_ids:[l],search:null!==(e=Q.search)&&void 0!==e?e:"",sortField:null===Q||void 0===Q?void 0:Q.sortField})}else ee().then((e=>{var l,t,n,i,a,o;const s=null===e||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.getActiveSites)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.map((e=>null===e||void 0===e?void 0:e.uuid));var d;(V(null===e||void 0===e||null===(i=e.data)||void 0===i||null===(a=i.getActiveSites)||void 0===a||null===(o=a.data)||void 0===o?void 0:o.map((e=>({name:null===e||void 0===e?void 0:e.location,key:null===e||void 0===e?void 0:e.uuid,uuid:null===e||void 0===e?void 0:e.uuid})))),s)&&(B((0,N.CC)(s)),de({sortOrder:Q.sortOrder,limit:Q.limit,page:null===Q||void 0===Q?void 0:Q.page,parent_ids:[...s],search:null!==(d=Q.search)&&void 0!==d?d:"",sortField:null===Q||void 0===Q?void 0:Q.sortField}))})).catch((e=>{var l,t,n;w.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(t=l.result)||void 0===t||null===(n=t.errors[0])||void 0===n?void 0:n.message)}))}),[]);const re={siteId:null!==(l=J.get("locationId"))&&void 0!==l?l:"",existingZones:[{uuid:"",name:""}]},{zoneManagementValidationSchema:ce}=(0,f.A)(),[ue,ve]=(0,c.useState)(Q.limit),me=(null===L||void 0===L?void 0:L.zonesPaginationCount)||0,xe=Math.ceil(me/ue),pe=(0,c.useCallback)((e=>{var l;de({sortOrder:Q.sortOrder,limit:Q.limit,page:e,parent_ids:L.activeLocationsDataArray,search:null!==(l=Q.search)&&void 0!==l?l:"",sortField:Q.sortField});const t={...Q,page:e,index:(e-1)*Q.limit};X(t),m.A.saveState("location",JSON.stringify(t))}),[Q.limit,L]);(0,c.useEffect)((()=>{L&&je.setFieldValue("existingZones",null===L||void 0===L?void 0:L.existingZones)}),[L]),(0,c.useEffect)((()=>{ve(Q.limit)}),[Q.limit]);const he=(0,c.useCallback)((()=>{ee().then((e=>{var l,t,n;V(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.getActiveSites)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.map((e=>({name:null===e||void 0===e?void 0:e.location,key:null===e||void 0===e?void 0:e.uuid,uuid:null===e||void 0===e?void 0:e.uuid}))))})).catch((e=>{var l,t,n;w.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(t=l.result)||void 0===t||null===(n=t.errors[0])||void 0===n?void 0:n.message)})),B((0,N.t$)(!0)),B((0,N.AN)(z.Create)),B((0,N.pe)(Z.Create));const e=J.get("locationId");e?Ce(z.Create,e):Ce(z.Create)}),[G]),ge=(0,c.useCallback)((e=>{ee().then((e=>{var l,t,n;V(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.getActiveSites)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.map((e=>({name:null===e||void 0===e?void 0:e.location,key:null===e||void 0===e?void 0:e.uuid,uuid:null===e||void 0===e?void 0:e.uuid}))))})).catch((e=>{var l,t,n;w.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(t=l.result)||void 0===t||null===(n=t.errors[0])||void 0===n?void 0:n.message)})),B((0,N.t$)(!0)),B((0,N.AN)(z.Update)),B((0,N.pe)(Z.Update)),je.setFieldValue("siteId",e),J.get("locationId")?Ce(z.Update):Ce(z.Update,e)}),[G]),be=(0,c.useCallback)((()=>{H(!0)}),[]),fe=(0,c.useCallback)((()=>{var e;Y&&ae({variables:{siteId:null===Y||void 0===Y||null===(e=Y.parent)||void 0===e?void 0:e.uuid,zoneId:null===Y||void 0===Y?void 0:Y.uuid}}).then((e=>{var l,t;w.oR.success(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.deleteZone)||void 0===t?void 0:t.message),de({sortOrder:Q.sortOrder,limit:null===Q||void 0===Q?void 0:Q.limit,page:null===Q||void 0===Q?void 0:Q.page,parent_ids:L.activeLocationsDataArray,search:null===Q||void 0===Q?void 0:Q.search,sortField:null===Q||void 0===Q?void 0:Q.sortField}),Se(),T.current=""})).catch((e=>{var l,t,n;w.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(t=l.result)||void 0===t||null===(n=t.errors[0])||void 0===n?void 0:n.message)}))}),[Y]),je=(0,h.Wx)({initialValues:re,validationSchema:ce,onSubmit:async e=>{ne({variables:{zoneData:{site_id:null===e||void 0===e?void 0:e.siteId,existingZones:e.existingZones}}}).then((e=>{if((null===L||void 0===L?void 0:L.popupContent)!==Z[z.Delete]){var l,t;if((null===L||void 0===L?void 0:L.buttonContent)===z.Create)w.oR.success("Zone is created successfully");else w.oR.success(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(t=l.createOrUpdateZone)||void 0===t?void 0:t.message);de({sortOrder:Q.sortOrder,limit:null===Q||void 0===Q?void 0:Q.limit,page:null===Q||void 0===Q?void 0:Q.page,parent_ids:L.activeLocationsDataArray,search:null===Q||void 0===Q?void 0:Q.search,sortField:null===Q||void 0===Q?void 0:Q.sortField})}T.current===z.Delete&&fe(),Se()})).catch((e=>{var l,t,n;w.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(t=l.result)||void 0===t||null===(n=t.errors[0])||void 0===n?void 0:n.message),Se()}))}}),Ne=(e,l)=>{e&&l===z.Create&&B((0,N.PJ)([...e,...re.existingZones])),e&&l!==z.Create&&B((0,N.PJ)([...e]))},we=e=>{e&&(null===L||void 0===L?void 0:L.buttonContent)===z.Create&&B((0,N.PJ)([...e,...re.existingZones])),e&&(null===L||void 0===L?void 0:L.buttonContent)!==z.Create&&B((0,N.PJ)([...e]))},ye=e=>{return e||(null!==(l=J.get("locationId"))&&void 0!==l?l:null===je||void 0===je||null===(t=je.values)||void 0===t?void 0:t.siteId);var l,t},Ce=(e,l,t)=>{ye(l)&&le({variables:{siteId:ye(l)}}).then((l=>{if(t){var n,i;((e,l,t)=>{const n=null===l||void 0===l?void 0:l.filter((l=>{if(e!==(null===l||void 0===l?void 0:l.uuid))return l})).map((e=>({uuid:null===e||void 0===e?void 0:e.uuid,name:null===e||void 0===e?void 0:e.location})));t?Ne(n,t):we(n)})(t,null===l||void 0===l||null===(n=l.data)||void 0===n||null===(i=n.getZoneBySiteId)||void 0===i?void 0:i.data,e)}else{var a,o,s;const t=null===l||void 0===l||null===(a=l.data)||void 0===a||null===(o=a.getZoneBySiteId)||void 0===o||null===(s=o.data)||void 0===s?void 0:s.map((e=>({uuid:null===e||void 0===e?void 0:e.uuid,name:null===e||void 0===e?void 0:e.location})));e?Ne(t,e):we(t)}})).catch((e=>{var l,t,n;w.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(t=l.result)||void 0===t||null===(n=t.errors[0])||void 0===n?void 0:n.message)}))};(0,c.useEffect)((()=>{null!==L&&void 0!==L&&L.openPopUp&&(null===L||void 0===L?void 0:L.buttonContent)===(null===z||void 0===z?void 0:z.Create)&&Ce()}),[null===je||void 0===je||null===(t=je.values)||void 0===t?void 0:t.siteId]);const Ae=(0,c.useCallback)((e=>{je.setFieldValue(e.target.name,(0,b.AW)(e))}),[]),ke=(e,l)=>{var t,n,i,a,o;return"string"!==typeof(null===je||void 0===je||null===(t=je.errors)||void 0===t?void 0:t.existingZones)?null===je||void 0===je||null===(n=je.errors)||void 0===n||null===(i=n.existingZones)||void 0===i||null===(a=i["".concat(e)])||void 0===a?void 0:a["".concat(l)]:"name"!==l&&(null===je||void 0===je||null===(o=je.errors)||void 0===o?void 0:o.existingZones)},Ie=(0,c.useCallback)((e=>{de({sortOrder:null===Q||void 0===Q?void 0:Q.sortOrder,limit:null===Q||void 0===Q?void 0:Q.limit,page:null===Q||void 0===Q?void 0:Q.page,parent_ids:L.activeLocationsDataArray,search:e.target.value,sortField:null===Q||void 0===Q?void 0:Q.sortField}),X({...Q,search:e.target.value})}),[L]),Se=(0,c.useCallback)((()=>{je.resetForm(),B((0,N.t$)(!1)),T.current="",H(!1)}),[]),ze=null===je||void 0===je||null===(n=je.touched)||void 0===n?void 0:n.existingZones;return(0,S.jsxs)(S.Fragment,{children:[" ",(0,S.jsx)(s.A,{headerActionConst:()=>(0,S.jsx)(x.A,{className:"btn-normal btn-secondary w-full md:w-[140px] whitespace-nowrap lg:h-[50px]",type:"button",onClick:he,label:$("+ Add New")})}),(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"p-3 mb-3 overflow-auto bg-white border border-solid md:p-5 rounded-xl border-border-primary",children:[(0,S.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-3 md:mb-5",children:[(0,S.jsx)("h6",{children:$("Zone Management List")}),(0,S.jsxs)("div",{className:"flex flex-wrap w-full gap-3 xmd:w-auto",children:[(0,S.jsx)("div",{className:"w-full xmd:w-[236px]",children:(0,S.jsx)(g.A,{type:"text",id:"zone-search",value:Q.search,placeholder:$("Search"),onChange:Ie,inputIcon:(0,S.jsx)(p.vj,{fontSize:"18",className:"font-normal"})})}),(0,S.jsxs)("div",{className:"flex flex-wrap items-center w-full gap-4 xmd:w-auto",children:[(0,S.jsx)("span",{className:"leading-5.5 w-full xmd:w-auto whitespace-nowrap",children:"Sort By"}),(0,S.jsx)("div",{className:"w-full xmd:w-[150px]",children:(0,S.jsx)(y.A,{className:"w-full -mt-2",label:"",name:"zoneSort",onChange:e=>{const l=e.target.value,[t,n]=l.split(":");X({...Q,sortField:t,sortOrder:n}),de({sortOrder:n,limit:null===Q||void 0===Q?void 0:Q.limit,page:null===Q||void 0===Q?void 0:Q.page,parent_ids:L.activeLocationsDataArray,search:null===Q||void 0===Q?void 0:Q.search,sortField:t})},value:Q.sortField+":"+Q.sortOrder,error:"",options:d.oG,id:"zoneSort"})})]})]})]}),(0,S.jsxs)("div",{className:"w-full mb-3 overflow-auto bg-white border sm:w-auto rounded-t-xl custom-dataTable border-border-primary",children:[(0,S.jsxs)("table",{children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{children:[null===K||void 0===K?void 0:K.map((e=>(0,S.jsx)("th",{scope:"col",className:"".concat("Sr.No"===e.name?"pl-7":"whitespace-nowrap"),children:(0,S.jsxs)("div",{className:"flex items-center",children:[e.name,e.sortable&&(0,S.jsxs)("button",{onClick:()=>(e=>{var l;X({...Q,sortField:e,sortOrder:"ascend"===Q.sortOrder?"descend":"ascend"}),de({sortOrder:"ascend"===Q.sortOrder?"descend":"ascend",limit:Q.limit,page:null===Q||void 0===Q?void 0:Q.page,parent_ids:L.activeLocationsDataArray,search:null!==(l=Q.search)&&void 0!==l?l:"",sortField:e})})(e.fieldName),children:[""===Q.sortOrder&&(0,S.jsx)(p.xs,{className:"text-white"}),"ascend"===Q.sortOrder&&(0,S.jsx)(p.xD,{className:"text-white"}),"descend"===Q.sortOrder&&(0,S.jsx)(p.xR,{className:"text-white"})]})]})},e.name))),(0,S.jsx)("th",{scope:"col",children:(0,S.jsx)("div",{children:$("Action")})})]})}),(0,S.jsx)("tbody",{children:null===L||void 0===L||null===(A=L.zones)||void 0===A?void 0:A.map(((e,l)=>{var t;const n=(null===Q||void 0===Q?void 0:Q.index)+l+1;return(0,S.jsxs)("tr",{children:[(0,S.jsx)("td",{scope:"row",className:"text-left pl-7",children:n}),(0,S.jsx)("td",{className:"text-left whitespace-nowrap",children:null===e||void 0===e?void 0:e.location}),(0,S.jsx)("td",{className:"text-left",children:null===e||void 0===e||null===(t=e.parent)||void 0===t?void 0:t.location}),(0,S.jsx)("td",{children:(0,S.jsxs)("div",{className:"flex gap-3 text-left md:gap-5 btn-group",children:[(0,S.jsx)(x.A,{className:"bg-transparent btn-default",onClick:()=>{var l;return ge(null===e||void 0===e||null===(l=e.parent)||void 0===l?void 0:l.uuid)},label:"",title:"Edit",children:(0,S.jsx)(p.ff,{})}),(0,S.jsx)(C.A,{data:e,setObj:W,customClick:be})]})})]},e.uuid)}))})]}),(0===(null===L||void 0===L?void 0:L.zonesPaginationCount)||null===(null===L||void 0===L?void 0:L.zonesPaginationCount))&&(0,S.jsx)("div",{className:"flex justify-center",children:(0,S.jsx)("div",{children:$("No Data")})})]})]}),(0,S.jsxs)("div",{className:"flex flex-wrap items-center gap-5 mt-2",children:[(0,S.jsx)("span",{className:"text-xs text-slate-400",children:"".concat(null===(null===L||void 0===L?void 0:L.zonesPaginationCount)||void 0===(null===L||void 0===L?void 0:L.zonesPaginationCount)?"0":null===L||void 0===L?void 0:L.zonesPaginationCount)+$(" Total Records")}),(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)("span",{className:"text-sm font-normal text-gray-700 whitespace-nowrap",children:$("Per Page")}),(0,S.jsx)("select",{className:"border border-border-primary rounded-xl ml-2 px-3 text-sm py-1.5 text-gray-500 w-[70px] h-[36px] appearance-none bg-white",onChange:e=>(e=>{ve(Number(e));const l={...Q,limit:parseInt(e),page:1,search:"",index:0};X(l),de({sortOrder:Q.sortOrder,limit:parseInt(e),page:1,parent_ids:L.activeLocationsDataArray,search:"",sortField:null===Q||void 0===Q?void 0:Q.sortField}),m.A.saveState("location",JSON.stringify(l))})(e.target.value),value:Q.limit,children:null===d.aj||void 0===d.aj?void 0:d.aj.map((e=>(0,S.jsx)("option",{children:e},e)))})]}),(0,S.jsx)(o.A,{currentPage:Q.page,totalPages:xe,onPageChange:pe,recordsPerPage:ue})]}),(null===L||void 0===L?void 0:L.openPopUp)&&(0,S.jsx)("div",{id:"defaultModal",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"fixed top-0 left-0 right-0 z-50 h-full bg-modal modal ".concat(null!==L&&void 0!==L&&L.openPopUp?"":"hidden"),children:(0,S.jsx)("div",{id:"changeUserStatusModel",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"flex items-center justify-center h-full py-5 transition-all duration-300",children:(0,S.jsx)("div",{className:"w-full mx-5 sm:max-w-[780px]",children:(0,S.jsxs)("div",{className:"relative bg-white rounded-xl",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b md:py-6 bg-accents-2 rounded-t-xl",children:[(0,S.jsx)("p",{className:"text-lg font-bold md:text-xl text-baseColor",children:L.popupContent}),(0,S.jsx)(x.A,{onClick:()=>Se(),label:$(""),title:"".concat($("Close")),children:(0,S.jsx)("span",{className:"text-xl-22",children:(0,S.jsx)(p.YY,{className:"text-error"})})})]}),(0,S.jsx)("div",{className:"w-full",children:(0,S.jsxs)("form",{onSubmit:je.handleSubmit,children:[(0,S.jsxs)("div",{className:"p-5 max-h-[calc(100vh-260px)] overflow-auto grid grid-cols-2 gap-4",children:[(0,S.jsx)("div",{className:"max-sm:mb-3 sm:w-[calc(50%-10px)] sm:inline-block col-span-2",children:(0,S.jsx)(y.A,{placeholder:$("Select location"),name:"siteId",onChange:je.handleChange,value:null===je||void 0===je||null===(F=je.values)||void 0===F?void 0:F.siteId,options:G,id:"site_id",label:$("Location"),required:!0,error:je.errors.siteId&&je.touched.siteId?je.errors.siteId:"",disabled:!!J.get("locationId")||(null===L||void 0===L?void 0:L.buttonContent)===(null===z||void 0===z?void 0:z.Update)})}),te&&(0,S.jsx)("div",{className:"relative  col-span-2 bg-black bg-opacity-70",children:(0,S.jsx)("div",{className:"w-12 h-12 mx-auto rounded-[50%] border-solid border-4 border-[#E8E8EA] border-r-[#2575d6] animate-spin absolute left-[50%] top-[40%] z-[9999]"})}),!(null===je||void 0===je||null===(O=je.values)||void 0===O||!O.siteId)&&(null===L||void 0===L||null===(P=L.existingZones)||void 0===P?void 0:P.map(((e,l)=>{var t,n,i;return(0,S.jsx)("div",{className:"col-span-1 flex gap-4",children:(0,S.jsx)("div",{className:"w-full",children:(0,S.jsx)(g.A,{id:null===e||void 0===e?void 0:e.uuid,name:"existingZones[".concat(l,"].name"),onBlur:Ae,placeholder:$("Zone"),onChange:je.handleChange,label:$("Zone - ".concat(l+1)),value:null===je||void 0===je||null===(t=je.values)||void 0===t||null===(n=t.existingZones["".concat(l)])||void 0===n?void 0:n.name,required:!0,error:ke(l,"name")&&null!==ze&&void 0!==ze&&null!==(i=ze["".concat(l)])&&void 0!==i&&i.name?ke(l,"name"):""})})},"zone-".concat(null===e||void 0===e?void 0:e.name,"-").concat(null===e||void 0===e?void 0:e.diversion_percentage))}))),!(null===je||void 0===je||null===(U=je.values)||void 0===U||!U.siteId)&&!(null!==L&&void 0!==L&&null!==(D=L.existingZones)&&void 0!==D&&D.length)&&(0,S.jsx)("div",{className:"flex justify-center col-span-2",children:(0,S.jsxs)("div",{className:"font-bold",children:[(0,S.jsx)("span",{className:"text-error",children:"Note:"}),"\xa0",$("No records found to update. You can directly delete zone.")]})})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center justify-end p-5 border-t border-solid md:space-x-3 md:flex-row border-border-primary",children:[(0,S.jsx)(x.A,{className:"btn-primary btn-normal w-full md:w-auto min-w-[160px]",type:"submit",label:$(null===L||void 0===L?void 0:L.buttonContent),disabled:ie||!(null===je||void 0===je||null===(_=je.values)||void 0===_||!_.siteId)&&!(null!==L&&void 0!==L&&null!==(E=L.existingZones)&&void 0!==E&&E.length),title:""}),!(null===je||void 0===je||null===(R=je.values)||void 0===R||!R.siteId)&&!(null!==L&&void 0!==L&&null!==(M=L.existingZones)&&void 0!==M&&M.length)&&(0,S.jsx)(x.A,{className:"btn-error text-white btn-normal w-full md:w-auto min-w-[160px]",onClick:fe,label:$(null===z||void 0===z?void 0:z.Delete),disabled:oe,title:""})]})]})})]})})})}),q&&(0,S.jsx)(I.A,{warningText:d.jl,onClose:()=>H(!1),action:fe,show:q})]})]})}}}]);
//# sourceMappingURL=228.5276d0d4.chunk.js.map