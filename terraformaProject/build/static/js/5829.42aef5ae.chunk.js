"use strict";(self.webpackChunkterraforma_systems=self.webpackChunkterraforma_systems||[]).push([[5829],{62500:(e,n,a)=>{a.d(n,{A:()=>o});var t=a(65043),s=a(41290),r=a(33556),l=a(70579);const o=e=>{let{data:n,setObj:a,setIsDelete:o,className:i,customClick:d}=e;const c=(0,t.useCallback)((()=>{a(n),!d&&o(!0),d&&d(n)}),[]);return(0,l.jsx)(s.A,{className:"bg-transparent cursor-pointer btn-default btn-icon ".concat(i),onClick:c,label:"",title:"Delete",children:(0,l.jsx)(r.lM,{className:"fill-error"})})}},99013:(e,n,a)=>{a.d(n,{FN:()=>i,Fr:()=>d,Km:()=>c});var t,s,r,l=a(57528),o=a(70459);const i=(0,o.J1)(t||(t=(0,l.A)(["\n  mutation DeleteSubscriberEmployeeUser($subscriberUserId: String!, $userData: DeleteUserDto) {\n    deleteSubscriberEmployeeUser(subscriberUserId: $subscriberUserId, userData: $userData) {\n      message\n    }\n  }\n"]))),d=(0,o.J1)(s||(s=(0,l.A)(["\nmutation DeleteTenantCompany($tenantBranchId: String!, $tenantCompanyId: String!) {\n  deleteTenantCompany(tenantBranchId: $tenantBranchId, tenantCompanyId: $tenantCompanyId) {\n    message\n  }\n}\n"]))),c=(0,o.J1)(r||(r=(0,l.A)(["\nmutation DeleteContractorCompany($contractorBranchId: String!, $contractorCompanyId: String!) {\n  deleteContractorCompany(contractorBranchId: $contractorBranchId, contractorCompanyId: $contractorCompanyId) {\n    message\n  }\n}"])))},5181:(e,n,a)=>{a.d(n,{J9:()=>i,nX:()=>d});var t,s,r,l=a(57528),o=a(70459);const i=(0,o.J1)(t||(t=(0,l.A)(["\nquery GetSubscriberEmployeesUserListWithPagination($sortOrder: String!, $sortField: String!, $limit: Float!, $page: Float!, $search: String!) {\n    getSubscriberEmployeesUserListWithPagination(sortOrder: $sortOrder, sortField: $sortField, limit: $limit, page: $page, search: $search) {\n      message\n      data {\n        employee {\n          email\n          uuid\n          status\n          first_name\n          last_name\n          user_type\n          phone_number\n          country_code {\n            id\n            uuid\n            name\n            countryCode\n            phoneCode\n          }\n          department\n          company_id {\n            uuid\n            name\n            description\n            type\n            attachments\n            website_url            \n            industryType {\n              uuid\n              name\n              description\n            }\n          }\n          user_roles {\n            uuid\n            role_id {\n              uuid\n              name\n              description\n              status\n            }\n          }\n          user_branches {\n            uuid\n            branch {\n              location\n              city\n              uuid\n            }\n          }\n        }\n        count\n      }\n    }\n  }"]))),d=((0,o.J1)(s||(s=(0,l.A)(["\nquery GetSubscriberEmployeeById($subscriberUserId: String!, $userType: Float) {\n  getSubscriberEmployeeById(subscriberUserId: $subscriberUserId, userType: $userType) {\n    message\n    data {\n      uuid\n      email\n      pronounce\n      first_name\n      last_name\n      phone_number\n      country_code {\n        id\n        uuid\n        name\n        countryCode\n        phoneCode\n      }\n      preferred_language\n      location\n      department\n      user_roles {\n        uuid\n        role_id {\n          uuid\n          name\n          description\n          status\n        }\n      }\n      reporting_manager_id {\n        id\n        email\n        uuid\n        status\n        pronounce\n        position\n        first_name\n        last_name\n        phone_number\n        country_code\n        profile_picture\n        preferred_language\n        educational_interests\n        organization\n        location\n        department\n        reporting_manager_id\n        user_type\n        company_id\n        branch_id\n        subscriber_id {\n          uuid\n          first_name\n          last_name \n          company_name\n          address\n          phone_number\n          logo\n          subscribe_start\n          subscribe_end\n          email\n          status\n        }\n      }\n    }\n  }\n}\n"]))),(0,o.J1)(r||(r=(0,l.A)(["\nquery GetTenantsContractorsCompaniesWithPagination($userData: GetCompanyTypeDto!) {\n  getTenantsContractorsCompaniesWithPagination(userData: $userData) {\n    message\n    data {\n      data {\n        status\n        company {\n          uuid\n          name\n          description\n          type\n          attachments\n          website_url          \n          industryType {\n            uuid\n            name\n            description\n          }\n          tenantContractorType {\n            uuid\n            name\n            description\n            type\n          }\n        }\n        branch {\n          uuid\n          location\n          status\n        }        \n        user_count\n      }\n      count\n    }\n  }\n}\n\n"]))))},85829:(e,n,a)=>{a.r(n),a.d(n,{default:()=>$});var t=a(65043),s=a(74117),r=a(73216),l=a(92073),o=a(64526),i=a(34764),d=a(77654),c=a(41290),u=a(32254),m=a(62500),p=a(75289),b=a(42145),h=a(33556),x=a(31881),v=a(88250),f=a(12209),g=a(5181),y=a(99013),j=a(86213),N=a(77578),w=a(75214),C=a(79456),_=a(8848),I=a(5937),S=a(81410),k=a(43114),A=a(41709),U=a(13960),E=a(70579);const $=()=>{var e,n,a,$,D,P,T,R,L,O,F;const{t:B}=(0,s.Bd)(),J=(0,r.Zp)(),[W]=(0,x.n)(y.FN),[q,z]=(0,t.useState)(!1),[M,G]=(0,t.useState)({}),[V,K]=(0,t.useState)(!1),Y=localStorage.getItem("authToken"),X=Y&&(0,N.A)(Y),Z=(0,t.useRef)(null),[H,Q]=(0,t.useState)(!1),ee=(0,C.wA)(),[ne,ae]=(0,t.useState)({successCount:0,rejectCount:0,totalCount:0,rejectedUsers:[]}),[te,se]=(0,t.useState)({limit:b.Wt,page:b.k2,sortOrder:"descend",search:"",sortField:"createdAt",index:0}),[re,le]=(0,t.useState)(""),[oe,ie]=(0,t.useState)(te.limit),{employee:de}=(0,C.d4)((e=>e.rolesManagement)),{userProfileData:ce}=(0,C.d4)((e=>e.userProfile)),[ue,me]=(0,t.useState)([]),[pe,be]=(0,t.useState)(!1),[he,xe]=(0,t.useState)({}),[ve,fe]=(0,x.n)(k.tq),ge=[{name:B("Sr.No"),sortable:!1},{name:B("First Name"),sortable:!0,fieldName:"first_name"},{name:B("Last Name"),sortable:!0,fieldName:"last_name"},{name:B("Email"),sortable:!0,fieldName:"email"},{name:B("Phone Number"),sortable:!0,fieldName:"phone_number"},{name:B("Department"),sortable:!0,fieldName:"department"},{name:B("Status"),sortable:!0,fieldName:"status"},{name:B("Role"),sortable:!0,fieldName:"user_roles.role_id.name"}],{data:ye}=(0,v.I)(I.B,{variables:{companyId:""}}),{data:je,refetch:Ne}=(0,v.I)(g.J9,{variables:{sortOrder:te.sortOrder,limit:te.limit,page:te.page,search:te.search,sortField:te.sortField}}),we=(0,t.useCallback)((()=>{z(!1)}),[]);function Ce(){ee((0,w.KC)()),J("/".concat(b.bw.app,"/").concat(b.bw.createNewAccount,"/?employees-user-list=true"))}(0,t.useEffect)((()=>{if(null!==ye&&void 0!==ye&&ye.subscriberLocations){var e,n;const a=[];null===ye||void 0===ye||null===(e=ye.subscriberLocations)||void 0===e||null===(n=e.data)||void 0===n||n.map((e=>{a.push({name:e.location,key:null===e||void 0===e?void 0:e.uuid})})),me(a)}}),[ye]);const _e=(null===je||void 0===je||null===(e=je.getSubscriberEmployeesUserListWithPagination)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.count)||0,Ie=Math.ceil(_e/oe),Se=(0,t.useCallback)((e=>{const n={...te,page:e,index:(e-1)*te.limit};se(n),u.A.saveState("filterEmployeeUser",JSON.stringify(n))}),[te.limit]);(0,t.useEffect)((()=>{ie(te.limit)}),[te.limit]);const ke=(0,t.useCallback)((()=>{W({variables:{subscriberUserId:M.uuid,userData:{user_type:3}}}).then((e=>{const n=e.data;o.oR.success(n.deleteSubscriberEmployeeUser.message),z(!1),Ne(te).catch((e=>o.oR.error(e)))})).catch((e=>{var n,a;o.oR.error(null===e||void 0===e||null===(n=e.networkError)||void 0===n||null===(a=n.result)||void 0===a?void 0:a.errors[0].message)}))}),[M.uuid]),Ae=(0,t.useCallback)((e=>{se({...te,search:e.target.value})}),[]),Ue=null===ce||void 0===ce||null===(a=ce.getProfile)||void 0===a||null===($=a.data)||void 0===$||null===(D=$.subscriber_id)||void 0===D?void 0:D.uuid;(0,t.useEffect)((()=>{Ne(te).catch((e=>o.oR.error(e)))}),[te]);const Ee=(0,t.useCallback)(((e,n,a)=>{J("/".concat(b.bw.app,"/").concat(b.bw.userDetails,"/?uuid=").concat(e,"&branchId=").concat(n,"&userTypeId=true&userTypeValue=").concat(a))}),[]),$e=(0,t.useCallback)(((e,n)=>{J("/".concat(b.bw.app,"/").concat(b.bw.userDetails,"/?uuid=").concat(e,"&branchId=").concat(n,"&read_Data=true&userTypeId=true"))}),[]),[De,Pe]=(0,t.useState)(!1),Te=()=>{Q(!1),Pe(!1)},Re=(0,t.useCallback)((()=>{j.A.get("".concat(b.JR,"users/export-employee-user-csv/"),{headers:{authorization:X?"Bearer ".concat(X):""},responseType:"blob"}).then((e=>{var n;const a=window.URL.createObjectURL(new Blob([e.data])),t=document.createElement("a");t.href=a,t.setAttribute("download","Employee-Users.csv"),document.body.appendChild(t),t.click(),o.oR.success(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)})).catch((e=>{o.oR.error(e.message)}))}),[]),Le=(0,t.useCallback)((async e=>{Pe(!1);const n=e.currentTarget.files;await(0,U.gv)({files:n,companyId:"",branchId:re,onImportCallBack:()=>{Ne(te).catch((e=>o.oR.error(e)))},setRejectedUserPopup:Q,setRejectedUsersData:ae,employeeType:"3"}),Z.current&&(Z.current.value="")}),[re]),Oe=(0,t.useCallback)((()=>{j.A.get("".concat(b.JR,"media/download-csv/employee"),{headers:{authorization:"Bearer ".concat(X)},responseType:"blob"}).then((e=>{var n;const a=window.URL.createObjectURL(new Blob([e.data])),t=document.createElement("a");t.href=a,t.setAttribute("download","Employee-Sample.csv"),document.body.appendChild(t),t.click(),o.oR.success(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)})).catch((e=>{o.oR.error(e.message)}))}),[]),Fe=(0,t.useCallback)((e=>{be(!0),xe(e)}),[]),Be=(0,t.useCallback)((()=>{ve({variables:{subscriberUserId:he.uuid}}).then((e=>{const n=e.data;o.oR.success(n.activeInactiveEmployee.message),be(!1),Ne()})).catch((e=>{var n,a,t;o.oR.error(null===e||void 0===e||null===(n=e.networkError)||void 0===n||null===(a=n.result)||void 0===a||null===(t=a.errors[0])||void 0===t?void 0:t.message)}))}),[pe]),Je=(0,t.useCallback)((()=>{be(!1)}),[]);return(0,E.jsxs)(E.Fragment,{children:[V&&(0,E.jsx)(S.A,{}),(0,E.jsx)(f.A,{headerActionConst:()=>(0,E.jsx)(E.Fragment,{children:Ue&&(null===de||void 0===de?void 0:de.write)&&(0,E.jsx)(c.A,{className:"ml-5 btn-normal md: btn btn-secondary",onClick:Ce,type:"button",label:B("Create New Employee")})})}),(0,E.jsxs)("div",{className:"p-3 mb-3 bg-white border rounded-xl border-border-primary mx-7 md:p-5",children:[(0,E.jsxs)("div",{className:"flex flex-col flex-wrap justify-between gap-3 mb-5 md:gap-5 md:flex-row",children:[(0,E.jsx)("h6",{className:"w-full leading-7 xmd:w-auto",children:B("Employee User")}),(0,E.jsxs)("div",{className:"flex flex-wrap gap-y-3 gap-x-4",children:[(0,E.jsxs)("button",{className:"w-full btn btn-gray md:w-[260px] p-3.5",onClick:()=>{Pe(!0)},title:"".concat(B("Import")),children:["Import Employees List ",(0,E.jsx)(h.OP,{className:"order-2 ml-auto "})]}),(0,E.jsxs)("button",{className:"w-full btn btn-gray md:w-[260px] p-3.5",onClick:()=>Re(),title:"".concat(B("Export")),children:["Export Employees List  ",(0,E.jsx)(h.OP,{className:"order-2 ml-auto "})]}),(0,E.jsx)("button",{className:"btn bg-default btn-secondary btn-normal w-full md:w-[220px] ",type:"button",onClick:()=>Oe(),title:"".concat(B("Download")),children:"Download Sample CSV"}),(0,E.jsx)(i.A,{type:"text",id:"table-search",value:te.search,className:"w-full md:w-[230px]",placeholder:B("Search"),onChange:Ae,inputIcon:(0,E.jsx)(h.vj,{fontSize:"18",className:"font-normal"})})]})]}),(0,E.jsxs)("div",{className:"w-full mb-3 overflow-auto bg-white border sm:w-auto rounded-t-xl custom-dataTable border-border-primary",children:[(0,E.jsxs)("table",{children:[(0,E.jsx)("thead",{children:(0,E.jsxs)("tr",{children:[null===ge||void 0===ge?void 0:ge.map(((e,n)=>(0,E.jsx)("th",{scope:"col",className:"".concat("Sr.No"==e.name?"pl-7":""),children:(0,E.jsxs)("div",{className:"flex items-center",children:[e.name,e.sortable&&(0,E.jsxs)("button",{onClick:()=>{return n=e.fieldName,void se({...te,sortField:n,sortOrder:"ascend"===te.sortOrder?"descend":"ascend"});var n},children:[(""===te.sortOrder||te.sortField!==e.fieldName)&&(0,E.jsx)(h.xs,{className:"w-3 h-3 ml-1 fill-white"}),"ascend"===te.sortOrder&&te.sortField===e.fieldName&&(0,E.jsx)(h.xD,{className:"ml-1 fill-white"}),"descend"===te.sortOrder&&te.sortField===e.fieldName&&(0,E.jsx)(h.xR,{className:"ml-1 fill-white"})]})]})},"sub-".concat(n+1)))),(0,E.jsx)("th",{scope:"col",children:(0,E.jsx)("div",{className:"flex items-center",children:B("Action")})})]})},"sorting"),(0,E.jsx)("tbody",{children:null===je||void 0===je||null===(P=je.getSubscriberEmployeesUserListWithPagination)||void 0===P||null===(T=P.data)||void 0===T||null===(R=T.employee)||void 0===R?void 0:R.map(((e,n)=>{var a,t;const s=(null===te||void 0===te?void 0:te.index)+n+1,r=null===e||void 0===e||null===(a=e.user_branches)||void 0===a?void 0:a.map((e=>{var n;return null===e||void 0===e||null===(n=e.branch)||void 0===n?void 0:n.uuid}));return(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{scope:"row",className:"text-left pl-7",children:s}),(0,E.jsx)("td",{className:"text-left",children:e.first_name}),(0,E.jsx)("td",{className:"text-left",children:e.last_name}),(0,E.jsx)("td",{className:"text-left",children:e.email}),(0,E.jsx)("td",{className:"text-left",children:e.phone_number}),(0,E.jsx)("td",{className:"text-left",children:e.department}),(0,E.jsx)("td",{className:"text-left border-none",children:(0,E.jsx)("div",{className:"flex",children:(null===e||void 0===e?void 0:e.status)===b.UP.ACTIVE?(0,E.jsx)("span",{className:"text-bright-green-shade",children:"Active"}):(0,E.jsx)("span",{className:"text-error",children:"Inactive"})})}),null===e||void 0===e||null===(t=e.user_roles)||void 0===t?void 0:t.map((e=>{var n,a;return(0,E.jsx)("td",{className:"text-left",children:null===e||void 0===e||null===(a=e.role_id)||void 0===a?void 0:a.name},null===e||void 0===e||null===(n=e.role_id)||void 0===n?void 0:n.uuid)})),(0,E.jsx)("td",{children:(0,E.jsxs)("div",{className:"flex gap-2.5",children:[Ue&&(null===de||void 0===de?void 0:de.read)&&(0,E.jsxs)(c.A,{onClick:()=>$e(e.uuid,r),label:"",children:[(0,E.jsx)(h.kU,{className:"bg-transparent text-success"})," "]}),Ue&&(null===de||void 0===de?void 0:de.update)&&(0,E.jsx)(c.A,{className:"bg-transparent btn-default",onClick:()=>Ee(null===e||void 0===e?void 0:e.uuid,r,null===e||void 0===e?void 0:e.user_type),label:"",children:(0,E.jsx)(h.ff,{})}),Ue&&(null===de||void 0===de?void 0:de.delete)&&(0,E.jsx)(m.A,{data:e,setObj:G,setIsDelete:z}),(0,E.jsx)("div",{className:"flex justify-center",children:Ue&&(null===de||void 0===de?void 0:de.update)&&(0,E.jsx)("span",{className:"font-medium text-blue-600 hover:underline",children:(0,E.jsxs)("label",{className:"relative inline-flex items-center mb-0 cursor-pointer",children:[(0,E.jsx)("input",{type:"checkbox",className:"sr-only peer",value:null===e||void 0===e?void 0:e.status,onChange:()=>Fe(e),checked:(null===e||void 0===e?void 0:e.status)===b.UP.ACTIVE}),(0,E.jsx)("div",{className:"w-[30px] h-[14px] bg-secondary rounded-full peer peer-focus:ring-3 peer-focus:ring-red-200 peer-checked:after:translate-x-full peer-checked:after:border-white after:content- after:absolute after:top-[-1px] after:left-0 after:bg-white after:drop-shadow-outline-2 after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-primary"})]})})})]})})]},null===e||void 0===e?void 0:e.uuid)}))})]}),(0===(null===je||void 0===je||null===(L=je.getSubscriberEmployeesUserListWithPagination)||void 0===L||null===(O=L.data)||void 0===O?void 0:O.count)||null===(null===je||void 0===je||null===(F=je.getSubscriberEmployeesUserListWithPagination)||void 0===F?void 0:F.data))&&(0,E.jsx)("div",{className:"flex justify-center",children:(0,E.jsx)("div",{children:B("No Data")})})]}),(0,E.jsxs)("div",{className:"flex flex-wrap items-center mt-2 overflow-auto gap-x-5 md:gap-x-7",children:[(0,E.jsxs)("div",{className:"flex items-center",children:[(0,E.jsx)("span",{className:"text-sm font-normal text-gray-700 ",children:B("Per Page")}),(0,E.jsx)("select",{className:"border border-border-primary rounded-xl ml-2 px-3 text-sm py-1.5 text-gray-500 w-[70px] h-[36px] appearance-none bg-white",value:te.limit,onChange:e=>(e=>{ie(Number(e));const n={...te,limit:parseInt(e),page:b.k2,index:0};se(n),u.A.saveState("filterEmployeeUser",JSON.stringify(n))})(e.target.value),children:null===b.aj||void 0===b.aj?void 0:b.aj.map(((e,n)=>(0,E.jsx)("option",{children:e},"".concat(n+1))))})]}),(0,E.jsx)(d.A,{currentPage:te.page,totalPages:Ie,onPageChange:Se,recordsPerPage:oe})]}),q&&(0,E.jsx)(p.A,{warningText:b.jl,onClose:we,action:ke,show:q})]}),(0,E.jsx)(A.A,{rejectedUserPopup:H,rejectedUsersData:ne,oncancel:Te}),De&&(0,E.jsx)("div",{id:"defaultModal",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"fixed top-0 left-0 right-0 z-50 h-full bg-modal modal ".concat(De?"":"hidden"),children:(0,E.jsx)("div",{id:"changeUserStatusModel",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"py-5 flex items-center justify-center h-full ".concat(De?"":"opacity-0 transform -translate-y-full scale-150 "," transition-all duration-300 "),children:(0,E.jsx)("div",{className:"w-full mx-5 sm:max-w-[400px]",children:(0,E.jsxs)("div",{className:"relative bg-white rounded-xl",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b md:py-6 bg-accents-2 rounded-t-xl",children:[(0,E.jsx)("p",{className:"text-lg font-bold md:text-xl text-baseColor",children:"Import Employees List"}),(0,E.jsx)(c.A,{onClick:()=>Te(),label:"",title:"".concat(B("Close")),children:(0,E.jsx)("span",{className:"text-xl-22",children:(0,E.jsx)(h.YY,{className:"text-error"})})})]}),(0,E.jsxs)("div",{className:"w-full p-5",children:[(0,E.jsxs)("p",{className:"mb-4",children:[(0,E.jsx)("b",{className:"text-error",children:"Note : "}),"Before you upload the list, the roles should be created"]}),(0,E.jsx)("div",{className:"w-full mb-5",children:(0,E.jsx)(_.A,{placeholder:B("Select Location"),className:"w-full",label:B("Location"),inputIcon:(0,E.jsx)("span",{className:"text-xs",children:(0,E.jsx)(h.jN,{className:"fill-dark-grey"})}),onChange:e=>{le(e.target.value)},value:re,options:ue,name:"branchId",id:"branchId",required:!0})}),(0,E.jsxs)("label",{id:"importCsv",className:"w-full mb-0 btn btn-gray p-3.5",children:["Import Employees List  ",(0,E.jsx)(h.OP,{className:"order-2 ml-auto "})," ","",(0,E.jsx)("input",{id:"importCsv",type:"file",name:"importCsv",multiple:!0,ref:Z,className:"hidden focus:bg-transparent",accept:".csv",onChange:e=>Le(e),disabled:!re},(0,l.A)())]})]})]})})})}),pe&&(0,E.jsx)(p.A,{warningText:b.lN,onClose:Je,action:Be,show:pe,disabled:null===fe||void 0===fe?void 0:fe.loading,isLoading:null===fe||void 0===fe?void 0:fe.loading})]})}}}]);
//# sourceMappingURL=5829.42aef5ae.chunk.js.map