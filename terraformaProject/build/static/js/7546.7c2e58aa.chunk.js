"use strict";(self.webpackChunkterraforma_systems=self.webpackChunkterraforma_systems||[]).push([[7546],{7648:(e,l,s)=>{s.d(l,{A:()=>m});var a=s(65043),t=s(74117),n=s(73216),r=s(35475),i=s(42145),d=s(79456),o=s(66925),c=s(70579);const u=()=>{var e,l,s;const{t:u}=(0,t.Bd)(),m=(0,n.zy)(),x=new URLSearchParams(m.search).get("uuid"),{id:p}=(0,n.g)(),{userProfileData:h}=(0,d.d4)((e=>e.userProfile)),v=null!==(e=null===h||void 0===h||null===(l=h.getProfile)||void 0===l||null===(s=l.data)||void 0===s?void 0:s.user_type)&&void 0!==e?e:"",b=e=>{var l;let s="";if(null!==(l=e.split("/")[2])&&void 0!==l&&l.includes("-")){return e.split("/")[2].split("-").forEach((e=>{var l;return s=s+(null===(l=e[0])||void 0===l?void 0:l.toUpperCase())+e.slice(1)+" ",s})),s}var a;return s=(null===(a=e.split("/")[2][0])||void 0===a?void 0:a.toUpperCase())+e.split("/")[2].slice(1),s},f=e=>{let l="";if(null!==e&&void 0!==e&&e.includes("-")){l=null===e||void 0===e?void 0:e.replace(/-|\s/g," ");const s=l.split(" ");for(let e=0;e<s.length;e++)s[e]=s[e][0].toUpperCase()+s[e].substring(1);return l=s.join(" "),l}var s;return l=(null===e||void 0===e||null===(s=e[0])||void 0===s?void 0:s.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))+" ",l},j=e=>{let l="";return null!==e&&void 0!==e&&e.includes("-")||(l=(null===e||void 0===e||null===(s=e[0])||void 0===s?void 0:s.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))+" "),l;var s},g=m.pathname.split("/"),w=(0,a.useCallback)((()=>{if((null===g||void 0===g?void 0:g.length)>0){const e=null===g||void 0===g?void 0:g.length;if(e<4)return(0,c.jsx)("span",{className:"text-primary",children:g[2]&&"".concat(u(f(g[2])))});if(e<5)return""!==g[3]?g[3].length>32?(0,c.jsxs)(c.Fragment,{children:[j(g[3])&&(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(r.k2,{to:"/".concat(i.bw.app,"/").concat(g[2]),className:"text-light-grey hover:underline",children:"".concat(u(b(m.pathname)))})}),j(g[3])&&(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),!j(g[3])&&(0,c.jsx)("span",{className:"text-primary",children:g[2]&&"".concat(u(f(g[2])))}),(0,c.jsx)("span",{className:"text-primary",children:g[3]&&"".concat(u(j(g[3])))})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(r.k2,{to:"/".concat(i.bw.app,"/").concat(g[2]),className:"text-light-grey hover:underline",children:"".concat(u(b(m.pathname)))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:g[3]&&"".concat(u(f(g[3])))})]}):(0,c.jsx)("span",{className:"text-primary",children:g[2]&&"".concat(u(f(g[2])))});if(e<6)return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(r.k2,{to:"/".concat(i.bw.app,"/").concat(g[2]),className:"text-light-grey hover:underline",children:"".concat(u(b(m.pathname)))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:g[3]&&"".concat(u(f(g[3])))})]});if(e<7){let e="";return x?e="?uuid=".concat(x):p&&(e="?uuid=".concat(p)),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(r.k2,{to:"/".concat(i.bw.app,"/").concat(g[2]),className:"text-light-grey hover:underline",children:u(f(g[2]))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:(0,c.jsx)(r.k2,{to:"/".concat(i.bw.app,"/").concat(g[2],"/").concat(g[3],"/").concat((""!==x||""!==p)&&e),className:"text-light-grey hover:underline",children:u(f(g[3]))})}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,c.jsx)("span",{className:"text-primary",children:g[5]&&"".concat(u(f(g[4])))})]})}}}),[g]);return(0,c.jsx)("div",{className:"w-full",children:(0,c.jsxs)("p",{className:"max-xs:text-xs text-xs-14 max-md:truncate",children:[(0,c.jsxs)("span",{children:[(0,c.jsx)(r.k2,{to:(0,o.Go)(v,i.ve.SUPER_ADMIN,"/".concat(i.bw.app,"/").concat(i.bw.dashboard),"/".concat(i.bw.app,"/").concat(i.bw.subscriber)),className:"cursor-pointer text-light-grey hover:underline",children:u("Home")}),(0,c.jsx)("span",{className:"mx-2 text-light-grey",children:">"})]}),w()]})})},m=a.memo(u)},75289:(e,l,s)=>{s.d(l,{A:()=>d});var a=s(65043),t=s(74117),n=s(41290),r=s(33556),i=s(70579);const d=e=>{let{onClose:l,action:s,show:d,warningText:o,disabled:c,isLoading:u}=e;const{t:m}=(0,t.Bd)(),[x,p]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{d&&setTimeout((()=>{p(!0)}),100)}),[d]),(0,i.jsxs)(i.Fragment,{children:[u&&(0,i.jsx)("div",{className:"w-12 h-12 mx-auto rounded-[50%] border-solid border-4 border-[#E8E8EA] border-r-[#2575d6] animate-spin absolute left-[58%] top-[40%]"}),(0,i.jsxs)("div",{className:"".concat(d?"":"hidden"," absolute top-0 left-0 right-0 z-[1000] h-full bg-modal"),children:["Are you sure want to delete this record ?"!==o&&"Are you sure want to change status ?"!==o&&(0,i.jsx)("div",{id:"changeUserStatusModel",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"py-5 flex items-center justify-center h-full ".concat(x?"":"opacity-0 transform -translate-y-full scale-150 ","  transition-all duration-300 "),children:(0,i.jsx)("div",{className:"w-full mx-5 sm:max-w-[780px]",children:(0,i.jsxs)("div",{className:"relative bg-white shadow rounded-xl",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between px-5 py-6 border-b bg-accents-2 rounded-t-xl",children:[(0,i.jsxs)("div",{className:"flex items-center ",children:[(0,i.jsx)(r.io,{className:"inline-block mr-3 fill-baseColor",fontSize:"20"}),(0,i.jsx)("span",{className:"text-xl font-bold text-baseColor",children:m("Confirmation")})]}),(0,i.jsx)(n.A,{onClick:l,label:"",children:(0,i.jsx)(r.YY,{className:"text-error",fontSize:"14"})})]}),(0,i.jsx)("div",{className:"p-5 space-y-6 font-normal text-center border-b border-solid border-border-primary",children:(0,i.jsx)("p",{children:m(o)})}),(0,i.jsxs)("div",{className:"flex flex-col items-center justify-end p-5 md:space-x-3 md:flex-row",children:[(0,i.jsx)(n.A,{className:"btn-primary btn-normal mb-2 md:mb-0 w-full md:w-auto min-w-[160px]",onClick:s,label:m("Yes"),disabled:c,title:"Yes"}),(0,i.jsx)(n.A,{className:"btn-secondary btn-normal w-full md:w-auto min-w-[160px]",onClick:l,label:m("No"),title:"No"})]})]})})}),"Are you sure want to change status ?"==o&&(0,i.jsx)("div",{id:"changeUserStatusModel",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"py-5 flex items-center justify-center h-full ".concat(x?"":"opacity-0 transform -translate-y-full scale-150 ","  transition-all duration-300 "),children:(0,i.jsx)("div",{className:"w-full mx-5 sm:max-w-[640px]",children:(0,i.jsxs)("div",{className:"relative p-5 text-center bg-white shadow rounded-xl md:p-7",children:[(0,i.jsxs)("div",{className:"flex flex-col items-center mb-3",children:[(0,i.jsx)("span",{className:"p-[10px] bg-primary min-w-min rounded-full mb-3 overflow-hidden text-xl-44 md:text-6xl",children:(0,i.jsx)(r.ZI,{className:"fill-white bg-primary"})}),(0,i.jsx)("h4",{children:m("Confirmation")})]}),(0,i.jsx)("h6",{className:"font-semibold text-center mb-7 md:mb-10",children:m(o)}),(0,i.jsxs)("div",{className:"flex items-center justify-center space-x-5 md:flex-row",children:[(0,i.jsx)(n.A,{className:"btn-primary btn-normal min-w-[86px]",onClick:s,label:m("Yes"),disabled:c,title:"Yes"}),(0,i.jsx)(n.A,{className:"btn-secondary btn-normal min-w-[86px]",onClick:l,label:m("No"),title:"No"})]})]})})}),"Are you sure want to delete this record ?"==o&&(0,i.jsx)("div",{id:"changeUserStatusModel",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"py-5 flex items-center justify-center h-full ".concat(x?"":"opacity-0 transform -translate-y-full scale-150 ","  transition-all duration-300 "),children:(0,i.jsx)("div",{className:"w-full mx-5 sm:max-w-[640px]",children:(0,i.jsxs)("div",{className:"relative p-5 text-center bg-white shadow rounded-xl md:p-7",children:[(0,i.jsx)("div",{className:"flex justify-center mb-5",children:(0,i.jsx)("span",{className:"p-[22px] md:p-[26px] rounded-full bg-error text-xl-35 md:text-5xl",children:(0,i.jsx)(r.Vl,{className:"stroke-2 fill-white"})})}),(0,i.jsx)("h6",{className:"font-bold text-center mb-7 md:mb-10",children:m(o)}),(0,i.jsxs)("div",{className:"flex items-center justify-center space-x-5 md:flex-row",children:[(0,i.jsx)(n.A,{className:"btn-primary btn-normal min-w-[86px]",onClick:s,label:m("Yes"),disabled:c,title:"Yes"}),(0,i.jsx)(n.A,{className:"btn-secondary btn-normal min-w-[86px]",onClick:l,label:m("No"),title:"No"})]})]})})})]})]})}},62500:(e,l,s)=>{s.d(l,{A:()=>i});var a=s(65043),t=s(41290),n=s(33556),r=s(70579);const i=e=>{let{data:l,setObj:s,setIsDelete:i,className:d,customClick:o}=e;const c=(0,a.useCallback)((()=>{s(l),!o&&i(!0),o&&o(l)}),[]);return(0,r.jsx)(t.A,{className:"bg-transparent cursor-pointer btn-default btn-icon ".concat(d),onClick:c,label:"",title:"Delete",children:(0,r.jsx)(n.lM,{className:"fill-error"})})}},36238:(e,l,s)=>{s.d(l,{A:()=>r});var a=s(65043),t=s(74117),n=s(70579);const r=e=>{let{errors:l,touched:s,setFieldTouched:r,children:i}=e;return((e,l,s)=>{const{i18n:n}=(0,t.Bd)();(0,a.useEffect)((()=>(n.on("languageChanged",(()=>{Object.keys(e).forEach((e=>{Object.keys(l).includes(e)&&s(e)}))})),()=>{n.off("languageChanged",(()=>{}))})),[e])})(l,s,r),(0,n.jsx)(n.Fragment,{children:i})}},12209:(e,l,s)=>{s.d(l,{A:()=>u});var a=s(65043),t=s(74117),n=s(73216),r=s(7648),i=s(33556),d=s(79456),o=s(75214),c=s(70579);const u=e=>{let{headerActionConst:l,headerTitle:s}=e;const{t:u}=(0,t.Bd)(),m=(0,d.wA)(),{show:x}=(0,d.d4)((e=>e.coursesManagement)),p=(0,n.zy)(),h=(0,a.useCallback)((()=>{m((0,o.oM)(!x))}),[x]);return(0,c.jsxs)("header",{className:"sticky top-0 z-20 flex bg-white border-b shadow-header xl:shadow-none xl:h-auto xl:block border-border-primary xl:px-2 xl:pt-0",children:[(0,c.jsx)("div",{onClick:h,className:"pt-5 cursor-pointer text-xl-22 xl:hidden",children:(0,c.jsx)(i.Rt,{className:"ml-4"})}),(0,c.jsx)("div",{className:"p-2.5 xl:p-[18px] xl:shadow-header max-xl:w-[calc(100%-47px)]",children:(0,c.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2.5",children:[(0,c.jsxs)("div",{className:"w-full xl:w-auto",children:[(0,c.jsx)("h1",{className:"mb-1 text-2xl max-xl:truncate xl:text-3xl",children:u(null!==s&&void 0!==s?s:(e=>{let l="";if(e.split("/")[2].includes("-")){return e.split("/")[2].split("-").forEach((e=>(l=l+e[0].toUpperCase()+e.slice(1)+" ",l))),l}return l=e.split("/")[2][0].toUpperCase()+e.split("/")[2].slice(1),l})(p.pathname))}),(0,c.jsx)(r.A,{})]}),l&&(0,c.jsx)("div",{className:"flex gap-2.5 max-xl:w-[calc(100%+40px)] lg:gap-5",children:(()=>{if(l)return l()})()})]})})]})}},57546:(e,l,s)=>{s.r(l),s.d(l,{default:()=>H});var a,t=s(65043),n=s(64526),r=s(74117),i=s(41290),d=s(8848),o=s(33556),c=s(57528),u=s(70459);const m=(0,u.J1)(a||(a=(0,c.A)(["\n  mutation UpdateRolePermissionsMapping($rolePermissionData: InputPermissionMultiDto!) {\n    updateRolePermissionsMapping(rolePermissionData: $rolePermissionData) {\n      message\n    }\n  }\n"])));var x,p,h=s(28610);(0,u.J1)(x||(x=(0,c.A)(["\n  query GetRolePermissions {\n    getRolePermissions {\n      data {\n        is_read\n        is_remove\n        is_update\n        is_write\n        module_id {\n          description\n          name\n          parent {\n            description\n            name\n            uuid\n          }\n          uuid\n        }\n        role_id {\n          description\n          name\n          status\n          uuid\n        }\n        uuid\n      }\n      message\n    }\n  }\n"])));const v=(0,u.J1)(p||(p=(0,c.A)(["\n  query GetRolePermissionById($roleId: String!) {\n    getRolePermissionsByRoleId(roleId: $roleId) {\n      data {\n        children {\n          is_read\n          is_remove\n          is_update\n          is_write\n          module_id {\n            description\n            name\n            parent {\n              uuid\n              name\n              description\n            }\n            uuid\n          }\n          role_id {\n            description\n            name\n            status\n            uuid\n          }\n          uuid\n        }\n        is_read\n        is_remove\n        is_update\n        is_write\n        uuid\n        role_id {\n          uuid\n          status\n          name\n          description\n        }\n        module_id {\n          uuid\n          parent {\n            name\n            description\n            uuid\n          }\n          name\n          description\n        }\n      }\n      message\n    }\n  }\n"])));var b,f,j,g,w,N=s(63516),y=s(34764);const R=(0,u.J1)(b||(b=(0,c.A)(["\nmutation UpdateRole($roleData: CreateRoleDto!, $roleId: String!) {\n  updateRole(roleData: $roleData, roleId: $roleId) {\n    data {\n      name\n      status\n      uuid\n      description\n    }\n    message\n  }\n}\n"]))),C=(0,u.J1)(f||(f=(0,c.A)(["\nmutation CreateRole($roleData: CreateRoleDto!) {\n    createRole(roleData: $roleData) {\n      message\n      data {\n        description\n        status\n        name\n        uuid\n      }\n    }\n  }\n"]))),_=(0,u.J1)(j||(j=(0,c.A)(["\nmutation ActivateRole($roleId: String!) {\n  activateRole(roleId: $roleId) {\n    data {\n      description\n      name\n      status\n      uuid\n    }\n    message\n  }\n}\n"]))),k=(0,u.J1)(g||(g=(0,c.A)(["\nmutation DeleteRole($roleId: String!) {\n  deleteRole(roleId: $roleId) {\n    data {\n      description\n      name\n      status\n      uuid\n    }\n    message\n  }\n}\n"])));(0,u.J1)(w||(w=(0,c.A)(["\nmutation GroupDeleteRoles($groupDeleteRolesId: [Int]) {\n  groupDeleteRoles(id: $groupDeleteRolesId) {\n    meta {\n      message\n      messageCode\n      statusCode\n      status\n      type\n      errors {\n        errorField\n        error\n      }\n      errorType\n    }\n  }\n}"])));var A=s(31881),S=s(12352),I=s(66925),P=s(36238),D=s(70579);const E=e=>{let{isRoleModelShow:l,onSubmitRole:s,onClose:a,roleVal:d,isRoleEditable:c,roleObj:u}=e;const{t:m}=(0,r.Bd)(),[x,p]=(0,A.n)(R),[h,v]=(0,A.n)(C),b={role:d||""},{addRoleValidationSchema:f}=(0,S.A)(),j=(0,N.Wx)({initialValues:b,validationSchema:f,onSubmit:e=>{c?w(e):g(e)}}),g=e=>{h({variables:{roleData:{description:e.role,name:e.role}}}).then((e=>{const l=e.data;n.oR.success(l.createRole.message),s()})).catch((e=>{n.oR.error(e.networkError.result.errors[0].message)}))},w=e=>{x({variables:{roleData:{name:e.role,description:e.role},roleId:u.uuid}}).then((e=>{const l=e.data;n.oR.success(l.updateRole.message),s()})).catch((e=>{n.oR.error(e.networkError.result.errors[0].message)}))},[_,k]=(0,t.useState)(!1);(0,t.useEffect)((()=>{l&&setTimeout((()=>{k(!0)}),100)}),[l]);const E=(0,t.useCallback)((e=>{j.setFieldValue(e.target.name,(0,I.AW)(e))}),[]);return(0,D.jsx)("div",{id:"defaultModal",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"fixed top-0 left-0 right-0 z-50 h-full bg-modal ".concat(l?"":"hidden"),children:(0,D.jsx)("div",{id:"changeUserStatusModel",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"py-5 flex items-center justify-center h-full ".concat(_?"":"opacity-0 transform -translate-y-full scale-150 "," transition-all duration-300 "),children:(0,D.jsx)("div",{className:"w-full mx-5 sm:max-w-[780px]",children:(0,D.jsxs)("div",{className:"relative bg-white shadow rounded-xl",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between px-5 py-6 mt-10 border-b bg-accents-2 rounded-t-xl",children:[(0,D.jsx)("p",{className:"font-bold text-baseColor",children:c?"Update Role":m("Add New Role")}),(0,D.jsx)(i.A,{onClick:a,label:m(""),title:"".concat(m("Close")),children:(0,D.jsx)("span",{className:"text-xl-22",children:(0,D.jsx)(o.YY,{className:" text-error"})})})]}),(0,D.jsx)(P.A,{errors:j.errors,touched:j.touched,setFieldTouched:j.setFieldTouched,children:(0,D.jsxs)("form",{className:"bg-white rounded-b-xl",onSubmit:j.handleSubmit,children:[(0,D.jsx)("div",{className:"p-5 border-b border-solid border-border-primary max-h-[calc(100vh-260px)] overflow-auto",children:(0,D.jsx)(y.A,{placeholder:m("Role Name"),name:"role",onChange:j.handleChange,onBlur:E,value:j.values.role,error:j.errors.role&&j.touched.role?j.errors.role:"",label:m("Role"),required:!0})}),(0,D.jsx)("div",{className:"flex justify-end p-5",children:(0,D.jsx)(i.A,{className:"btn-primary btn-normal w-full md:w-auto min-w-[160px]",type:"submit",label:m("Submit"),disabled:(null===v||void 0===v?void 0:v.loading)||(null===p||void 0===p?void 0:p.loading),title:"".concat(m("Submit"))})})]})})]})})})})};var F=s(42145),U=s(75289),M=s(32254),O=s(77654),B=s(62500);const $=e=>{let{data:l,setRoleObj:s,setIsRoleModelShow:a,setRoleVal:n,setIsRoleEditable:r}=e;const d=(0,t.useCallback)((()=>{s(l),a(!0),n(l.name),r(!0)}),[l]);return(0,D.jsx)(i.A,{className:"bg-transparent btn-default",onClick:d,label:"",title:"Edit",children:(0,D.jsx)(o.ff,{})})};var J=s(88250),T=s(79456);const z=e=>{var l,s,a,d,c,u;let{updatedRoleDataFunction:m}=e;const{data:x,refetch:p}=(0,J.I)(h.C7,{variables:{limit:500,page:1,search:"",sortOrder:"",sortField:"name"}}),[v,b]=(0,t.useState)({}),[f,j]=(0,t.useState)(!1),[g,w]=(0,t.useState)(!1),[N,R]=(0,t.useState)(!1),[C,S]=(0,t.useState)({}),[I]=(0,A.n)(_),[P]=(0,A.n)(k),[z,V]=(0,t.useState)(""),{t:Y}=(0,r.Bd)(),[G,q]=(0,t.useState)(!1),[L,W]=(0,t.useState)({limit:10,page:1,sortField:"name",sortOrder:"",search:"",index:0}),H=[{name:"Sr.No",sortable:!1,fieldName:"id"},{name:Y("Title"),sortable:!0,fieldName:"name"},{name:Y("Status"),sortable:!0,fieldName:"status"}],[Z,K]=(0,t.useState)(L.limit),Q=(null===v||void 0===v?void 0:v.count)||0,X=Math.ceil(Q/Z),{rolePermission:ee}=(0,T.d4)((e=>e.rolesManagement)),le=(0,t.useCallback)((e=>{const l={...L,page:e,index:(e-1)*L.limit};W(l),M.A.saveState("filterRuleSets",JSON.stringify(l))}),[]);(0,t.useEffect)((()=>{const e=M.A.getState("filterRuleSets",JSON.stringify(L));if(e){const l=JSON.parse(e);W(l)}}),[]),(0,t.useEffect)((()=>{L&&p(L)}),[L]),(0,t.useEffect)((()=>{null!==x&&void 0!==x&&x.getRoles&&b(null===x||void 0===x?void 0:x.getRoles.data)}),[null===x||void 0===x?void 0:x.getRoles]);const se=(0,t.useCallback)((()=>{j(!1),w(!1),R(!1)}),[]),ae=(0,t.useCallback)((()=>{j(!1),p(L),m()}),[]),te=(0,t.useCallback)((()=>{j(!0),q(!1),V("")}),[]),ne=e=>{w(!0),S(e)},re=(0,t.useCallback)((()=>{I({variables:{roleId:null===C||void 0===C?void 0:C.uuid}}).then((e=>{const l=e.data;n.oR.success(l.activateRole.message),w(!1),p(L)})).catch((e=>{n.oR.error(e.networkError.result.errors[0].message)}))}),[g]),ie=(0,t.useCallback)((e=>{W({...L,search:e.target.value})}),[]),de=(0,t.useCallback)((()=>{P({variables:{roleId:C.uuid}}).then((e=>{var l;m();const s=null===e||void 0===e?void 0:e.data;n.oR.success(null===s||void 0===s||null===(l=s.deleteRole)||void 0===l?void 0:l.message),R(!1),p(L).catch((e=>{n.oR.error(e)}))})).catch((e=>{n.oR.error(e.networkError.result.errors[0].message)}))}),[N]);return(0,t.useEffect)((()=>{K(L.limit)}),[L.limit]),(0,D.jsxs)("div",{className:"w-full mb-3 overflow-hidden bg-white border sm:w-auto rounded-xl border-border-primary",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b md:px-5 border-border-primary bg-accents-2",children:[(0,D.jsx)("h5",{className:"font-bold font-primary",children:Y("Basic Details")}),(0,D.jsx)("div",{children:(null===ee||void 0===ee?void 0:ee.write)&&(0,D.jsx)(i.A,{className:"btn-primary btn-normal md:w-[100px] 2xl:w-[150px] ml-5 whitespace-nowrap",onClick:te,type:"button",label:Y("Add New"),title:"".concat(Y("Add New"))})})]}),(0,D.jsxs)("div",{className:"flex flex-col items-center justify-start gap-3 p-3 md:p-5 md:justify-between xl:flex-row",children:[(0,D.jsx)("h5",{className:"font-bold font-primary",children:Y("Role List")}),(0,D.jsx)("div",{className:"relative w-full xl:w-auto",children:(0,D.jsx)(y.A,{type:"text",id:"table-search",value:L.search,placeholder:Y("Search"),onChange:ie,inputIcon:(0,D.jsx)(o.vj,{fontSize:"18",className:"font-normal"})})})]}),(0,D.jsxs)("div",{className:"mx-3 overflow-hidden md:mx-5",children:[(0,D.jsx)("div",{className:"overflow-auto border border-solid rounded-t-xl custom-dataTable border-border-primary",children:(0,D.jsxs)("table",{children:[(0,D.jsx)("thead",{children:(0,D.jsxs)("tr",{children:[null===H||void 0===H?void 0:H.map(((e,l)=>(0,D.jsx)("th",{scope:"col",children:(0,D.jsxs)("div",{className:"flex items-center ".concat("Sr.No"==e.name?"justify-center":""),children:[e.name,e.sortable&&(0,D.jsxs)("a",{onClick:()=>{return l=e.fieldName,void W({...L,sortField:l,sortOrder:"ascend"===L.sortOrder?"descend":"ascend"});var l},children:[(""===L.sortOrder||L.sortField!==e.fieldName)&&(0,D.jsx)(o.xs,{className:"fill-white"}),"ascend"===L.sortOrder&&L.sortField===e.fieldName&&(0,D.jsx)(o.xD,{className:"ml-1 fill-white"}),"descend"===L.sortOrder&&L.sortField===e.fieldName&&(0,D.jsx)(o.xR,{className:"ml-1 fill-white"})]})]})},"".concat(l+1)))),(0,D.jsx)("th",{scope:"col",children:(0,D.jsx)("div",{className:"flex items-center",children:Y("Action")})})]})}),(0,D.jsx)("tbody",{children:null===x||void 0===x||null===(l=x.getRoles.data)||void 0===l||null===(s=l.role)||void 0===s?void 0:s.map(((e,l)=>{const s=(null===L||void 0===L?void 0:L.index)+l+1;return(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{children:s}),(0,D.jsx)("td",{className:"truncate text-left text-ellipsis max-w-[360px]",children:e.name}),(0,D.jsx)("td",{children:(0,D.jsx)("div",{className:"flex",children:1===e.status?(0,D.jsx)("span",{className:"text-bright-green-shade",children:"Active"}):(0,D.jsx)("span",{className:"text-error",children:"Inactive"})})}),(0,D.jsx)("td",{children:(0,D.jsxs)("div",{className:"flex btn-group",children:[(null===ee||void 0===ee?void 0:ee.update)&&(0,D.jsx)($,{data:e,setRoleObj:S,setIsRoleModelShow:j,setRoleVal:V,setIsRoleEditable:q}),(0,D.jsx)("div",{className:"flex justify-center ml-2 mr-3",children:(null===ee||void 0===ee?void 0:ee.update)&&(0,D.jsx)("span",{onClick:()=>ne(e),className:"font-medium text-blue-600 hover:underline",children:(0,D.jsxs)("label",{className:"relative inline-flex items-center mb-0 cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",className:"sr-only peer",value:e.status,checked:1===e.status,onChange:()=>ne(e)}),(0,D.jsx)("div",{className:"w-[30px] h-[14px] bg-secondary rounded-full peer peer-focus:ring-3 peer-focus:ring-red-200 peer-checked:after:translate-x-full peer-checked:after:border-white after:content- after:absolute after:top-[-1px] after:left-0 after:bg-white after:drop-shadow-outline-2 after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-primary"})]})})}),(null===ee||void 0===ee?void 0:ee.delete)&&(0,D.jsx)(B.A,{data:e,setObj:S,setIsDelete:R})]})})]},e.uuid)}))})]})}),(0,D.jsxs)("div",{className:"flex flex-wrap items-center gap-5 mt-2",children:[(0===(null===x||void 0===x||null===(a=x.getRoles)||void 0===a||null===(d=a.data)||void 0===d?void 0:d.count)||null===(null===x||void 0===x||null===(c=x.getRoles)||void 0===c||null===(u=c.data)||void 0===u?void 0:u.role))&&(0,D.jsx)("div",{className:"flex justify-center",children:(0,D.jsx)("div",{children:Y("No Data")})}),(0,D.jsxs)("div",{className:"flex items-center gap-5 mb-4 md:gap-7",children:[(0,D.jsxs)("div",{className:"flex items-center justify-start",children:[(0,D.jsx)("span",{className:"text-sm font-normal text-gray-900 whitespace-nowrap",children:Y("Per Page")}),(0,D.jsx)("select",{className:"border border-border-primary rounded-xl ml-2 px-3 text-sm py-1.5 text-gray-500 w-[70px] h-[36px] appearance-none bg-white",onChange:e=>(e=>{K(Number(e));const l={...L,limit:parseInt(e),page:1,search:"",index:0};W(l),M.A.saveState("filterRuleSets",JSON.stringify(l))})(e.target.value),value:L.limit,children:null===F.aj||void 0===F.aj?void 0:F.aj.map((e=>(0,D.jsx)("option",{children:e},e)))})]}),(0,D.jsx)(O.A,{currentPage:L.page,totalPages:X,onPageChange:le,recordsPerPage:Z})]})]})]}),f&&(0,D.jsx)(E,{isRoleModelShow:f,isRoleEditable:G,onSubmitRole:ae,onClose:se,roleVal:z,roleObj:C}),N&&(0,D.jsx)(U.A,{warningText:F.jl,onClose:se,action:de,show:N}),g&&(0,D.jsx)(U.A,{warningText:F.lN,onClose:se,action:re,show:g})]})},V=e=>{let{parent:l,parentPermissionUpdate:s,parentIndex:a}=e;return(0,D.jsx)(t.Fragment,{children:(0,D.jsxs)("div",{className:"flex gap-3 py-1 main",children:[(0,D.jsx)("label",{className:"w-20 text-left whitespace-nowrap min-w-[65px]",children:(0,D.jsx)("input",{type:"checkbox",value:l.is_read,checked:1===l.is_read,onChange:()=>s(a,"is_read")})}),(0,D.jsx)("label",{className:"w-20 text-left whitespace-nowrap min-w-[65px]",children:(0,D.jsx)("input",{type:"checkbox",value:l.is_write,checked:1===l.is_write,onChange:()=>s(a,"is_write")})}),(0,D.jsx)("label",{className:"w-20 text-left whitespace-nowrap min-w-[65px]",children:(0,D.jsx)("input",{type:"checkbox",value:l.is_update,checked:1===l.is_update,onChange:()=>s(a,"is_update")})}),(0,D.jsx)("label",{className:"w-20 text-left whitespace-nowrap min-w-[65px]",children:(0,D.jsx)("input",{type:"checkbox",value:l.is_remove,checked:1===l.is_remove,onChange:()=>s(a,"is_remove")})})]})})},Y=t.memo(V),G=e=>{let{child:l,childPermissionUpdate:s,parentIndex:a,childIndex:n}=e;return(0,D.jsx)(t.Fragment,{children:(0,D.jsxs)("div",{className:"flex gap-3 py-1 main",children:[(0,D.jsx)("label",{className:"w-20 text-left whitespace-nowrap min-w-[65px]",children:(0,D.jsx)("input",{type:"checkbox",value:l.is_read,checked:1===l.is_read,onChange:()=>s(a,n,"is_read")})}),(0,D.jsx)("label",{className:"w-20 text-left whitespace-nowrap min-w-[65px]",children:(0,D.jsx)("input",{type:"checkbox",value:l.is_write,checked:1===l.is_write,onChange:()=>s(a,n,"is_write")})}),(0,D.jsx)("label",{className:"w-20 text-left whitespace-nowrap min-w-[65px]",children:(0,D.jsx)("input",{type:"checkbox",value:l.is_update,checked:1===l.is_update,onChange:()=>s(a,n,"is_update")})}),(0,D.jsx)("label",{className:"w-20 text-left whitespace-nowrap min-w-[65px]",children:(0,D.jsx)("input",{type:"checkbox",value:l.is_remove,checked:1===l.is_remove,onChange:()=>s(a,n,"is_remove")})})]})})},q=t.memo(G);var L=s(12209),W=s(35475);const H=()=>{var e,l,s,a,c,u,x;const{t:p}=(0,r.Bd)(),{data:b,refetch:f}=(0,J.I)(h.C7,{variables:{limit:500,page:1,search:"",sortOrder:"",sortField:"name"}}),[j,g]=(0,A.n)(m),[w,N]=(0,t.useState)([]),[y,R]=(0,t.useState)({is_read:0,is_remove:0,is_update:0,is_write:0}),[C,_]=(0,t.useState)({roleId:null}),{data:k,refetch:S}=(0,J.I)(v,{variables:{roleId:null===b||void 0===b||null===(e=b.getRoles)||void 0===e||null===(l=e.data)||void 0===l||null===(s=l.role)||void 0===s||null===(a=s[0])||void 0===a?void 0:a.uuid}}),[I,P]=(0,t.useState)([]),E=[{id:"is_read",name:"View",value:"View"},{id:"is_write",name:"Add",value:"Add"},{id:"is_update",name:"Update",value:"Update"},{id:"is_remove",name:"Delete",value:"Delete"}],{rolePermission:U}=(0,T.d4)((e=>e.rolesManagement)),{userProfileData:M}=(0,T.d4)((e=>e.userProfile)),O=null!==(c=null===M||void 0===M||null===(u=M.getProfile)||void 0===u||null===(x=u.data)||void 0===x?void 0:x.user_type)&&void 0!==c?c:"";(0,t.useEffect)((()=>{var e,l;if(null!==b&&void 0!==b&&b.getRoles){var s,a,t,n,r,i;const e=[];null===b||void 0===b||null===(s=b.getRoles)||void 0===s||null===(a=s.data)||void 0===a||a.role.map((l=>{e.push({name:l.name,key:l.uuid})})),N(e),_({roleId:null===b||void 0===b||null===(t=b.getRoles)||void 0===t||null===(n=t.data)||void 0===n||null===(r=n.role)||void 0===r||null===(i=r[0])||void 0===i?void 0:i.uuid})}0===(null===b||void 0===b||null===(e=b.getRoles)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.count)&&P([])}),[b]);const B=(0,t.useCallback)((()=>{f(),S()}),[]);function $(e,l){if(e)return e.every((e=>1===e[l]&&(!e.children||!Array.isArray(e.children)||$(e.children,l))))}const V=(0,t.useCallback)((()=>{var e,l;(null===k||void 0===k||null===(e=k.getRolePermissionsByRoleId)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.length)>0&&E.forEach((e=>{var l;const s=$(null===k||void 0===k||null===(l=k.getRolePermissionsByRoleId)||void 0===l?void 0:l.data,e.id);0===y[e.id]&&s&&R((l=>({...l,[e.id]:1})))}))}),[k]);(0,t.useEffect)((()=>{null!==C.roleId&&S(C).catch((e=>n.oR.error(e)))}),[C]),(0,t.useEffect)((()=>{var e;null!==k&&void 0!==k&&k.getRolePermissionsByRoleId&&P(null===k||void 0===k||null===(e=k.getRolePermissionsByRoleId)||void 0===e?void 0:e.data)}),[k]),(0,t.useEffect)((()=>{var e,l;(null===k||void 0===k||null===(e=k.getRolePermissionsByRoleId)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.length)>0&&V()}),[k]);const G=(0,t.useCallback)((e=>{_({roleId:e.target.value}),R({is_read:0,is_remove:0,is_update:0,is_write:0})}),[]),H=(0,t.useCallback)((()=>{const e=[];I.map((l=>{const s={is_read:null===l||void 0===l?void 0:l.is_read,is_remove:null===l||void 0===l?void 0:l.is_remove,is_update:null===l||void 0===l?void 0:l.is_update,is_write:null===l||void 0===l?void 0:l.is_write,uuid:null===l||void 0===l?void 0:l.uuid,children:(null===l||void 0===l?void 0:l.children.length)>0?null===l||void 0===l?void 0:l.children.map((e=>({is_read:null===e||void 0===e?void 0:e.is_read,is_remove:null===e||void 0===e?void 0:e.is_remove,is_update:null===e||void 0===e?void 0:e.is_update,is_write:null===e||void 0===e?void 0:e.is_write,uuid:null===e||void 0===e?void 0:e.uuid}))):[]};e.push(s)})),j({variables:{rolePermissionData:{permission:e}}}).then((e=>{var l;const s=null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.updateRolePermissionsMapping;n.oR.success(s.message)})).catch((e=>{n.oR.error(e.networkError.result.errors[0].message)}))}),[I]),Z=e=>{const{value:l,checked:s}=null===e||void 0===e?void 0:e.target;R({...y,[l]:!0===s?1:0});const a=[...I],t=a.map(((e,t)=>{const n={...a[t]};n[l]=s?1:0;const r=n.children.map((e=>{const s={...e};return s[l]=n[l],s}));return n.children=r,n}));P([...t])},K=(e,l)=>{const s=[...I],a={...s[e]};a[l]=0===a[l]?1:0;const t=a.children.map((e=>{const s={...e};return s[l]=a[l],s}));a.children=t,s[e]=a,1===y[l]&&0===a[l]&&R({...y,[l]:0});const n=$(s,l);0===y[l]&&n&&R({...y,[l]:1}),P([...s])},Q=(e,l,s)=>{const a=[...I],t={...a[e]},n=[...t.children],r={...n[l]};r[s]=0===r[s]?1:0,n[l]=r,t.children=n,a[e]=t,1===y[s]&&0===r[s]&&R({...y,[s]:0});const i=$(a,s);0===y[s]&&i&&R({...y,[s]:1}),P([...a])};return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(L.A,{headerActionConst:()=>{if(O!==F.ve.SUPER_ADMIN)return(0,D.jsx)(W.N_,{to:"/".concat(F.bw.app,"/").concat(F.bw.createNewAccount),className:"btn-normal md: btn btn-secondary",type:"button",children:p("Create New Employee")})}}),(0,D.jsxs)("div",{className:"flex flex-col h-screen mt-5 mb-5 lg:flex-row",children:[(0,D.jsx)("div",{className:"mb-5 lg:w-1/2 lg:mr-7",children:(0,D.jsxs)("div",{className:"w-full m-auto overflow-hidden bg-white border border-border-primary rounded-xl",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between w-full px-3 py-2 border-b md:px-5 border-border-primary bg-accents-2",children:[(0,D.jsx)("div",{className:"w-[65%] max-w-[360px]",children:(0,D.jsx)(d.A,{placeholder:p("Select role"),name:"role",value:C.roleId?C.roleId:"",onChange:G,options:w,id:"role"})}),(null===U||void 0===U?void 0:U.update)&&(0,D.jsx)("div",{children:(0,D.jsx)(i.A,{className:"btn-primary btn-normal md:w-[100px] 2xl:w-[150px] ml-5 whitespace-nowrap",label:"",onClick:H,disabled:null===g||void 0===g?void 0:g.loading,title:"".concat(p("Save")),children:p("Save")})})]}),(0,D.jsx)("div",{className:"w-full p-3 overflow-auto md:p-5",children:(0,D.jsxs)("div",{className:"min-w-[600px]",children:[(0,D.jsx)("div",{className:"flex justify-end gap-3 pb-4 mb-4 border-b border-solid border-border-primary",children:E.map((e=>(0,D.jsx)("div",{className:"w-20 text-left whitespace-nowrap min-w-[65px] items-center justify-center",children:(0,D.jsxs)("label",{className:"flex",children:[(0,D.jsx)("input",{className:"mr-2",type:"checkbox",value:e.id,checked:y[e.id],onChange:Z}),e.name]},e.id)},e.id)))}),I.map(((e,l)=>{var s;return(0,D.jsxs)("div",{className:"parent",children:[(0,D.jsxs)("div",{className:"flex gap-8 py-1 main",children:[(0,D.jsxs)("div",{className:"flex items-center w-full gap-1",children:[(0,D.jsx)(o.vd,{fontSize:"18"}),null===e||void 0===e||null===(s=e.module_id)||void 0===s?void 0:s.name]}),(0,D.jsx)(Y,{parent:e,parentPermissionUpdate:K,parentIndex:l})]}),null===e||void 0===e?void 0:e.children.map(((e,s)=>{var a;return(0,D.jsxs)("div",{className:"flex gap-3 py-1 ml-6 child-role-permission",children:[(0,D.jsxs)("div",{className:"flex items-center w-full gap-1",children:[(0,D.jsx)(o.vd,{fontSize:"18"}),null===e||void 0===e||null===(a=e.module_id)||void 0===a?void 0:a.name]}),(0,D.jsx)(q,{child:e,childPermissionUpdate:Q,parentIndex:l,childIndex:s})]},null===e||void 0===e?void 0:e.uuid)}))]},null===e||void 0===e?void 0:e.uuid)}))]})})]})}),(0,D.jsx)("div",{className:"h-auto lg:w-1/2",children:(0,D.jsx)(z,{updatedRoleDataFunction:B})})]})]})}}}]);
//# sourceMappingURL=7546.7c2e58aa.chunk.js.map