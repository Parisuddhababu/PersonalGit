"use strict";(self.webpackChunkterraforma_systems=self.webpackChunkterraforma_systems||[]).push([[3480],{7648:(e,l,i)=>{i.d(l,{A:()=>v});var n=i(65043),t=i(74117),a=i(73216),o=i(35475),d=i(42145),r=i(79456),s=i(66925),u=i(70579);const c=()=>{var e,l,i;const{t:c}=(0,t.Bd)(),v=(0,a.zy)(),m=new URLSearchParams(v.search).get("uuid"),{id:p}=(0,a.g)(),{userProfileData:x}=(0,r.d4)((e=>e.userProfile)),h=null!==(e=null===x||void 0===x||null===(l=x.getProfile)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.user_type)&&void 0!==e?e:"",y=e=>{var l;let i="";if(null!==(l=e.split("/")[2])&&void 0!==l&&l.includes("-")){return e.split("/")[2].split("-").forEach((e=>{var l;return i=i+(null===(l=e[0])||void 0===l?void 0:l.toUpperCase())+e.slice(1)+" ",i})),i}var n;return i=(null===(n=e.split("/")[2][0])||void 0===n?void 0:n.toUpperCase())+e.split("/")[2].slice(1),i},f=e=>{let l="";if(null!==e&&void 0!==e&&e.includes("-")){l=null===e||void 0===e?void 0:e.replace(/-|\s/g," ");const i=l.split(" ");for(let e=0;e<i.length;e++)i[e]=i[e][0].toUpperCase()+i[e].substring(1);return l=i.join(" "),l}var i;return l=(null===e||void 0===e||null===(i=e[0])||void 0===i?void 0:i.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))+" ",l},g=e=>{let l="";return null!==e&&void 0!==e&&e.includes("-")||(l=(null===e||void 0===e||null===(i=e[0])||void 0===i?void 0:i.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))+" "),l;var i},_=v.pathname.split("/"),b=(0,n.useCallback)((()=>{if((null===_||void 0===_?void 0:_.length)>0){const e=null===_||void 0===_?void 0:_.length;if(e<4)return(0,u.jsx)("span",{className:"text-primary",children:_[2]&&"".concat(c(f(_[2])))});if(e<5)return""!==_[3]?_[3].length>32?(0,u.jsxs)(u.Fragment,{children:[g(_[3])&&(0,u.jsx)("span",{className:"text-primary",children:(0,u.jsx)(o.k2,{to:"/".concat(d.bw.app,"/").concat(_[2]),className:"text-light-grey hover:underline",children:"".concat(c(y(v.pathname)))})}),g(_[3])&&(0,u.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),!g(_[3])&&(0,u.jsx)("span",{className:"text-primary",children:_[2]&&"".concat(c(f(_[2])))}),(0,u.jsx)("span",{className:"text-primary",children:_[3]&&"".concat(c(g(_[3])))})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:"text-primary",children:(0,u.jsx)(o.k2,{to:"/".concat(d.bw.app,"/").concat(_[2]),className:"text-light-grey hover:underline",children:"".concat(c(y(v.pathname)))})}),(0,u.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,u.jsx)("span",{className:"text-primary",children:_[3]&&"".concat(c(f(_[3])))})]}):(0,u.jsx)("span",{className:"text-primary",children:_[2]&&"".concat(c(f(_[2])))});if(e<6)return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:"text-primary",children:(0,u.jsx)(o.k2,{to:"/".concat(d.bw.app,"/").concat(_[2]),className:"text-light-grey hover:underline",children:"".concat(c(y(v.pathname)))})}),(0,u.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,u.jsx)("span",{className:"text-primary",children:_[3]&&"".concat(c(f(_[3])))})]});if(e<7){let e="";return m?e="?uuid=".concat(m):p&&(e="?uuid=".concat(p)),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:"text-primary",children:(0,u.jsx)(o.k2,{to:"/".concat(d.bw.app,"/").concat(_[2]),className:"text-light-grey hover:underline",children:c(f(_[2]))})}),(0,u.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,u.jsx)("span",{className:"text-primary",children:(0,u.jsx)(o.k2,{to:"/".concat(d.bw.app,"/").concat(_[2],"/").concat(_[3],"/").concat((""!==m||""!==p)&&e),className:"text-light-grey hover:underline",children:c(f(_[3]))})}),(0,u.jsx)("span",{className:"mx-2 text-light-grey",children:">"}),(0,u.jsx)("span",{className:"text-primary",children:_[5]&&"".concat(c(f(_[4])))})]})}}}),[_]);return(0,u.jsx)("div",{className:"w-full",children:(0,u.jsxs)("p",{className:"max-xs:text-xs text-xs-14 max-md:truncate",children:[(0,u.jsxs)("span",{children:[(0,u.jsx)(o.k2,{to:(0,s.Go)(h,d.ve.SUPER_ADMIN,"/".concat(d.bw.app,"/").concat(d.bw.dashboard),"/".concat(d.bw.app,"/").concat(d.bw.subscriber)),className:"cursor-pointer text-light-grey hover:underline",children:c("Home")}),(0,u.jsx)("span",{className:"mx-2 text-light-grey",children:">"})]}),b()]})})},v=n.memo(c)},81410:(e,l,i)=>{i.d(l,{A:()=>t});i(65043);var n=i(70579);const t=function(){return(0,n.jsx)("div",{className:"w-12 h-12 mx-auto rounded-[50%] border-solid border-4 border-[#E8E8EA] border-r-[#2575d6] animate-spin absolute left-[58%] top-[40%] z-[9999]"})}},12209:(e,l,i)=>{i.d(l,{A:()=>c});var n=i(65043),t=i(74117),a=i(73216),o=i(7648),d=i(33556),r=i(79456),s=i(75214),u=i(70579);const c=e=>{let{headerActionConst:l,headerTitle:i}=e;const{t:c}=(0,t.Bd)(),v=(0,r.wA)(),{show:m}=(0,r.d4)((e=>e.coursesManagement)),p=(0,a.zy)(),x=(0,n.useCallback)((()=>{v((0,s.oM)(!m))}),[m]);return(0,u.jsxs)("header",{className:"sticky top-0 z-20 flex bg-white border-b shadow-header xl:shadow-none xl:h-auto xl:block border-border-primary xl:px-2 xl:pt-0",children:[(0,u.jsx)("div",{onClick:x,className:"pt-5 cursor-pointer text-xl-22 xl:hidden",children:(0,u.jsx)(d.Rt,{className:"ml-4"})}),(0,u.jsx)("div",{className:"p-2.5 xl:p-[18px] xl:shadow-header max-xl:w-[calc(100%-47px)]",children:(0,u.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2.5",children:[(0,u.jsxs)("div",{className:"w-full xl:w-auto",children:[(0,u.jsx)("h1",{className:"mb-1 text-2xl max-xl:truncate xl:text-3xl",children:c(null!==i&&void 0!==i?i:(e=>{let l="";if(e.split("/")[2].includes("-")){return e.split("/")[2].split("-").forEach((e=>(l=l+e[0].toUpperCase()+e.slice(1)+" ",l))),l}return l=e.split("/")[2][0].toUpperCase()+e.split("/")[2].slice(1),l})(p.pathname))}),(0,u.jsx)(o.A,{})]}),l&&(0,u.jsx)("div",{className:"flex gap-2.5 max-xl:w-[calc(100%+40px)] lg:gap-5",children:(()=>{if(l)return l()})()})]})})]})}},95295:(e,l,i)=>{i.d(l,{JU:()=>c,NR:()=>m,Wm:()=>u,nV:()=>v});var n,t,a,o,d,r=i(57528),s=i(70459);(0,s.J1)(n||(n=(0,r.A)(["mutation GetZoneBySiteId($siteId: String!) {\n    getZoneBySiteId(siteId: $siteId) {\n      message\n      data {\n        uuid\n        location\n        city\n        diversion_percentage\n        zoneCount\n      }\n    }\n  }"])));const u=(0,s.J1)(t||(t=(0,r.A)(["mutation CreateOrUpdateZone($zoneData: CreateZoneDto!) {\n  createOrUpdateZone(zoneData: $zoneData) {\n    message\n    data {\n      uuid\n      location\n      city\n      diversion_percentage\n      parent {\n        uuid\n        location\n        city\n        diversion_percentage\n        zoneCount\n      }\n    }\n  }\n}"]))),c=(0,s.J1)(a||(a=(0,r.A)(["mutation DeleteZone($siteId: String!, $zoneId: String!) {\n  deleteZone(siteId: $siteId, zoneId: $zoneId) {\n    message\n  }\n}"]))),v=(0,s.J1)(o||(o=(0,r.A)(["query GetActiveSites {\n  getActiveSites {\n    message\n    data {\n      uuid\n      location\n      city\n      diversion_percentage\n      zoneCount\n    }\n  }\n}"]))),m=(0,s.J1)(d||(d=(0,r.A)(["mutation GetZoneBySiteId($siteId: String!) {\n  getZoneBySiteId(siteId: $siteId) {\n    message\n    data {\n      uuid\n      location\n      city\n      diversion_percentage\n      zoneCount\n    }\n  }\n} "])))},10541:(e,l,i)=>{i.d(l,{ac:()=>r,cu:()=>s});var n,t,a,o=i(57528),d=i(70459);const r=(0,d.J1)(n||(n=(0,o.A)(["query GetFrequencyWithPagination($sortOrder: String!, $sortField: String!, $limit: Float!, $page: Float!, $search: String!) {\n    getFrequencyWithPagination(sortOrder: $sortOrder, sortField: $sortField, limit: $limit, page: $page, search: $search) {\n      message\n      data {\n        frequency {\n          uuid\n          frequency_type\n          frequency\n        }\n        count\n      }\n    }\n  }"]))),s=(0,d.J1)(t||(t=(0,o.A)(["query GetFrequencies {\n    getFrequencies {\n      message\n      data {\n        uuid\n        frequency_type\n        frequency\n      }\n    }\n  }"])));(0,d.J1)(a||(a=(0,o.A)(["  query GetFrequencyById($frequencyId: String!) {\n    getFrequencyById(frequencyId: $frequencyId) {\n      message\n      data {\n        uuid\n        frequency_type\n        frequency\n      }\n    }\n  }"])))},33480:(e,l,i)=>{i.r(l),i.d(l,{default:()=>R});var n,t,a,o=i(41290),d=i(8848),r=i(12209),s=i(65043),u=i(74117),c=i(34764),v=i(88250),m=i(31881),p=i(57528),x=i(70459);const h=(0,x.J1)(n||(n=(0,p.A)(["query GetCompanyContractorUsers($companyId: String!, $locationId: String!) {\n    getCompanyContractorUsers(companyId: $companyId, locationId: $locationId) {\n      message\n      data {\n        first_name\n        last_name\n        uuid\n        user_type\n      }\n    }\n  }"]))),y=(0,x.J1)(t||(t=(0,p.A)(["query GetAllDiversionTemplates($locationId: String!) {\n  getAllDiversionTemplates(locationId: $locationId) {\n      message\n       data {\n        equipment {\n          name\n          uuid\n        }\n        is_equipment_updated\n        is_material_type_updated\n        is_material_updated\n        is_service_type_updated\n        is_volume_updated\n        location {\n          location\n          uuid\n        }\n        material {\n          name\n          uuid\n        }\n        material_type {\n          uuid\n          type\n          weight\n        }\n        service_type\n        subscriber {\n          uuid\n        }\n        volume {\n          uuid\n          volume\n          volume_cubic_yard\n        }\n        uuid\n      }\n    }\n  }\n  "]))),f=(0,x.J1)(a||(a=(0,p.A)(["query GetAllDiversionContractorServices($companyId: String!, $limit: Float!, $page: Float!, $locationId: String!) {\n  getAllDiversionContractorServices(companyId: $companyId,  limit: $limit, page: $page, locationId: $locationId) {\n    message\n    data {\n      count\n      contractorServices {\n          add_units\n      contractor_company {\n        name\n        uuid\n      }\n     diversion_report_template {\n        equipment {\n          name\n          uuid\n        }\n        material {\n          uuid\n          name\n        }\n        material_type {\n          uuid\n          type\n          weight\n        }\n        service_type\n        volume {\n          uuid\n          volume\n          volume_cubic_yard\n        }\n        uuid\n      }\n      frequency {\n        uuid\n        frequency_type\n        frequency\n      }\n      location {\n        location\n        uuid\n      }\n      subscriber {\n        uuid\n      }\n      user {\n        first_name\n        last_name\n        uuid\n      }\n      zone {\n        location\n        uuid\n      }\n      uuid\n      is_full_site\n      }\n    }\n  }\n}\n\n"])));var g=i(79456),_=i(1099),b=i(33556),j=i(70579);const N=()=>{var e,l,i,n,t,a;const{t:d}=(0,u.Bd)(),r=(0,g.wA)(),c=(0,g.d4)((e=>e.diversionContractors)),{data:m,loading:p}=(0,v.I)(y,{fetchPolicy:"network-only",skip:!(null!==c&&void 0!==c&&c.locationId),variables:{locationId:null===c||void 0===c?void 0:c.locationId}}),[x,h]=(0,s.useState)([]),f=[{name:d("Service Type"),sortable:!1},{name:d("Material Category"),sortable:!1,fieldName:"Material Category"},{name:d("Material Type"),sortable:!1,fieldName:"Material Type"},{name:d("Equipment"),sortable:!1,fieldName:"Equipment"},{name:d("Volume"),sortable:!1,fieldName:"Volume"}],N=(0,s.useCallback)((()=>{r((0,_.G$)(null===x||void 0===x?void 0:x.map((e=>{var l;return null===e||void 0===e||null===(l=e.diversion_report_template)||void 0===l?void 0:l.uuid})))),r((0,_.T4)(x)),r((0,_.Op)(!1))}),[x]);return(0,j.jsx)("div",{children:(0,j.jsx)("div",{id:"defaultModal",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:" fixed top-0 left-0 right-0 z-50 h-full bg-modal modal",children:(0,j.jsx)("div",{id:"changeUserStatusModel",tabIndex:-1,"data-modal-show":!0,"aria-hidden":"false",className:"flex items-center justify-center h-full py-5 transition-all duration-300",children:(0,j.jsx)("div",{className:"w-full mx-5 sm:max-w-[780px] ",children:(0,j.jsxs)("div",{className:"relative bg-white rounded-xl",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b md:py-6 bg-accents-2 rounded-t-xl",children:[(0,j.jsx)("p",{className:"text-lg font-bold md:text-xl text-baseColor",children:"Add New Service"}),(0,j.jsx)(o.A,{onClick:()=>r((0,_.Op)(!1)),label:d(""),children:(0,j.jsx)("span",{className:"text-xl-22",children:(0,j.jsx)(b.YY,{className:"text-error"})})})]}),(0,j.jsx)("div",{className:"mb-3 bg-white rounded-xl overflow-y-auto max-h-[300px] mx-7 p-3 md:p-5",children:(0,j.jsxs)("div",{className:"w-full mb-3 overflow-auto bg-white border sm:w-auto rounded-t-xl custom-dataTable border-border-primary",children:[(0,j.jsxs)("table",{children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[null===f||void 0===f?void 0:f.map((e=>(0,j.jsx)("th",{scope:"col",children:(0,j.jsx)("div",{className:"flex items-center ".concat("Status"==e.name?"justify-center":""),children:e.name})},crypto.randomUUID()))),(0,j.jsx)("th",{scope:"col",children:(0,j.jsx)("div",{className:"flex items-center",children:d("Action")})})]})}),(0,j.jsxs)("tbody",{children:[p&&(0,j.jsx)("tr",{children:(0,j.jsx)("div",{className:" flex justify-center  p-4",children:(0,j.jsx)("div",{className:"w-7 h-7 mx-auto rounded-[50%] border-solid border-4 border-[#E8E8EA] border-r-[#2575d6] animate-spin  z-[9999]"})})}),null===m||void 0===m||null===(e=m.getAllDiversionTemplates)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.map((e=>{var l,i,n,t;return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"text-left",children:null===e||void 0===e?void 0:e.service_type}),(0,j.jsx)("td",{className:"text-left",children:null===e||void 0===e||null===(l=e.material)||void 0===l?void 0:l.name}),(0,j.jsx)("td",{className:"text-left",children:null===e||void 0===e||null===(i=e.material_type)||void 0===i?void 0:i.type}),(0,j.jsx)("td",{className:"text-left",children:null===e||void 0===e||null===(n=e.equipment)||void 0===n?void 0:n.name}),(0,j.jsx)("td",{className:"text-left",children:null===e||void 0===e||null===(t=e.volume)||void 0===t?void 0:t.volume}),(0,j.jsx)("td",{className:"text-left",children:(0,j.jsx)("div",{className:"btn-group",children:(0,j.jsx)("input",{type:"checkbox",onClick:()=>(e=>{const l={diversion_report_template:{uuid:null===e||void 0===e?void 0:e.uuid,equipment:null===e||void 0===e?void 0:e.equipment,material:null===e||void 0===e?void 0:e.material,material_type:null===e||void 0===e?void 0:e.material_type,service_type:null===e||void 0===e?void 0:e.service_type,volume:null===e||void 0===e?void 0:e.volume,location:null===e||void 0===e?void 0:e.location},add_units:0,contractor_company:{uuid:"",name:""},frequency:{frequency:null,frequency_type:"",uuid:""},subscriber:null===e||void 0===e?void 0:e.subscriber,user:{first_name:"",last_name:"",uuid:""},zone:{location:"",uuid:""},uuid:"",is_full_site:!1};h((e=>e.find((e=>{var i,n;return(null===e||void 0===e||null===(i=e.diversion_report_template)||void 0===i?void 0:i.uuid)===(null===l||void 0===l||null===(n=l.diversion_report_template)||void 0===n?void 0:n.uuid)}))?e.filter((e=>{var i,n;return(null===e||void 0===e||null===(i=e.diversion_report_template)||void 0===i?void 0:i.uuid)!==(null===l||void 0===l||null===(n=l.diversion_report_template)||void 0===n?void 0:n.uuid)})):[...e,l]))})(e)})})})]},null===e||void 0===e?void 0:e.uuid)}))]})]}),(null===(null===m||void 0===m||null===(i=m.getAllDiversionTemplates)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.length)||void 0===(null===m||void 0===m||null===(t=m.getAllDiversionTemplates)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.length))&&(0,j.jsx)("div",{className:"flex justify-center",children:(0,j.jsx)("div",{children:d("No Data")})})]})}),(0,j.jsx)("div",{className:"flex flex-col items-center justify-end p-5 border-t border-solid md:space-x-3 md:flex-row border-border-primary",children:(0,j.jsx)(o.A,{label:"Add",className:"btn-primary btn-normal w-full md:w-auto min-w-[160px]",type:"submit",onClick:N})})]})})})})})};var w,D,C=i(35475),S=i(95295),q=i(64526),I=i(10541),A=i(63516),k=i(12352);const $=(0,x.J1)(w||(w=(0,p.A)(["mutation CreateDiversionContractorService($serviceData: [CreateDiversionContractorServiceDto!]!) {\n    createDiversionContractorService(serviceData: $serviceData) {\n      message\n    }\n  }"]))),F=(0,x.J1)(D||(D=(0,p.A)(["mutation DeleteDiversionContractorService($serviceId: [String!]!) {\n  deleteDiversionContractorService(serviceId: $serviceId) {\n    message\n  }\n}"])));var z=i(66925),T=i(81410);const R=()=>{var e,l,i,n,t,a,p,x,y;const{t:w}=(0,u.Bd)(),D=(0,g.d4)((e=>e.diversionContractors)),[R,U]=(0,s.useState)([]),V=(0,g.wA)(),[E]=(0,C.ok)(),J=E.get("companyId"),M=E.get("locationId"),O=E.get("companyName"),Z=[{name:w("Select Zone"),sortable:!1},{name:w("Service Type"),sortable:!1},{name:w("Material Category"),sortable:!1,fieldName:"Material Category"},{name:w("Material Type"),sortable:!0,fieldName:"Material Type"},{name:w("Equipment"),sortable:!0,fieldName:"Equipment"},{name:w("Volume"),sortable:!0,fieldName:"Volume"},{name:w("Add Unit"),sortable:!0,fieldName:"Add Unit"},{name:w("Select Frequency"),sortable:!0,fieldName:"Select Frequency"}],{data:B}=(0,v.I)(h,{fetchPolicy:"network-only",skip:!J||!M,variables:{companyId:J,locationId:M}}),{data:G}=(0,v.I)(f,{fetchPolicy:"network-only",skip:!J,variables:{companyId:J,locationId:M,limit:10,page:1}}),[P,{loading:W}]=(0,m.n)($),[L,{loading:Y}]=(0,m.n)(F),{data:H}=(0,v.I)(I.cu,{fetchPolicy:"network-only"}),[K]=(0,m.n)(S.NR),[Q,X]=(0,s.useState)([{name:"Select Report Owner",key:""}]),[ee,le]=(0,s.useState)([{name:"Select Frequency",key:""}]),{createDiversionReportValidationSchema:ie}=(0,k.A)(),ne=(0,A.Wx)({initialValues:{user_id:"",serviceData:[]},validationSchema:ie,onSubmit:async e=>{var l;const i=null===D||void 0===D||null===(l=D.createDiversionReportTableViewData)||void 0===l?void 0:l.map(((l,i)=>{var n,t,a,o,d,r,s,u,c,v;if(null===D||void 0===D||!D.deleteServiceIds.includes(null===l||void 0===l?void 0:l.uuid)||""==(null===l||void 0===l?void 0:l.uuid))return{add_units:+(null===e||void 0===e||null===(n=e.serviceData)||void 0===n||null===(t=n[i])||void 0===t?void 0:t.add_units),user_id:null===e||void 0===e?void 0:e.user_id,company_id:J,frequency_id:null===e||void 0===e||null===(a=e.serviceData)||void 0===a||null===(o=a[i])||void 0===o?void 0:o.frequency_id,location_id:M,template_id:null===l||void 0===l||null===(d=l.diversion_report_template)||void 0===d?void 0:d.uuid,zone_id:"full_site"!==(null===e||void 0===e||null===(r=e.serviceData)||void 0===r||null===(s=r[i])||void 0===s?void 0:s.zone_id)?null===e||void 0===e||null===(u=e.serviceData)||void 0===u||null===(c=u[i])||void 0===c?void 0:c.zone_id:"",service_id:null!==(v=null===l||void 0===l?void 0:l.uuid)&&void 0!==v?v:""}}));if(i)try{var n,t;const e=await L({variables:{serviceId:null===D||void 0===D?void 0:D.deleteServiceIds}});if(V((0,_.zF)([])),null!==e&&void 0!==e&&null!==(n=e.data)&&void 0!==n&&null!==(t=n.deleteDiversionContractorService)&&void 0!==t&&t.message){var a,o;const e=await P({variables:{serviceData:i}});q.oR.success(null===e||void 0===e||null===(a=e.data)||void 0===a||null===(o=a.createDiversionContractorService)||void 0===o?void 0:o.message)}}catch(d){q.oR.error(d.networkError.result.errors[0].message)}}});(0,s.useEffect)((()=>{V((0,_.Us)([])),M&&(V((0,_.Zu)(M)),K({variables:{siteId:M}}).then((e=>{U((()=>{var l,i,n;return[{name:"Select Zone"},{name:"Full Site",key:"full_site"},...null===e||void 0===e||null===(l=e.data)||void 0===l||null===(i=l.getZoneBySiteId)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.map((e=>({name:null===e||void 0===e?void 0:e.location,key:null===e||void 0===e?void 0:e.uuid})))]}))})).catch((e=>{var l,i,n;return q.oR.error(null===e||void 0===e||null===(l=e.networkError)||void 0===l||null===(i=l.result)||void 0===i||null===(n=i.errors[0])||void 0===n?void 0:n.message)})))}),[]),(0,s.useEffect)((()=>{if(null!==G&&void 0!==G&&G.getAllDiversionContractorServices){var e,l,i,n,t,a,o,d,r,s;const m=null===H||void 0===H||null===(e=H.getFrequencies)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.filter((e=>"1"==(null===e||void 0===e?void 0:e.frequency_type))),p=null===G||void 0===G||null===(i=G.getAllDiversionContractorServices)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.contractorServices;var u,c,v;if(null===G||void 0===G||null===(t=G.getAllDiversionContractorServices)||void 0===t||null===(a=t.data)||void 0===a||null===(o=a.contractorServices)||void 0===o||o.forEach(((e,l)=>{var i,n,t,a,o;(ne.setFieldValue("user_id",null===e||void 0===e||null===(i=e.user)||void 0===i?void 0:i.uuid),null!==e&&void 0!==e&&e.is_full_site)?ne.setFieldValue("serviceData.[".concat(l,"].zone_id"),"full_site"):ne.setFieldValue("serviceData.[".concat(l,"].zone_id"),null===e||void 0===e||null===(t=e.zone)||void 0===t?void 0:t.uuid);"Regular on call"===(null===e||void 0===e||null===(n=e.diversion_report_template)||void 0===n?void 0:n.service_type)?ne.setFieldValue("serviceData.[".concat(l,"].frequency_id"),null===m||void 0===m||null===(a=m[0])||void 0===a?void 0:a.uuid):ne.setFieldValue("serviceData.[".concat(l,"].frequency_id"),null===e||void 0===e||null===(o=e.frequency)||void 0===o?void 0:o.uuid);ne.setFieldValue("serviceData.[".concat(l,"].add_units"),null===e||void 0===e?void 0:e.add_units)})),null!==G&&void 0!==G&&null!==(d=G.getAllDiversionContractorServices)&&void 0!==d&&null!==(r=d.data)&&void 0!==r&&null!==(s=r.contractorServices)&&void 0!==s&&s.length)V((0,_.G$)(null===G||void 0===G||null===(u=G.getAllDiversionContractorServices)||void 0===u||null===(c=u.data)||void 0===c||null===(v=c.contractorServices)||void 0===v?void 0:v.map((e=>{var l;return null===e||void 0===e||null===(l=e.diversion_report_template)||void 0===l?void 0:l.uuid}))));else V((0,_.su)([]));V((0,_.T4)(p))}}),[null===G||void 0===G?void 0:G.getAllDiversionContractorServices]),(0,s.useEffect)((()=>{null!==B&&void 0!==B&&B.getCompanyContractorUsers&&X((()=>{var e,l;const i=null===B||void 0===B||null===(e=B.getCompanyContractorUsers)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.map((e=>({name:"".concat(null===e||void 0===e?void 0:e.first_name," ").concat(null===e||void 0===e?void 0:e.last_name),key:null===e||void 0===e?void 0:e.uuid,uuid:null===e||void 0===e?void 0:e.uuid})));return[{name:"Select Report Owner",key:""},...i]})),null!==H&&void 0!==H&&H.getFrequencies&&le((()=>{var e,l;const i=null===H||void 0===H||null===(e=H.getFrequencies)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.map((e=>("1"==(null===e||void 0===e?void 0:e.frequency_type)&&V((0,_.eF)(null===e||void 0===e?void 0:e.uuid)),{name:null===e||void 0===e?void 0:e.frequency_type,key:null===e||void 0===e?void 0:e.uuid,uuid:null===e||void 0===e?void 0:e.uuid})));return[{name:"Select Frequency",key:""},...i]}))}),[null===B||void 0===B?void 0:B.getCompanyContractorUsers,H]);const te=(0,s.useCallback)((()=>{V((0,_.Op)(!0))}),[null===ne||void 0===ne?void 0:ne.values]),ae=(0,s.useCallback)(((e,l)=>{var i,n,t;V((0,_.a6)({templateId:null===e||void 0===e||null===(i=e.diversion_report_template)||void 0===i?void 0:i.uuid,serviceId:null===e||void 0===e?void 0:e.uuid,index:l}));const a=null===ne||void 0===ne||null===(n=ne.values)||void 0===n||null===(t=n.serviceData)||void 0===t?void 0:t.filter(((e,i)=>i!==l));a&&ne.setFieldValue("serviceData",a)}),[D]),oe=(0,s.useCallback)((e=>{ne.setFieldValue(e.target.name,(0,z.AW)(e))}),[]);(0,s.useEffect)((()=>{if(null!==D&&void 0!==D&&D.createDiversionReportTableViewData){var e,l,i;const n=null===H||void 0===H||null===(e=H.getFrequencies)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.filter((e=>"1"==(null===e||void 0===e?void 0:e.frequency_type)));ne.setFieldValue("serviceData",null===D||void 0===D||null===(i=D.createDiversionReportTableViewData)||void 0===i?void 0:i.map(((e,l)=>{var i,t,a,o,d,r,s,u,c,v,m,p;return{zone_id:null===ne||void 0===ne||null===(i=ne.values)||void 0===i||null===(t=i.serviceData)||void 0===t||null===(a=t[l])||void 0===a?void 0:a.zone_id,add_units:null!==(o=null===ne||void 0===ne||null===(d=ne.values)||void 0===d||null===(r=d.serviceData)||void 0===r||null===(s=r[l])||void 0===s?void 0:s.add_units)&&void 0!==o?o:0,frequency_id:"Regular on call"===(null===e||void 0===e||null===(u=e.diversion_report_template)||void 0===u?void 0:u.service_type)?null===n||void 0===n||null===(c=n[0])||void 0===c?void 0:c.uuid:null===ne||void 0===ne||null===(v=ne.values)||void 0===v||null===(m=v.serviceData)||void 0===m||null===(p=m[l])||void 0===p?void 0:p.frequency_id}})))}}),[null===D||void 0===D?void 0:D.createDiversionReportTableViewData]);const de=null===ne||void 0===ne||null===(e=ne.errors)||void 0===e?void 0:e.serviceData,re=null===ne||void 0===ne||null===(l=ne.touched)||void 0===l?void 0:l.serviceData;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(r.A,{headerTitle:"Create Diversion Report"}),(W||Y)&&(0,j.jsx)(T.A,{}),(0,j.jsxs)("div",{children:[(0,j.jsxs)("div",{className:"w-full overflow-hidden bg-accents-2 border border-border-primary rounded-xl",children:[(0,j.jsx)("div",{className:"px-3 py-5 border-b border-solid md:px-5 border-border-primary ",children:(0,j.jsx)("h6",{children:O})}),(0,j.jsx)("div",{className:"px-3 py-2.5 md:px-5",children:(0,j.jsxs)("div",{className:"flex items-end flex-wrap sm:flex-nowrap justify-between w-full space-y-3",children:[(0,j.jsx)("div",{className:"w-full xs:w-64 sm:max-w-[360px]",children:(0,j.jsx)(d.A,{name:"user_id",id:"user_id",label:w("Report Owner"),value:null===ne||void 0===ne||null===(i=ne.values)||void 0===i?void 0:i.user_id,onChange:ne.handleChange,options:Q,error:null!==ne&&void 0!==ne&&null!==(n=ne.errors)&&void 0!==n&&n.user_id&&null!==ne&&void 0!==ne&&null!==(t=ne.touched)&&void 0!==t&&t.user_id?null===ne||void 0===ne||null===(a=ne.errors)||void 0===a?void 0:a.user_id:"",disabled:!M})}),(0,j.jsx)(o.A,{type:"button",className:"btn-secondary btn-normal whitespace-nowrap w-full xs:w-auto",onClick:te,label:"",disabled:!M,children:w("+ Add Services from Template")})]})}),(0,j.jsxs)("div",{className:"px-3 py-2.5 md:px-5",children:[(0,j.jsx)("h6",{className:"mb-3 md:mb-5",children:"Service List"}),(0,j.jsxs)("div",{className:"w-full mb-3 overflow-auto bg-white border sm:w-auto rounded-t-xl custom-dataTable border-border-primary",children:[(0,j.jsxs)("table",{children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[null===Z||void 0===Z?void 0:Z.map(((e,l)=>{const i=l;return(0,j.jsx)("th",{scope:"col",children:(0,j.jsx)("div",{className:"flex items-center ".concat("Status"==e.name?"justify-center":""),children:e.name})},i)})),(0,j.jsx)("th",{scope:"col",children:(0,j.jsx)("div",{className:"flex items-center",children:w("Action")})})]})}),(0,j.jsx)("tbody",{children:null===D||void 0===D||null===(p=D.createDiversionReportTableViewData)||void 0===p?void 0:p.map(((e,l)=>{var i,n,t,a,o,r,s,u,v,m,p,x,h,y,f,g,_,N,D,C,S,q,I,A,k,$,F,z,T,U,V;const E=l;return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{children:(0,j.jsx)("div",{className:"w-[7.875rem]",children:(0,j.jsx)(d.A,{name:"serviceData.[".concat(l,"].zone_id"),id:"reportOwner",value:null===ne||void 0===ne||null===(i=ne.values)||void 0===i||null===(n=i.serviceData)||void 0===n||null===(t=n[l])||void 0===t?void 0:t.zone_id,onChange:ne.handleChange,options:R,error:null!==de&&void 0!==de&&null!==(a=de[l])&&void 0!==a&&a.zone_id&&null!==re&&void 0!==re&&null!==(o=re[l])&&void 0!==o&&o.zone_id?null===de||void 0===de||null===(r=de[l])||void 0===r?void 0:r.zone_id:""})})}),(0,j.jsx)("td",{className:"text-left",children:null===e||void 0===e||null===(s=e.diversion_report_template)||void 0===s?void 0:s.service_type}),(0,j.jsx)("td",{className:"text-left",children:null===e||void 0===e||null===(u=e.diversion_report_template)||void 0===u||null===(v=u.material)||void 0===v?void 0:v.name}),(0,j.jsx)("td",{className:"text-left",children:null===e||void 0===e||null===(m=e.diversion_report_template)||void 0===m||null===(p=m.material_type)||void 0===p?void 0:p.type}),(0,j.jsx)("td",{className:"text-left",children:null===e||void 0===e||null===(x=e.diversion_report_template)||void 0===x||null===(h=x.equipment)||void 0===h?void 0:h.name}),(0,j.jsx)("td",{className:"text-left",children:null===e||void 0===e||null===(y=e.diversion_report_template)||void 0===y||null===(f=y.volume)||void 0===f?void 0:f.volume}),(0,j.jsx)("td",{children:(0,j.jsx)("div",{className:"w-[7.875rem]",children:(0,j.jsx)(c.A,{name:"serviceData.[".concat(l,"].add_units"),value:null===ne||void 0===ne||null===(g=ne.values)||void 0===g||null===(_=g.serviceData)||void 0===_||null===(N=_[l])||void 0===N?void 0:N.add_units,onChange:ne.handleChange,onBlur:oe,placeholder:w("Unit"),required:!0,disabled:"Regular on call"===(null===e||void 0===e||null===(D=e.diversion_report_template)||void 0===D?void 0:D.service_type)||"compactor"===(null===e||void 0===e||null===(C=e.diversion_report_template)||void 0===C||null===(S=C.equipment)||void 0===S?void 0:S.name.toLocaleLowerCase()),error:null!==de&&void 0!==de&&null!==(q=de[l])&&void 0!==q&&q.add_units&&null!==re&&void 0!==re&&null!==(I=re[l])&&void 0!==I&&I.add_units?null===de||void 0===de||null===(A=de[l])||void 0===A?void 0:A.add_units:""})})}),(0,j.jsx)("td",{children:(0,j.jsx)("div",{className:"w-[7.875rem]",children:(0,j.jsx)(d.A,{name:"serviceData.[".concat(l,"].frequency_id"),id:"reportOwner",value:null===ne||void 0===ne||null===(k=ne.values)||void 0===k||null===($=k.serviceData)||void 0===$||null===(F=$[l])||void 0===F?void 0:F.frequency_id,onChange:ne.handleChange,disabled:"Regular on call"===(null===e||void 0===e||null===(z=e.diversion_report_template)||void 0===z?void 0:z.service_type),options:ee,error:null!==de&&void 0!==de&&null!==(T=de[l])&&void 0!==T&&T.frequency_id&&null!==re&&void 0!==re&&null!==(U=re[l])&&void 0!==U&&U.frequency_id?null===de||void 0===de||null===(V=de[l])||void 0===V?void 0:V.frequency_id:""})})}),(0,j.jsx)("td",{className:"text-left",children:(0,j.jsx)("div",{className:"btn-group",children:(0,j.jsx)("button",{type:"button",className:"btn bg-transparent cursor-pointer btn-default",onClick:()=>ae(e,l),children:(0,j.jsx)(b.lM,{className:"fill-error"})})})})]},E)}))})]}),(0===(null===D||void 0===D||null===(x=D.createDiversionReportTableViewData)||void 0===x?void 0:x.length)||null===(null===D||void 0===D||null===(y=D.createDiversionReportTableViewData)||void 0===y?void 0:y.length))&&(0,j.jsx)("div",{className:"flex justify-center",children:(0,j.jsx)("div",{children:w("No Data")})})]})]})]}),(0,j.jsx)("div",{className:"flex flex-col justify-end",children:(0,j.jsx)("div",{className:"flex flex-wrap justify-start gap-2 mt-4 md:gap-5",children:(0,j.jsx)("button",{className:"btn bg-default btn-secondary btn-normal w-full xs:w-[160px] whitespace-nowrap ",type:"submit",title:"".concat(w("Confirm")),onClick:()=>null===ne||void 0===ne?void 0:ne.handleSubmit(),disabled:W||Y||!M,children:"Confirm"})})})]}),D.isOpenDiversionTemplateSelectionPopup&&(0,j.jsx)(N,{})]})}}}]);
//# sourceMappingURL=3480.2d71f313.chunk.js.map